/*! For license information please see tracing.bundle.js.LICENSE.txt */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Tracing=e():t.Tracing=e()}(self,(()=>(()=>{var t={132:t=>{"use strict";function e(t){return"function"==typeof t}var r=console.error.bind(console);function n(t,e,r){var n=!!t[e]&&t.propertyIsEnumerable(e);Object.defineProperty(t,e,{configurable:!0,enumerable:n,writable:!0,value:r})}function i(t){t&&t.logger&&(e(t.logger)?r=t.logger:r("new logger isn't a function, not replacing"))}function s(t,i,s){if(t&&t[i]){if(!s)return r("no wrapper function"),void r((new Error).stack);if(e(t[i])&&e(s)){var o=t[i],a=s(o,i);return n(a,"__original",o),n(a,"__unwrap",(function(){t[i]===a&&n(t,i,o)})),n(a,"__wrapped",!0),n(t,i,a),a}r("original object and wrapper must be functions")}else r("no original function "+i+" to wrap")}function o(t,e){return t&&t[e]?t[e].__unwrap?t[e].__unwrap():void r("no original to unwrap to -- has "+e+" already been unwrapped?"):(r("no function to unwrap."),void r((new Error).stack))}i.wrap=s,i.massWrap=function(t,e,n){if(!t)return r("must provide one or more modules to patch"),void r((new Error).stack);Array.isArray(t)||(t=[t]),e&&Array.isArray(e)?t.forEach((function(t){e.forEach((function(e){s(t,e,n)}))})):r("must provide one or more functions to wrap on modules")},i.unwrap=o,i.massUnwrap=function(t,e){if(!t)return r("must provide one or more modules to patch"),void r((new Error).stack);Array.isArray(t)||(t=[t]),e&&Array.isArray(e)?t.forEach((function(t){e.forEach((function(e){o(t,e)}))})):r("must provide one or more functions to unwrap on modules")},t.exports=i},199:(t,e,r)=>{var n,i,s;!function(r,o){if(r){var a={},c=r.TraceKit,u=[].slice,l="?",h=/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/;a.noConflict=function(){return r.TraceKit=c,a},a.wrap=function(t){return function(){try{return t.apply(this,arguments)}catch(t){throw a.report(t),t}}},a.report=function(){var t,e,n,i,s=[],o=null,c=null;function u(t,e,r){var n=null;if(!e||a.collectWindowErrors){for(var i in s)if(d(s,i))try{s[i](t,e,r)}catch(t){n=t}if(n)throw n}}function l(e,r,n,i,s){if(c)a.computeStackTrace.augmentStackTraceWithInitialElement(c,r,n,e),m();else if(s)u(a.computeStackTrace(s),!0,s);else{var o,l={url:r,line:n,column:i},d=e;if("[object String]"==={}.toString.call(e)){var p=e.match(h);p&&(o=p[1],d=p[2])}l.func=a.computeStackTrace.guessFunctionName(l.url,l.line),l.context=a.computeStackTrace.gatherContext(l.url,l.line),u({name:o,message:d,mode:"onerror",stack:[l]},!0,null)}return!!t&&t.apply(this,arguments)}function p(t){u(a.computeStackTrace(t.reason),!0,t.reason)}function m(){var t=c,e=o;c=null,o=null,u(t,!1,e)}function g(t){if(c){if(o===t)return;m()}var e=a.computeStackTrace(t);throw c=e,o=t,setTimeout((function(){o===t&&m()}),e.incomplete?2e3:0),t}return g.subscribe=function(o){!0!==e&&(t=r.onerror,r.onerror=l,e=!0),!0!==i&&(n=r.onunhandledrejection,r.onunhandledrejection=p,i=!0),s.push(o)},g.unsubscribe=function(o){for(var a=s.length-1;a>=0;--a)s[a]===o&&s.splice(a,1);0===s.length&&(e&&(r.onerror=t,e=!1),i&&(r.onunhandledrejection=n,i=!1))},g}(),a.computeStackTrace=function(){var t=!1,e={};function n(t){if("string"!=typeof t)return[];if(!d(e,t)){var n="",i="";try{i=r.document.domain}catch(t){}var s=/(.*)\:\/\/([^:\/]+)([:\d]*)\/{0,1}([\s\S]*)/.exec(t);s&&s[2]===i&&(n=function(t){if(!a.remoteFetching)return"";try{var e=function(){try{return new r.XMLHttpRequest}catch(t){return new r.ActiveXObject("Microsoft.XMLHTTP")}}();return e.open("GET",t,!1),e.send(""),e.responseText}catch(t){return""}}(t)),e[t]=n?n.split("\n"):[]}return e[t]}function i(t,e){var r,i=/function ([^(]*)\(([^)]*)\)/,s=/['"]?([0-9A-Za-z$_]+)['"]?\s*[:=]\s*(function|eval|new Function)/,o="",a=n(t);if(!a.length)return l;for(var c=0;c<10;++c)if(!p(o=a[e-c]+o)){if(r=s.exec(o))return r[1];if(r=i.exec(o))return r[1]}return l}function s(t,e){var r=n(t);if(!r.length)return null;var i=[],s=Math.floor(a.linesOfContext/2),o=s+a.linesOfContext%2,c=Math.max(0,e-s-1),u=Math.min(r.length,e+o-1);e-=1;for(var l=c;l<u;++l)p(r[l])||i.push(r[l]);return i.length>0?i:null}function o(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#]/g,"\\$&")}function c(t){return o(t).replace("<","(?:<|&lt;)").replace(">","(?:>|&gt;)").replace("&","(?:&|&amp;)").replace('"','(?:"|&quot;)').replace(/\s+/g,"\\s+")}function u(t,e){for(var r,i,s=0,o=e.length;s<o;++s)if((r=n(e[s])).length&&(r=r.join("\n"),i=t.exec(r)))return{url:e[s],line:r.substring(0,i.index).split("\n").length,column:i.index-r.lastIndexOf("\n",i.index)-1};return null}function h(t,e,r){var i,s=n(e),a=new RegExp("\\b"+o(t)+"\\b");return r-=1,s&&s.length>r&&(i=a.exec(s[r]))?i.index:null}function m(t){if(!p(r&&r.document)){for(var e,n,i,s,a=[r.location.href],l=r.document.getElementsByTagName("script"),h=""+t,d=0;d<l.length;++d){var m=l[d];m.src&&a.push(m.src)}if(i=/^function(?:\s+([\w$]+))?\s*\(([\w\s,]*)\)\s*\{\s*(\S[\s\S]*\S)\s*\}\s*$/.exec(h)){var g=i[1]?"\\s+"+i[1]:"",f=i[2].split(",").join("\\s*,\\s*");e=o(i[3]).replace(/;$/,";?"),n=new RegExp("function"+g+"\\s*\\(\\s*"+f+"\\s*\\)\\s*{\\s*"+e+"\\s*}")}else n=new RegExp(o(h).replace(/\s+/g,"\\s+"));if(s=u(n,a))return s;if(i=/^function on([\w$]+)\s*\(event\)\s*\{\s*(\S[\s\S]*\S)\s*\}\s*$/.exec(h)){var _=i[1];if(e=c(i[2]),s=u(n=new RegExp("on"+_+"=[\\'\"]\\s*"+e+"\\s*[\\'\"]","i"),a[0]))return s;if(s=u(n=new RegExp(e),a))return s}return null}}function g(t){if(!t.stack)return null;for(var e,r,n,o=/^\s*at (.*?) ?\(((?:file|https?|blob|chrome-extension|native|eval|webpack|<anonymous>|\/).*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,a=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)((?:file|https?|blob|chrome|webpack|resource|\[native).*?|[^@]*bundle)(?::(\d+))?(?::(\d+))?\s*$/i,c=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:file|ms-appx|https?|webpack|blob):.*?):(\d+)(?::(\d+))?\)?\s*$/i,u=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,d=/\((\S*)(?::(\d+))(?::(\d+))\)/,m=t.stack.split("\n"),g=[],f=/^(.*) is undefined$/.exec(t.message),_=0,v=m.length;_<v;++_){if(r=o.exec(m[_])){var b=r[2]&&0===r[2].indexOf("native");r[2]&&0===r[2].indexOf("eval")&&(e=d.exec(r[2]))&&(r[2]=e[1],r[3]=e[2],r[4]=e[3]),n={url:b?null:r[2],func:r[1]||l,args:b?[r[2]]:[],line:r[3]?+r[3]:null,column:r[4]?+r[4]:null}}else if(r=c.exec(m[_]))n={url:r[2],func:r[1]||l,args:[],line:+r[3],column:r[4]?+r[4]:null};else{if(!(r=a.exec(m[_])))continue;r[3]&&r[3].indexOf(" > eval")>-1&&(e=u.exec(r[3]))?(r[3]=e[1],r[4]=e[2],r[5]=null):0!==_||r[5]||p(t.columnNumber)||(g[0].column=t.columnNumber+1),n={url:r[3],func:r[1]||l,args:r[2]?r[2].split(","):[],line:r[4]?+r[4]:null,column:r[5]?+r[5]:null}}!n.func&&n.line&&(n.func=i(n.url,n.line)),n.context=n.line?s(n.url,n.line):null,g.push(n)}return g.length?(g[0]&&g[0].line&&!g[0].column&&f&&(g[0].column=h(f[1],g[0].url,g[0].line)),{mode:"stack",name:t.name,message:t.message,stack:g}):null}function f(t,e,r,n){var o={url:e,line:r};if(o.url&&o.line){t.incomplete=!1,o.func||(o.func=i(o.url,o.line)),o.context||(o.context=s(o.url,o.line));var a=/ '([^']+)' /.exec(n);if(a&&(o.column=h(a[1],o.url,o.line)),t.stack.length>0&&t.stack[0].url===o.url){if(t.stack[0].line===o.line)return!1;if(!t.stack[0].line&&t.stack[0].func===o.func)return t.stack[0].line=o.line,t.stack[0].context=o.context,!1}return t.stack.unshift(o),t.partial=!0,!0}return t.incomplete=!0,!1}function _(t,e){for(var r,n,s,o=/function\s+([_$a-zA-Z\xA0-\uFFFF][_$a-zA-Z0-9\xA0-\uFFFF]*)?\s*\(/i,c=[],u={},d=!1,p=_.caller;p&&!d;p=p.caller)if(p!==v&&p!==a.report){if(n={url:null,func:l,args:[],line:null,column:null},p.name?n.func=p.name:(r=o.exec(p.toString()))&&(n.func=r[1]),void 0===n.func)try{n.func=r.input.substring(0,r.input.indexOf("{"))}catch(t){}if(s=m(p)){n.url=s.url,n.line=s.line,n.func===l&&(n.func=i(n.url,n.line));var g=/ '([^']+)' /.exec(t.message||t.description);g&&(n.column=h(g[1],s.url,s.line))}u[""+p]?d=!0:u[""+p]=!0,c.push(n)}e&&c.splice(0,e);var b={mode:"callers",name:t.name,message:t.message,stack:c};return f(b,t.sourceURL||t.fileName,t.line||t.lineNumber,t.message||t.description),b}function v(e,o){var a=null;o=null==o?0:+o;try{if(a=function(t){var e=t.stacktrace;if(e){for(var r,n=/ line (\d+).*script (?:in )?(\S+)(?:: in function (\S+))?$/i,o=/ line (\d+), column (\d+)\s*(?:in (?:<anonymous function: ([^>]+)>|([^\)]+))\((.*)\))? in (.*):\s*$/i,a=e.split("\n"),c=[],u=0;u<a.length;u+=2){var l=null;if((r=n.exec(a[u]))?l={url:r[2],line:+r[1],column:null,func:r[3],args:[]}:(r=o.exec(a[u]))&&(l={url:r[6],line:+r[1],column:+r[2],func:r[3]||r[4],args:r[5]?r[5].split(","):[]}),l){if(!l.func&&l.line&&(l.func=i(l.url,l.line)),l.line)try{l.context=s(l.url,l.line)}catch(t){}l.context||(l.context=[a[u+1]]),c.push(l)}}return c.length?{mode:"stacktrace",name:t.name,message:t.message,stack:c}:null}}(e),a)return a}catch(e){if(t)throw e}try{if(a=g(e))return a}catch(e){if(t)throw e}try{if(a=function(t){var e=t.message.split("\n");if(e.length<4)return null;var o,a=/^\s*Line (\d+) of linked script ((?:file|https?|blob)\S+)(?:: in function (\S+))?\s*$/i,l=/^\s*Line (\d+) of inline#(\d+) script in ((?:file|https?|blob)\S+)(?:: in function (\S+))?\s*$/i,h=/^\s*Line (\d+) of function script\s*$/i,p=[],m=r&&r.document&&r.document.getElementsByTagName("script"),g=[];for(var f in m)d(m,f)&&!m[f].src&&g.push(m[f]);for(var _=2;_<e.length;_+=2){var v=null;if(o=a.exec(e[_]))v={url:o[2],func:o[3],args:[],line:+o[1],column:null};else if(o=l.exec(e[_])){v={url:o[3],func:o[4],args:[],line:+o[1],column:null};var b=+o[1],w=g[o[2]-1];if(w){var y=n(v.url);if(y){var T=(y=y.join("\n")).indexOf(w.innerText);T>=0&&(v.line=b+y.substring(0,T).split("\n").length)}}}else if(o=h.exec(e[_])){var S=r.location.href.replace(/#.*$/,""),E=u(new RegExp(c(e[_+1])),[S]);v={url:S,func:"",args:[],line:E?E.line:o[1],column:null}}if(v){v.func||(v.func=i(v.url,v.line));var A=s(v.url,v.line),x=A?A[Math.floor(A.length/2)]:null;A&&x.replace(/^\s*/,"")===e[_+1].replace(/^\s*/,"")?v.context=A:v.context=[e[_+1]],p.push(v)}}return p.length?{mode:"multiline",name:t.name,message:e[0],stack:p}:null}(e),a)return a}catch(e){if(t)throw e}try{if(a=_(e,o+1))return a}catch(e){if(t)throw e}return{name:e.name,message:e.message,mode:"failed"}}return v.augmentStackTraceWithInitialElement=f,v.computeStackTraceFromStackProp=g,v.guessFunctionName=i,v.gatherContext=s,v.ofCaller=function(t){t=1+(null==t?0:+t);try{throw new Error}catch(e){return v(e,t+1)}},v.getSource=n,v}(),a.extendToAsynchronousCallbacks=function(){var t=function(t){var e=r[t];r[t]=function(){var t=u.call(arguments),r=t[0];return"function"==typeof r&&(t[0]=a.wrap(r)),e.apply?e.apply(this,t):e(t[0],t[1])}};t("setTimeout"),t("setInterval")},a.remoteFetching||(a.remoteFetching=!0),a.collectWindowErrors||(a.collectWindowErrors=!0),(!a.linesOfContext||a.linesOfContext<1)&&(a.linesOfContext=11),i=[],void 0===(s="function"==typeof(n=a)?n.apply(e,i):n)||(t.exports=s)}function d(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function p(t){return void 0===t}}("undefined"!=typeof window?window:r.g)},232:function(t,e,r){var n;!function(i,s){"use strict";var o="function",a="undefined",c="object",u="string",l="major",h="model",d="name",p="type",m="vendor",g="version",f="architecture",_="console",v="mobile",b="tablet",w="smarttv",y="wearable",T="embedded",S="Amazon",E="Apple",A="ASUS",x="BlackBerry",C="Browser",O="Chrome",L="Firefox",N="Google",M="Huawei",P="LG",R="Microsoft",k="Motorola",I="Opera",D="Samsung",U="Sharp",B="Sony",F="Xiaomi",$="Zebra",j="Facebook",V="Chromium OS",G="Mac OS",H=function(t){for(var e={},r=0;r<t.length;r++)e[t[r].toUpperCase()]=t[r];return e},z=function(t,e){return typeof t===u&&-1!==q(e).indexOf(q(t))},q=function(t){return t.toLowerCase()},W=function(t,e){if(typeof t===u)return t=t.replace(/^\s\s*/,""),typeof e===a?t:t.substring(0,500)},X=function(t,e){for(var r,n,i,a,u,l,h=0;h<e.length&&!u;){var d=e[h],p=e[h+1];for(r=n=0;r<d.length&&!u&&d[r];)if(u=d[r++].exec(t))for(i=0;i<p.length;i++)l=u[++n],typeof(a=p[i])===c&&a.length>0?2===a.length?typeof a[1]==o?this[a[0]]=a[1].call(this,l):this[a[0]]=a[1]:3===a.length?typeof a[1]!==o||a[1].exec&&a[1].test?this[a[0]]=l?l.replace(a[1],a[2]):s:this[a[0]]=l?a[1].call(this,l,a[2]):s:4===a.length&&(this[a[0]]=l?a[3].call(this,l.replace(a[1],a[2])):s):this[a]=l||s;h+=2}},K=function(t,e){for(var r in e)if(typeof e[r]===c&&e[r].length>0){for(var n=0;n<e[r].length;n++)if(z(e[r][n],t))return"?"===r?s:r}else if(z(e[r],t))return"?"===r?s:r;return t},Y={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},Z={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[g,[d,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[g,[d,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[d,g],[/opios[\/ ]+([\w\.]+)/i],[g,[d,I+" Mini"]],[/\bop(?:rg)?x\/([\w\.]+)/i],[g,[d,I+" GX"]],[/\bopr\/([\w\.]+)/i],[g,[d,I]],[/\bb[ai]*d(?:uhd|[ub]*[aekoprswx]{5,6})[\/ ]?([\w\.]+)/i],[g,[d,"Baidu"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant|iemobile|slim)\s?(?:browser)?[\/ ]?([\w\.]*)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(heytap|ovi)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[d,g],[/\bddg\/([\w\.]+)/i],[g,[d,"DuckDuckGo"]],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[g,[d,"UC"+C]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i,/micromessenger\/([\w\.]+)/i],[g,[d,"WeChat"]],[/konqueror\/([\w\.]+)/i],[g,[d,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[g,[d,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[g,[d,"Yandex"]],[/slbrowser\/([\w\.]+)/i],[g,[d,"Smart Lenovo "+C]],[/(avast|avg)\/([\w\.]+)/i],[[d,/(.+)/,"$1 Secure "+C],g],[/\bfocus\/([\w\.]+)/i],[g,[d,L+" Focus"]],[/\bopt\/([\w\.]+)/i],[g,[d,I+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[g,[d,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[g,[d,"Dolphin"]],[/coast\/([\w\.]+)/i],[g,[d,I+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[g,[d,"MIUI "+C]],[/fxios\/([-\w\.]+)/i],[g,[d,L]],[/\bqihu|(qi?ho?o?|360)browser/i],[[d,"360 "+C]],[/(oculus|sailfish|huawei|vivo)browser\/([\w\.]+)/i],[[d,/(.+)/,"$1 "+C],g],[/samsungbrowser\/([\w\.]+)/i],[g,[d,D+" Internet"]],[/(comodo_dragon)\/([\w\.]+)/i],[[d,/_/g," "],g],[/metasr[\/ ]?([\d\.]+)/i],[g,[d,"Sogou Explorer"]],[/(sogou)mo\w+\/([\d\.]+)/i],[[d,"Sogou Mobile"],g],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|2345Explorer)[\/ ]?([\w\.]+)/i],[d,g],[/(lbbrowser)/i,/\[(linkedin)app\]/i],[d],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[d,j],g],[/(Klarna)\/([\w\.]+)/i,/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(alipay)client\/([\w\.]+)/i,/(twitter)(?:and| f.+e\/([\w\.]+))/i,/(chromium|instagram|snapchat)[\/ ]([-\w\.]+)/i],[d,g],[/\bgsa\/([\w\.]+) .*safari\//i],[g,[d,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[g,[d,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[g,[d,O+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[d,O+" WebView"],g],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[g,[d,"Android "+C]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[d,g],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[g,[d,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[g,d],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[d,[g,K,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[d,g],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[d,"Netscape"],g],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[g,[d,L+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i,/panasonic;(viera)/i],[d,g],[/(cobalt)\/([\w\.]+)/i],[d,[g,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[f,"amd64"]],[/(ia32(?=;))/i],[[f,q]],[/((?:i[346]|x)86)[;\)]/i],[[f,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[f,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[f,"armhf"]],[/windows (ce|mobile); ppc;/i],[[f,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[f,/ower/,"",q]],[/(sun4\w)[;\)]/i],[[f,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[f,q]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[h,[m,D],[p,b]],[/\b((?:s[cgp]h|gt|sm)-\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[h,[m,D],[p,v]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[h,[m,E],[p,v]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[h,[m,E],[p,b]],[/(macintosh);/i],[h,[m,E]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[h,[m,U],[p,v]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[h,[m,M],[p,b]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[h,[m,M],[p,v]],[/\b(poco[\w ]+|m2\d{3}j\d\d[a-z]{2})(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/oid[^\)]+; (m?[12][0-389][01]\w{3,6}[c-y])( bui|; wv|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[h,/_/g," "],[m,F],[p,v]],[/oid[^\)]+; (2\d{4}(283|rpbf)[cgl])( bui|\))/i,/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[h,/_/g," "],[m,F],[p,b]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[h,[m,"OPPO"],[p,v]],[/\b(opd2\d{3}a?) bui/i],[h,[m,"OPPO"],[p,b]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[h,[m,"Vivo"],[p,v]],[/\b(rmx[1-3]\d{3})(?: bui|;|\))/i],[h,[m,"Realme"],[p,v]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[h,[m,k],[p,v]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[h,[m,k],[p,b]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[h,[m,P],[p,b]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[h,[m,P],[p,v]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[h,[m,"Lenovo"],[p,b]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[h,/_/g," "],[m,"Nokia"],[p,v]],[/(pixel c)\b/i],[h,[m,N],[p,b]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[h,[m,N],[p,v]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[h,[m,B],[p,v]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[h,"Xperia Tablet"],[m,B],[p,b]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[h,[m,"OnePlus"],[p,v]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[h,[m,S],[p,b]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[h,/(.+)/g,"Fire Phone $1"],[m,S],[p,v]],[/(playbook);[-\w\),; ]+(rim)/i],[h,m,[p,b]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[h,[m,x],[p,v]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[h,[m,A],[p,b]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[h,[m,A],[p,v]],[/(nexus 9)/i],[h,[m,"HTC"],[p,b]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[m,[h,/_/g," "],[p,v]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[h,[m,"Acer"],[p,b]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[h,[m,"Meizu"],[p,v]],[/; ((?:power )?armor(?:[\w ]{0,8}))(?: bui|\))/i],[h,[m,"Ulefone"],[p,v]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron|infinix|tecno)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[m,h,[p,v]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[m,h,[p,b]],[/(surface duo)/i],[h,[m,R],[p,b]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[h,[m,"Fairphone"],[p,v]],[/(u304aa)/i],[h,[m,"AT&T"],[p,v]],[/\bsie-(\w*)/i],[h,[m,"Siemens"],[p,v]],[/\b(rct\w+) b/i],[h,[m,"RCA"],[p,b]],[/\b(venue[\d ]{2,7}) b/i],[h,[m,"Dell"],[p,b]],[/\b(q(?:mv|ta)\w+) b/i],[h,[m,"Verizon"],[p,b]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[h,[m,"Barnes & Noble"],[p,b]],[/\b(tm\d{3}\w+) b/i],[h,[m,"NuVision"],[p,b]],[/\b(k88) b/i],[h,[m,"ZTE"],[p,b]],[/\b(nx\d{3}j) b/i],[h,[m,"ZTE"],[p,v]],[/\b(gen\d{3}) b.+49h/i],[h,[m,"Swiss"],[p,v]],[/\b(zur\d{3}) b/i],[h,[m,"Swiss"],[p,b]],[/\b((zeki)?tb.*\b) b/i],[h,[m,"Zeki"],[p,b]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[m,"Dragon Touch"],h,[p,b]],[/\b(ns-?\w{0,9}) b/i],[h,[m,"Insignia"],[p,b]],[/\b((nxa|next)-?\w{0,9}) b/i],[h,[m,"NextBook"],[p,b]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[m,"Voice"],h,[p,v]],[/\b(lvtel\-)?(v1[12]) b/i],[[m,"LvTel"],h,[p,v]],[/\b(ph-1) /i],[h,[m,"Essential"],[p,v]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[h,[m,"Envizen"],[p,b]],[/\b(trio[-\w\. ]+) b/i],[h,[m,"MachSpeed"],[p,b]],[/\btu_(1491) b/i],[h,[m,"Rotor"],[p,b]],[/(shield[\w ]+) b/i],[h,[m,"Nvidia"],[p,b]],[/(sprint) (\w+)/i],[m,h,[p,v]],[/(kin\.[onetw]{3})/i],[[h,/\./g," "],[m,R],[p,v]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[h,[m,$],[p,b]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[h,[m,$],[p,v]],[/smart-tv.+(samsung)/i],[m,[p,w]],[/hbbtv.+maple;(\d+)/i],[[h,/^/,"SmartTV"],[m,D],[p,w]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[m,P],[p,w]],[/(apple) ?tv/i],[m,[h,E+" TV"],[p,w]],[/crkey/i],[[h,O+"cast"],[m,N],[p,w]],[/droid.+aft(\w+)( bui|\))/i],[h,[m,S],[p,w]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[h,[m,U],[p,w]],[/(bravia[\w ]+)( bui|\))/i],[h,[m,B],[p,w]],[/(mitv-\w{5}) bui/i],[h,[m,F],[p,w]],[/Hbbtv.*(technisat) (.*);/i],[m,h,[p,w]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[m,W],[h,W],[p,w]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[p,w]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[m,h,[p,_]],[/droid.+; (shield) bui/i],[h,[m,"Nvidia"],[p,_]],[/(playstation [345portablevi]+)/i],[h,[m,B],[p,_]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[h,[m,R],[p,_]],[/((pebble))app/i],[m,h,[p,y]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[h,[m,E],[p,y]],[/droid.+; (glass) \d/i],[h,[m,N],[p,y]],[/droid.+; (wt63?0{2,3})\)/i],[h,[m,$],[p,y]],[/(quest( \d| pro)?)/i],[h,[m,j],[p,y]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[m,[p,T]],[/(aeobc)\b/i],[h,[m,S],[p,T]],[/droid .+?; ([^;]+?)(?: bui|; wv\)|\) applew).+? mobile safari/i],[h,[p,v]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[h,[p,b]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[p,b]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[p,v]],[/(android[-\w\. ]{0,9});.+buil/i],[h,[m,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[g,[d,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[g,[d,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[d,g],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[g,d]],os:[[/microsoft (windows) (vista|xp)/i],[d,g],[/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i],[d,[g,K,Y]],[/windows nt 6\.2; (arm)/i,/windows[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i,/(?:win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[g,K,Y],[d,"Windows"]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/(?:ios;fbsv\/|iphone.+ios[\/ ])([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[g,/_/g,"."],[d,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[d,G],[g,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[g,d],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[d,g],[/\(bb(10);/i],[g,[d,x]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[g,[d,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[g,[d,L+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[g,[d,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[g,[d,"watchOS"]],[/crkey\/([\d\.]+)/i],[g,[d,O+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[d,V],g],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[d,g],[/(sunos) ?([\w\.\d]*)/i],[[d,"Solaris"],g],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[d,g]]},Q=function(t,e){if(typeof t===c&&(e=t,t=s),!(this instanceof Q))return new Q(t,e).getResult();var r=typeof i!==a&&i.navigator?i.navigator:s,n=t||(r&&r.userAgent?r.userAgent:""),_=r&&r.userAgentData?r.userAgentData:s,w=e?function(t,e){var r={};for(var n in t)e[n]&&e[n].length%2==0?r[n]=e[n].concat(t[n]):r[n]=t[n];return r}(Z,e):Z,y=r&&r.userAgent==n;return this.getBrowser=function(){var t,e={};return e[d]=s,e[g]=s,X.call(e,n,w.browser),e[l]=typeof(t=e[g])===u?t.replace(/[^\d\.]/g,"").split(".")[0]:s,y&&r&&r.brave&&typeof r.brave.isBrave==o&&(e[d]="Brave"),e},this.getCPU=function(){var t={};return t[f]=s,X.call(t,n,w.cpu),t},this.getDevice=function(){var t={};return t[m]=s,t[h]=s,t[p]=s,X.call(t,n,w.device),y&&!t[p]&&_&&_.mobile&&(t[p]=v),y&&"Macintosh"==t[h]&&r&&typeof r.standalone!==a&&r.maxTouchPoints&&r.maxTouchPoints>2&&(t[h]="iPad",t[p]=b),t},this.getEngine=function(){var t={};return t[d]=s,t[g]=s,X.call(t,n,w.engine),t},this.getOS=function(){var t={};return t[d]=s,t[g]=s,X.call(t,n,w.os),y&&!t[d]&&_&&_.platform&&"Unknown"!=_.platform&&(t[d]=_.platform.replace(/chrome os/i,V).replace(/macos/i,G)),t},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return n},this.setUA=function(t){return n=typeof t===u&&t.length>500?W(t,500):t,this},this.setUA(n),this};Q.VERSION="1.0.38",Q.BROWSER=H([d,g,l]),Q.CPU=H([f]),Q.DEVICE=H([h,m,p,_,v,w,b,y,T]),Q.ENGINE=Q.OS=H([d,g]),typeof e!==a?(t.exports&&(e=t.exports=Q),e.UAParser=Q):r.amdO?(n=function(){return Q}.call(e,r,e,t))===s||(t.exports=n):typeof i!==a&&(i.UAParser=Q);var J=typeof i!==a&&(i.jQuery||i.Zepto);if(J&&!J.ua){var tt=new Q;J.ua=tt.getResult(),J.ua.get=function(){return tt.getUA()},J.ua.set=function(t){tt.setUA(t);var e=tt.getResult();for(var r in e)J.ua[r]=e[r]}}}("object"==typeof window?window:this)}},e={};function r(n){var i=e[n];if(void 0!==i)return i.exports;var s=e[n]={exports:{}};return t[n].call(s.exports,s,s.exports,r),s.exports}r.amdO={},r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var n={};return(()=>{"use strict";r.r(n);var t="object"==typeof globalThis?globalThis:"object"==typeof self?self:"object"==typeof window?window:"object"==typeof r.g?r.g:{},e="1.9.0",i=/^(\d+)\.(\d+)\.(\d+)(-(.+))?$/,s=function(t){var e=new Set([t]),r=new Set,n=t.match(i);if(!n)return function(){return!1};var s=+n[1],o=+n[2],a=+n[3];if(null!=n[4])return function(e){return e===t};function c(t){return r.add(t),!1}function u(t){return e.add(t),!0}return function(t){if(e.has(t))return!0;if(r.has(t))return!1;var n=t.match(i);if(!n)return c(t);var l=+n[1],h=+n[2],d=+n[3];return null!=n[4]||s!==l?c(t):0===s?o===h&&a<=d?u(t):c(t):o<=h?u(t):c(t)}}(e),o=e.split(".")[0],a=Symbol.for("opentelemetry.js.api."+o),c=t;function u(t,r,n,i){var s;void 0===i&&(i=!1);var o=c[a]=null!==(s=c[a])&&void 0!==s?s:{version:e};if(!i&&o[t]){var u=new Error("@opentelemetry/api: Attempted duplicate registration of API: "+t);return n.error(u.stack||u.message),!1}return o.version!==e?(u=new Error("@opentelemetry/api: Registration of version v"+o.version+" for "+t+" does not match previously registered API v"+e),n.error(u.stack||u.message),!1):(o[t]=r,n.debug("@opentelemetry/api: Registered a global for "+t+" v"+e+"."),!0)}function l(t){var e,r,n=null===(e=c[a])||void 0===e?void 0:e.version;if(n&&s(n))return null===(r=c[a])||void 0===r?void 0:r[t]}function h(t,r){r.debug("@opentelemetry/api: Unregistering a global for "+t+" v"+e+".");var n=c[a];n&&delete n[t]}var d,p=function(){function t(t){this._namespace=t.namespace||"DiagComponentLogger"}return t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return m("debug",this._namespace,t)},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return m("error",this._namespace,t)},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return m("info",this._namespace,t)},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return m("warn",this._namespace,t)},t.prototype.verbose=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return m("verbose",this._namespace,t)},t}();function m(t,e,r){var n=l("diag");if(n)return r.unshift(e),n[t].apply(n,function(t,e,r){if(r||2===arguments.length)for(var n,i=0,s=e.length;i<s;i++)!n&&i in e||(n||(n=Array.prototype.slice.call(e,0,i)),n[i]=e[i]);return t.concat(n||Array.prototype.slice.call(e))}([],function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,s=r.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(n=s.next()).done;)o.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return o}(r),!1))}!function(t){t[t.NONE=0]="NONE",t[t.ERROR=30]="ERROR",t[t.WARN=50]="WARN",t[t.INFO=60]="INFO",t[t.DEBUG=70]="DEBUG",t[t.VERBOSE=80]="VERBOSE",t[t.ALL=9999]="ALL"}(d||(d={}));var g=function(){function t(){function t(t){return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var n=l("diag");if(n)return n[t].apply(n,function(t,e,r){if(r||2===arguments.length)for(var n,i=0,s=e.length;i<s;i++)!n&&i in e||(n||(n=Array.prototype.slice.call(e,0,i)),n[i]=e[i]);return t.concat(n||Array.prototype.slice.call(e))}([],function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,s=r.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(n=s.next()).done;)o.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return o}(e),!1))}}var e=this;e.setLogger=function(t,r){var n,i,s;if(void 0===r&&(r={logLevel:d.INFO}),t===e){var o=new Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return e.error(null!==(n=o.stack)&&void 0!==n?n:o.message),!1}"number"==typeof r&&(r={logLevel:r});var a=l("diag"),c=function(t,e){function r(r,n){var i=e[r];return"function"==typeof i&&t>=n?i.bind(e):function(){}}return t<d.NONE?t=d.NONE:t>d.ALL&&(t=d.ALL),e=e||{},{error:r("error",d.ERROR),warn:r("warn",d.WARN),info:r("info",d.INFO),debug:r("debug",d.DEBUG),verbose:r("verbose",d.VERBOSE)}}(null!==(i=r.logLevel)&&void 0!==i?i:d.INFO,t);if(a&&!r.suppressOverrideMessage){var h=null!==(s=(new Error).stack)&&void 0!==s?s:"<failed to generate stacktrace>";a.warn("Current logger will be overwritten from "+h),c.warn("Current logger will overwrite one already registered from "+h)}return u("diag",c,e,!0)},e.disable=function(){h("diag",e)},e.createComponentLogger=function(t){return new p(t)},e.verbose=t("verbose"),e.debug=t("debug"),e.info=t("info"),e.warn=t("warn"),e.error=t("error")}return t.instance=function(){return this._instance||(this._instance=new t),this._instance},t}(),f=g.instance();function _(t){return Symbol.for(t)}var v,b,w=new function t(e){var r=this;r._currentContext=e?new Map(e):new Map,r.getValue=function(t){return r._currentContext.get(t)},r.setValue=function(e,n){var i=new t(r._currentContext);return i._currentContext.set(e,n),i},r.deleteValue=function(e){var n=new t(r._currentContext);return n._currentContext.delete(e),n}},y=function(){function t(){}return t.prototype.active=function(){return w},t.prototype.with=function(t,e,r){for(var n=[],i=3;i<arguments.length;i++)n[i-3]=arguments[i];return e.call.apply(e,function(t,e,r){if(r||2===arguments.length)for(var n,i=0,s=e.length;i<s;i++)!n&&i in e||(n||(n=Array.prototype.slice.call(e,0,i)),n[i]=e[i]);return t.concat(n||Array.prototype.slice.call(e))}([r],function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,s=r.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(n=s.next()).done;)o.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return o}(n),!1))},t.prototype.bind=function(t,e){return e},t.prototype.enable=function(){return this},t.prototype.disable=function(){return this},t}(),T="context",S=new y,E=function(){function t(){}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.setGlobalContextManager=function(t){return u(T,t,g.instance())},t.prototype.active=function(){return this._getContextManager().active()},t.prototype.with=function(t,e,r){for(var n,i=[],s=3;s<arguments.length;s++)i[s-3]=arguments[s];return(n=this._getContextManager()).with.apply(n,function(t,e,r){if(r||2===arguments.length)for(var n,i=0,s=e.length;i<s;i++)!n&&i in e||(n||(n=Array.prototype.slice.call(e,0,i)),n[i]=e[i]);return t.concat(n||Array.prototype.slice.call(e))}([t,e,r],function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,s=r.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(n=s.next()).done;)o.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return o}(i),!1))},t.prototype.bind=function(t,e){return this._getContextManager().bind(t,e)},t.prototype._getContextManager=function(){return l(T)||S},t.prototype.disable=function(){this._getContextManager().disable(),h(T,g.instance())},t}();(b=v||(v={}))[b.NONE=0]="NONE",b[b.SAMPLED=1]="SAMPLED";var A="0000000000000000",x="00000000000000000000000000000000",C={traceId:x,spanId:A,traceFlags:v.NONE},O=function(){function t(t){void 0===t&&(t=C),this._spanContext=t}return t.prototype.spanContext=function(){return this._spanContext},t.prototype.setAttribute=function(t,e){return this},t.prototype.setAttributes=function(t){return this},t.prototype.addEvent=function(t,e){return this},t.prototype.addLink=function(t){return this},t.prototype.addLinks=function(t){return this},t.prototype.setStatus=function(t){return this},t.prototype.updateName=function(t){return this},t.prototype.end=function(t){},t.prototype.isRecording=function(){return!1},t.prototype.recordException=function(t,e){},t}(),L=_("OpenTelemetry Context Key SPAN");function N(t){return t.getValue(L)||void 0}function M(){return N(E.getInstance().active())}function P(t,e){return t.setValue(L,e)}function R(t){return t.deleteValue(L)}function k(t,e){return P(t,new O(e))}function I(t){var e;return null===(e=N(t))||void 0===e?void 0:e.spanContext()}var D=/^([0-9a-f]{32})$/i,U=/^[0-9a-f]{16}$/i;function B(t){return D.test(t)&&t!==x}function F(t){return B(t.traceId)&&(e=t.spanId,U.test(e)&&e!==A);var e}function $(t){return new O(t)}var j,V=E.getInstance(),G=function(){function t(){}return t.prototype.startSpan=function(t,e,r){if(void 0===r&&(r=V.active()),Boolean(null==e?void 0:e.root))return new O;var n,i=r&&I(r);return"object"==typeof(n=i)&&"string"==typeof n.spanId&&"string"==typeof n.traceId&&"number"==typeof n.traceFlags&&F(i)?new O(i):new O},t.prototype.startActiveSpan=function(t,e,r,n){var i,s,o;if(!(arguments.length<2)){2===arguments.length?o=e:3===arguments.length?(i=e,o=r):(i=e,s=r,o=n);var a=null!=s?s:V.active(),c=this.startSpan(t,i,a),u=P(a,c);return V.with(u,o,void 0,c)}},t}(),H=new G,z=function(){function t(t,e,r,n){this._provider=t,this.name=e,this.version=r,this.options=n}return t.prototype.startSpan=function(t,e,r){return this._getTracer().startSpan(t,e,r)},t.prototype.startActiveSpan=function(t,e,r,n){var i=this._getTracer();return Reflect.apply(i.startActiveSpan,i,arguments)},t.prototype._getTracer=function(){if(this._delegate)return this._delegate;var t=this._provider.getDelegateTracer(this.name,this.version,this.options);return t?(this._delegate=t,this._delegate):H},t}(),q=new(function(){function t(){}return t.prototype.getTracer=function(t,e,r){return new G},t}()),W=function(){function t(){}return t.prototype.getTracer=function(t,e,r){var n;return null!==(n=this.getDelegateTracer(t,e,r))&&void 0!==n?n:new z(this,t,e,r)},t.prototype.getDelegate=function(){var t;return null!==(t=this._delegate)&&void 0!==t?t:q},t.prototype.setDelegate=function(t){this._delegate=t},t.prototype.getDelegateTracer=function(t,e,r){var n;return null===(n=this._delegate)||void 0===n?void 0:n.getTracer(t,e,r)},t}(),X="trace",K=function(){function t(){this._proxyTracerProvider=new W,this.wrapSpanContext=$,this.isSpanContextValid=F,this.deleteSpan=R,this.getSpan=N,this.getActiveSpan=M,this.getSpanContext=I,this.setSpan=P,this.setSpanContext=k}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.setGlobalTracerProvider=function(t){var e=u(X,this._proxyTracerProvider,g.instance());return e&&this._proxyTracerProvider.setDelegate(t),e},t.prototype.getTracerProvider=function(){return l(X)||this._proxyTracerProvider},t.prototype.getTracer=function(t,e){return this.getTracerProvider().getTracer(t,e)},t.prototype.disable=function(){h(X,g.instance()),this._proxyTracerProvider=new W},t}().getInstance();!function(t){t[t.INT=0]="INT",t[t.DOUBLE=1]="DOUBLE"}(j||(j={}));var Y,Z,Q=E.getInstance(),J=(Y=function(t,e){return Y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},Y(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}Y(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),tt=function(){function t(){}return t.prototype.createGauge=function(t,e){return dt},t.prototype.createHistogram=function(t,e){return pt},t.prototype.createCounter=function(t,e){return ht},t.prototype.createUpDownCounter=function(t,e){return mt},t.prototype.createObservableGauge=function(t,e){return ft},t.prototype.createObservableCounter=function(t,e){return gt},t.prototype.createObservableUpDownCounter=function(t,e){return _t},t.prototype.addBatchObservableCallback=function(t,e){},t.prototype.removeBatchObservableCallback=function(t){},t}(),et=function(){},rt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return J(e,t),e.prototype.add=function(t,e){},e}(et),nt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return J(e,t),e.prototype.add=function(t,e){},e}(et),it=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return J(e,t),e.prototype.record=function(t,e){},e}(et),st=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return J(e,t),e.prototype.record=function(t,e){},e}(et),ot=function(){function t(){}return t.prototype.addCallback=function(t){},t.prototype.removeCallback=function(t){},t}(),at=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return J(e,t),e}(ot),ct=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return J(e,t),e}(ot),ut=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return J(e,t),e}(ot),lt=new tt,ht=new rt,dt=new it,pt=new st,mt=new nt,gt=new at,ft=new ct,_t=new ut,vt=new(function(){function t(){}return t.prototype.getMeter=function(t,e,r){return lt},t}()),bt="metrics",wt=function(){function t(){}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.setGlobalMeterProvider=function(t){return u(bt,t,g.instance())},t.prototype.getMeterProvider=function(){return l(bt)||vt},t.prototype.getMeter=function(t,e,r){return this.getMeterProvider().getMeter(t,e,r)},t.prototype.disable=function(){h(bt,g.instance())},t}().getInstance(),yt=[{n:"error",c:"error"},{n:"warn",c:"warn"},{n:"info",c:"info"},{n:"debug",c:"debug"},{n:"verbose",c:"trace"}],Tt=function(){function t(t){return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];if(console){var n=console[t];if("function"!=typeof n&&(n=console.log),"function"==typeof n)return n.apply(console,e)}}}for(var e=0;e<yt.length;e++)this[yt[e].n]=t(yt[e].c)};!function(t){t[t.UNSET=0]="UNSET",t[t.OK=1]="OK",t[t.ERROR=2]="ERROR"}(Z||(Z={}));var St=function(){function t(){}return t.prototype.inject=function(t,e){},t.prototype.extract=function(t,e){return t},t.prototype.fields=function(){return[]},t}(),Et={get:function(t,e){if(null!=t)return t[e]},keys:function(t){return null==t?[]:Object.keys(t)}},At={set:function(t,e,r){null!=t&&(t[e]=r)}},xt=_("OpenTelemetry Baggage Key");function Ct(t){return t.getValue(xt)||void 0}function Ot(){return Ct(E.getInstance().active())}function Lt(t,e){return t.setValue(xt,e)}function Nt(t){return t.deleteValue(xt)}var Mt=function(){function t(t){this._entries=t?new Map(t):new Map}return t.prototype.getEntry=function(t){var e=this._entries.get(t);if(e)return Object.assign({},e)},t.prototype.getAllEntries=function(){return Array.from(this._entries.entries()).map((function(t){var e=function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,s=r.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(n=s.next()).done;)o.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return o}(t,2);return[e[0],e[1]]}))},t.prototype.setEntry=function(e,r){var n=new t(this._entries);return n._entries.set(e,r),n},t.prototype.removeEntry=function(e){var r=new t(this._entries);return r._entries.delete(e),r},t.prototype.removeEntries=function(){for(var e,r,n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var s=new t(this._entries);try{for(var o=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),a=o.next();!a.done;a=o.next()){var c=a.value;s._entries.delete(c)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}return s},t.prototype.clear=function(){return new t},t}(),Pt=Symbol("BaggageEntryMetadata"),Rt=g.instance();function kt(t){return void 0===t&&(t={}),new Mt(new Map(Object.entries(t)))}var It="propagation",Dt=new St,Ut=function(){function t(){this.createBaggage=kt,this.getBaggage=Ct,this.getActiveBaggage=Ot,this.setBaggage=Lt,this.deleteBaggage=Nt}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.setGlobalPropagator=function(t){return u(It,t,g.instance())},t.prototype.inject=function(t,e,r){return void 0===r&&(r=At),this._getGlobalPropagator().inject(t,e,r)},t.prototype.extract=function(t,e,r){return void 0===r&&(r=Et),this._getGlobalPropagator().extract(t,e,r)},t.prototype.fields=function(){return this._getGlobalPropagator().fields()},t.prototype.disable=function(){h(It,g.instance())},t.prototype._getGlobalPropagator=function(){return l(It)||Dt},t}().getInstance();const Bt="object"==typeof globalThis?globalThis:"object"==typeof self?self:"object"==typeof window?window:"object"==typeof r.g?r.g:{},Ft=Symbol.for("io.opentelemetry.js.api.logs"),$t=Bt;class jt{emit(t){}}const Vt=new jt,Gt=new class{getLogger(t,e,r){return new jt}};class Ht{constructor(t,e,r,n){this._provider=t,this.name=e,this.version=r,this.options=n}emit(t){this._getLogger().emit(t)}_getLogger(){if(this._delegate)return this._delegate;const t=this._provider.getDelegateLogger(this.name,this.version,this.options);return t?(this._delegate=t,this._delegate):Vt}}class zt{getLogger(t,e,r){var n;return null!==(n=this.getDelegateLogger(t,e,r))&&void 0!==n?n:new Ht(this,t,e,r)}getDelegate(){var t;return null!==(t=this._delegate)&&void 0!==t?t:Gt}setDelegate(t){this._delegate=t}getDelegateLogger(t,e,r){var n;return null===(n=this._delegate)||void 0===n?void 0:n.getLogger(t,e,r)}}class qt{constructor(){this._proxyLoggerProvider=new zt}static getInstance(){return this._instance||(this._instance=new qt),this._instance}setGlobalLoggerProvider(t){return $t[Ft]?this.getLoggerProvider():($t[Ft]=(1,e=t,r=Gt,t=>1===t?e:r),this._proxyLoggerProvider.setDelegate(t),t);var e,r}getLoggerProvider(){var t,e;return null!==(e=null===(t=$t[Ft])||void 0===t?void 0:t.call($t,1))&&void 0!==e?e:this._proxyLoggerProvider}getLogger(t,e,r){return this.getLoggerProvider().getLogger(t,e,r)}disable(){delete $t[Ft],this._proxyLoggerProvider=new zt}}const Wt=qt.getInstance(),Xt="exception.message",Kt="exception.stacktrace",Yt="exception.type",Zt="service.name",Qt="service.version",Jt="telemetry.sdk.language",te="telemetry.sdk.name",ee="telemetry.sdk.version",re="user_agent.original",ne="process.runtime.name",ie={[te]:"opentelemetry",[ne]:"browser",[Jt]:"webjs",[ee]:"2.0.1"},se=t=>null!==t&&"object"==typeof t&&"function"==typeof t.then;class oe{_rawAttributes;_asyncAttributesPending=!1;_memoizedAttributes;static FromAttributeList(t){const e=new oe({});return e._rawAttributes=le(t),e._asyncAttributesPending=t.filter((([t,e])=>se(e))).length>0,e}constructor(t){const e=t.attributes??{};this._rawAttributes=Object.entries(e).map((([t,e])=>(se(e)&&(this._asyncAttributesPending=!0),[t,e]))),this._rawAttributes=le(this._rawAttributes)}get asyncAttributesPending(){return this._asyncAttributesPending}async waitForAsyncAttributes(){if(this.asyncAttributesPending){for(let t=0;t<this._rawAttributes.length;t++){const[e,r]=this._rawAttributes[t];this._rawAttributes[t]=[e,se(r)?await r:r]}this._asyncAttributesPending=!1}}get attributes(){if(this.asyncAttributesPending&&f.error("Accessing resource attributes before async attributes settled"),this._memoizedAttributes)return this._memoizedAttributes;const t={};for(const[e,r]of this._rawAttributes)se(r)?f.debug(`Unsettled resource attribute ${e} skipped`):null!=r&&(t[e]??=r);return this._asyncAttributesPending||(this._memoizedAttributes=t),t}getRawAttributes(){return this._rawAttributes}merge(t){return null==t?this:oe.FromAttributeList([...t.getRawAttributes(),...this.getRawAttributes()])}}function ae(t){return oe.FromAttributeList(Object.entries(t))}function ce(){return ae({})}function ue(){return ae({[Zt]:"unknown_service",[Jt]:ie[Jt],[te]:ie[te],[ee]:ie[ee]})}function le(t){return t.map((([t,e])=>se(e)?[t,e.catch((e=>{f.debug("promise rejection for resource attribute: %s - %s",t,e)}))]:[t,e]))}class he{_promise;_resolve;_reject;constructor(){this._promise=new Promise(((t,e)=>{this._resolve=t,this._reject=e}))}get promise(){return this._promise}resolve(t){this._resolve(t)}reject(t){this._reject(t)}}class de{_callback;_that;_isCalled=!1;_deferred=new he;constructor(t,e){this._callback=t,this._that=e}get isCalled(){return this._isCalled}get promise(){return this._deferred.promise}call(...t){if(!this._isCalled){this._isCalled=!0;try{Promise.resolve(this._callback.call(this._that,...t)).then((t=>this._deferred.resolve(t)),(t=>this._deferred.reject(t)))}catch(t){this._deferred.reject(t)}}return this._deferred.promise}}const pe=_("OpenTelemetry SDK Context Key SUPPRESS_TRACING");function me(t){return t.setValue(pe,!0)}function ge(t){return!0===t.getValue(pe)}var fe;!function(t){t[t.SUCCESS=0]="SUCCESS",t[t.FAILED=1]="FAILED"}(fe||(fe={}));function _e(t){try{(t=>{f.error(function(t){return"string"==typeof t?t:JSON.stringify(function(t){const e={};let r=t;for(;null!==r;)Object.getOwnPropertyNames(r).forEach((t=>{if(e[t])return;const n=r[t];n&&(e[t]=String(n))})),r=Object.getPrototypeOf(r);return e}(t))}(t))})(t)}catch{}}class ve{_exporter;_maxExportBatchSize;_maxQueueSize;_scheduledDelayMillis;_exportTimeoutMillis;_isExporting=!1;_finishedSpans=[];_timer;_shutdownOnce;_droppedSpansCount=0;constructor(t,e){this._exporter=t,this._maxExportBatchSize="number"==typeof e?.maxExportBatchSize?e.maxExportBatchSize:512,this._maxQueueSize="number"==typeof e?.maxQueueSize?e.maxQueueSize:2048,this._scheduledDelayMillis="number"==typeof e?.scheduledDelayMillis?e.scheduledDelayMillis:5e3,this._exportTimeoutMillis="number"==typeof e?.exportTimeoutMillis?e.exportTimeoutMillis:3e4,this._shutdownOnce=new de(this._shutdown,this),this._maxExportBatchSize>this._maxQueueSize&&(f.warn("BatchSpanProcessor: maxExportBatchSize must be smaller or equal to maxQueueSize, setting maxExportBatchSize to match maxQueueSize"),this._maxExportBatchSize=this._maxQueueSize)}forceFlush(){return this._shutdownOnce.isCalled?this._shutdownOnce.promise:this._flushAll()}onStart(t,e){}onEnd(t){this._shutdownOnce.isCalled||t.spanContext().traceFlags&v.SAMPLED&&this._addToBuffer(t)}shutdown(){return this._shutdownOnce.call()}_shutdown(){return Promise.resolve().then((()=>this.onShutdown())).then((()=>this._flushAll())).then((()=>this._exporter.shutdown()))}_addToBuffer(t){if(this._finishedSpans.length>=this._maxQueueSize)return 0===this._droppedSpansCount&&f.debug("maxQueueSize reached, dropping spans"),void this._droppedSpansCount++;this._droppedSpansCount>0&&(f.warn(`Dropped ${this._droppedSpansCount} spans because maxQueueSize reached`),this._droppedSpansCount=0),this._finishedSpans.push(t),this._maybeStartTimer()}_flushAll(){return new Promise(((t,e)=>{const r=[];for(let t=0,e=Math.ceil(this._finishedSpans.length/this._maxExportBatchSize);t<e;t++)r.push(this._flushOneBatch());Promise.all(r).then((()=>{t()})).catch(e)}))}_flushOneBatch(){return this._clearTimer(),0===this._finishedSpans.length?Promise.resolve():new Promise(((t,e)=>{const r=setTimeout((()=>{e(new Error("Timeout"))}),this._exportTimeoutMillis);Q.with(me(Q.active()),(()=>{let n;this._finishedSpans.length<=this._maxExportBatchSize?(n=this._finishedSpans,this._finishedSpans=[]):n=this._finishedSpans.splice(0,this._maxExportBatchSize);const i=()=>this._exporter.export(n,(n=>{clearTimeout(r),n.code===fe.SUCCESS?t():e(n.error??new Error("BatchSpanProcessor: span export failed"))}));let s=null;for(let t=0,e=n.length;t<e;t++){const e=n[t];e.resource.asyncAttributesPending&&e.resource.waitForAsyncAttributes&&(s??=[],s.push(e.resource.waitForAsyncAttributes()))}null===s?i():Promise.all(s).then(i,(t=>{_e(t),e(t)}))}))}))}_maybeStartTimer(){if(this._isExporting)return;const t=()=>{this._isExporting=!0,this._flushOneBatch().finally((()=>{this._isExporting=!1,this._finishedSpans.length>0&&(this._clearTimer(),this._maybeStartTimer())})).catch((t=>{this._isExporting=!1,_e(t)}))};if(this._finishedSpans.length>=this._maxExportBatchSize)return t();void 0===this._timer&&(this._timer=setTimeout((()=>t()),this._scheduledDelayMillis),this._timer)}_clearTimer(){void 0!==this._timer&&(clearTimeout(this._timer),this._timer=void 0)}}class be extends ve{_visibilityChangeListener;_pageHideListener;constructor(t,e){super(t,e),this.onInit(e)}onInit(t){!0!==t?.disableAutoFlushOnDocumentHide&&"undefined"!=typeof document&&(this._visibilityChangeListener=()=>{"hidden"===document.visibilityState&&this.forceFlush().catch((t=>{_e(t)}))},this._pageHideListener=()=>{this.forceFlush().catch((t=>{_e(t)}))},document.addEventListener("visibilitychange",this._visibilityChangeListener),document.addEventListener("pagehide",this._pageHideListener))}onShutdown(){"undefined"!=typeof document&&(this._visibilityChangeListener&&document.removeEventListener("visibilitychange",this._visibilityChangeListener),this._pageHideListener&&document.removeEventListener("pagehide",this._pageHideListener))}}var we;!function(t){t[t.NOT_RECORD=0]="NOT_RECORD",t[t.RECORD=1]="RECORD",t[t.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"}(we||(we={}));class ye{shouldSample(){return{decision:we.NOT_RECORD}}toString(){return"AlwaysOffSampler"}}class Te{shouldSample(){return{decision:we.RECORD_AND_SAMPLED}}toString(){return"AlwaysOnSampler"}}class Se{_ratio;_upperBound;constructor(t=0){this._ratio=t,this._ratio=this._normalize(t),this._upperBound=Math.floor(4294967295*this._ratio)}shouldSample(t,e){return{decision:B(e)&&this._accumulate(e)<this._upperBound?we.RECORD_AND_SAMPLED:we.NOT_RECORD}}toString(){return`TraceIdRatioBased{${this._ratio}}`}_normalize(t){return"number"!=typeof t||isNaN(t)?0:t>=1?1:t<=0?0:t}_accumulate(t){let e=0;for(let r=0;r<t.length/8;r++){const n=8*r;e=(e^parseInt(t.slice(n,n+8),16))>>>0}return e}}class Ee{generateTraceId=xe(16);generateSpanId=xe(8)}const Ae=Array(32);function xe(t){return function(){for(let e=0;e<2*t;e++)Ae[e]=Math.floor(16*Math.random())+48,Ae[e]>=58&&(Ae[e]+=39);return String.fromCharCode.apply(null,Ae.slice(0,2*t))}}const Ce="[object Object]",Oe="[object Null]",Le="[object Undefined]",Ne=Function.prototype.toString,Me=Ne.call(Object),Pe=Object.getPrototypeOf,Re=Object.prototype,ke=Re.hasOwnProperty,Ie=Symbol?Symbol.toStringTag:void 0,De=Re.toString;function Ue(t){if(!function(t){return null!=t&&"object"==typeof t}(t)||function(t){return null==t?void 0===t?Le:Oe:Ie&&Ie in Object(t)?function(t){const e=ke.call(t,Ie),r=t[Ie];let n=!1;try{t[Ie]=void 0,n=!0}catch(t){}const i=De.call(t);return n&&(e?t[Ie]=r:delete t[Ie]),i}(t):function(t){return De.call(t)}(t)}(t)!==Ce)return!1;const e=Pe(t);if(null===e)return!0;const r=ke.call(e,"constructor")&&e.constructor;return"function"==typeof r&&r instanceof r&&Ne.call(r)===Me}const Be=20;function Fe(...t){let e=t.shift();const r=new WeakMap;for(;t.length>0;)e=je(e,t.shift(),0,r);return e}function $e(t){return Ge(t)?t.slice():t}function je(t,e,r=0,n){let i;if(!(r>Be)){if(r++,qe(t)||qe(e)||He(e))i=$e(e);else if(Ge(t)){if(i=t.slice(),Ge(e))for(let t=0,r=e.length;t<r;t++)i.push($e(e[t]));else if(ze(e)){const t=Object.keys(e);for(let r=0,n=t.length;r<n;r++){const n=t[r];i[n]=$e(e[n])}}}else if(ze(t))if(ze(e)){if(!function(t,e){return!(!Ue(t)||!Ue(e))}(t,e))return e;i=Object.assign({},t);const s=Object.keys(e);for(let o=0,a=s.length;o<a;o++){const a=s[o],c=e[a];if(qe(c))void 0===c?delete i[a]:i[a]=c;else{const s=i[a],o=c;if(Ve(t,a,n)||Ve(e,a,n))delete i[a];else{if(ze(s)&&ze(o)){const r=n.get(s)||[],i=n.get(o)||[];r.push({obj:t,key:a}),i.push({obj:e,key:a}),n.set(s,r),n.set(o,i)}i[a]=je(i[a],c,r,n)}}}}else i=e;return i}}function Ve(t,e,r){const n=r.get(t[e])||[];for(let r=0,i=n.length;r<i;r++){const i=n[r];if(i.key===e&&i.obj===t)return!0}return!1}function Ge(t){return Array.isArray(t)}function He(t){return"function"==typeof t}function ze(t){return!qe(t)&&!Ge(t)&&!He(t)&&"object"==typeof t}function qe(t){return"string"==typeof t||"number"==typeof t||"boolean"==typeof t||void 0===t||t instanceof Date||t instanceof RegExp||null===t}var We,Xe;function Ke(t){const e={};if("object"!=typeof t||null==t)return e;for(const[r,n]of Object.entries(t))Ye(r)?Ze(n)?Array.isArray(n)?e[r]=n.slice():e[r]=n:f.warn(`Invalid attribute value set for key: ${r}`):f.warn(`Invalid attribute key: ${r}`);return e}function Ye(t){return"string"==typeof t&&t.length>0}function Ze(t){return null==t||(Array.isArray(t)?function(t){let e;for(const r of t)if(null!=r){if(!e){if(Qe(r)){e=typeof r;continue}return!1}if(typeof r!==e)return!1}return!0}(t):Qe(t))}function Qe(t){switch(typeof t){case"number":case"boolean":case"string":return!0}return!1}!function(t){t[t.INTERNAL=0]="INTERNAL",t[t.SERVER=1]="SERVER",t[t.CLIENT=2]="CLIENT",t[t.PRODUCER=3]="PRODUCER",t[t.CONSUMER=4]="CONSUMER"}(We||(We={})),function(t){t[t.NOT_RECORD=0]="NOT_RECORD",t[t.RECORD=1]="RECORD",t[t.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"}(Xe||(Xe={}));const Je=performance,tr=Math.pow(10,6),er=Math.pow(10,9);function rr(t){const e=t/1e3;return[Math.trunc(e),Math.round(t%1e3*tr)]}function nr(){let t=Je.timeOrigin;if("number"!=typeof t){const e=Je;t=e.timing&&e.timing.fetchStart}return t}function ir(t){return ur(rr(nr()),rr("number"==typeof t?t:Je.now()))}function sr(t){if(ar(t))return t;if("number"==typeof t)return t<nr()?ir(t):rr(t);if(t instanceof Date)return rr(t.getTime());throw TypeError("Invalid input type")}function or(t){return 1e6*t[0]+t[1]/1e3}function ar(t){return Array.isArray(t)&&2===t.length&&"number"==typeof t[0]&&"number"==typeof t[1]}function cr(t){return ar(t)||"number"==typeof t||t instanceof Date}function ur(t,e){const r=[t[0]+e[0],t[1]+e[1]];return r[1]>=er&&(r[1]-=er,r[0]+=1),r}class lr{_spanContext;kind;parentSpanContext;attributes={};links=[];events=[];startTime;resource;instrumentationScope;_droppedAttributesCount=0;_droppedEventsCount=0;_droppedLinksCount=0;name;status={code:Z.UNSET};endTime=[0,0];_ended=!1;_duration=[-1,-1];_spanProcessor;_spanLimits;_attributeValueLengthLimit;_performanceStartTime;_performanceOffset;_startTimeProvided;constructor(t){const e=Date.now();this._spanContext=t.spanContext,this._performanceStartTime=Je.now(),this._performanceOffset=e-(this._performanceStartTime+nr()),this._startTimeProvided=null!=t.startTime,this._spanLimits=t.spanLimits,this._attributeValueLengthLimit=this._spanLimits.attributeValueLengthLimit||0,this._spanProcessor=t.spanProcessor,this.name=t.name,this.parentSpanContext=t.parentSpanContext,this.kind=t.kind,this.links=t.links||[],this.startTime=this._getTime(t.startTime??e),this.resource=t.resource,this.instrumentationScope=t.scope,null!=t.attributes&&this.setAttributes(t.attributes),this._spanProcessor.onStart(this,t.context)}spanContext(){return this._spanContext}setAttribute(t,e){if(null==e||this._isSpanEnded())return this;if(0===t.length)return f.warn(`Invalid attribute key: ${t}`),this;if(!Ze(e))return f.warn(`Invalid attribute value set for key: ${t}`),this;const{attributeCountLimit:r}=this._spanLimits;return void 0!==r&&Object.keys(this.attributes).length>=r&&!Object.prototype.hasOwnProperty.call(this.attributes,t)?(this._droppedAttributesCount++,this):(this.attributes[t]=this._truncateToSize(e),this)}setAttributes(t){for(const[e,r]of Object.entries(t))this.setAttribute(e,r);return this}addEvent(t,e,r){if(this._isSpanEnded())return this;const{eventCountLimit:n}=this._spanLimits;if(0===n)return f.warn("No events allowed."),this._droppedEventsCount++,this;void 0!==n&&this.events.length>=n&&(0===this._droppedEventsCount&&f.debug("Dropping extra events."),this.events.shift(),this._droppedEventsCount++),cr(e)&&(cr(r)||(r=e),e=void 0);const i=Ke(e);return this.events.push({name:t,attributes:i,time:this._getTime(r),droppedAttributesCount:0}),this}addLink(t){return this.links.push(t),this}addLinks(t){return this.links.push(...t),this}setStatus(t){return this._isSpanEnded()||(this.status={...t},null!=this.status.message&&"string"!=typeof t.message&&(f.warn(`Dropping invalid status.message of type '${typeof t.message}', expected 'string'`),delete this.status.message)),this}updateName(t){return this._isSpanEnded()||(this.name=t),this}end(t){this._isSpanEnded()?f.error(`${this.name} ${this._spanContext.traceId}-${this._spanContext.spanId} - You can only call end() on a span once.`):(this._ended=!0,this.endTime=this._getTime(t),this._duration=function(t,e){let r=e[0]-t[0],n=e[1]-t[1];return n<0&&(r-=1,n+=er),[r,n]}(this.startTime,this.endTime),this._duration[0]<0&&(f.warn("Inconsistent start and end time, startTime > endTime. Setting span duration to 0ms.",this.startTime,this.endTime),this.endTime=this.startTime.slice(),this._duration=[0,0]),this._droppedEventsCount>0&&f.warn(`Dropped ${this._droppedEventsCount} events because eventCountLimit reached`),this._spanProcessor.onEnd(this))}_getTime(t){if("number"==typeof t&&t<=Je.now())return ir(t+this._performanceOffset);if("number"==typeof t)return rr(t);if(t instanceof Date)return rr(t.getTime());if(ar(t))return t;if(this._startTimeProvided)return rr(Date.now());const e=Je.now()-this._performanceStartTime;return ur(this.startTime,rr(e))}isRecording(){return!1===this._ended}recordException(t,e){const r={};"string"==typeof t?r[Xt]=t:t&&(t.code?r[Yt]=t.code.toString():t.name&&(r[Yt]=t.name),t.message&&(r[Xt]=t.message),t.stack&&(r[Kt]=t.stack)),r[Yt]||r[Xt]?this.addEvent("exception",r,e):f.warn(`Failed to record an exception ${t}`)}get duration(){return this._duration}get ended(){return this._ended}get droppedAttributesCount(){return this._droppedAttributesCount}get droppedEventsCount(){return this._droppedEventsCount}get droppedLinksCount(){return this._droppedLinksCount}_isSpanEnded(){if(this._ended){const t=new Error(`Operation attempted on ended Span {traceId: ${this._spanContext.traceId}, spanId: ${this._spanContext.spanId}}`);f.warn(`Cannot execute the operation on ended Span {traceId: ${this._spanContext.traceId}, spanId: ${this._spanContext.spanId}}`,t)}return this._ended}_truncateToLimitUtil(t,e){return t.length<=e?t:t.substring(0,e)}_truncateToSize(t){const e=this._attributeValueLengthLimit;return e<=0?(f.warn(`Attribute value limit must be positive, got ${e}`),t):"string"==typeof t?this._truncateToLimitUtil(t,e):Array.isArray(t)?t.map((t=>"string"==typeof t?this._truncateToLimitUtil(t,e):t)):t}}class hr{_root;_remoteParentSampled;_remoteParentNotSampled;_localParentSampled;_localParentNotSampled;constructor(t){this._root=t.root,this._root||(_e(new Error("ParentBasedSampler must have a root sampler configured")),this._root=new Te),this._remoteParentSampled=t.remoteParentSampled??new Te,this._remoteParentNotSampled=t.remoteParentNotSampled??new ye,this._localParentSampled=t.localParentSampled??new Te,this._localParentNotSampled=t.localParentNotSampled??new ye}shouldSample(t,e,r,n,i,s){const o=K.getSpanContext(t);return o&&F(o)?o.isRemote?o.traceFlags&v.SAMPLED?this._remoteParentSampled.shouldSample(t,e,r,n,i,s):this._remoteParentNotSampled.shouldSample(t,e,r,n,i,s):o.traceFlags&v.SAMPLED?this._localParentSampled.shouldSample(t,e,r,n,i,s):this._localParentNotSampled.shouldSample(t,e,r,n,i,s):this._root.shouldSample(t,e,r,n,i,s)}toString(){return`ParentBased{root=${this._root.toString()}, remoteParentSampled=${this._remoteParentSampled.toString()}, remoteParentNotSampled=${this._remoteParentNotSampled.toString()}, localParentSampled=${this._localParentSampled.toString()}, localParentNotSampled=${this._localParentNotSampled.toString()}}`}}const dr=1;function pr(){return{sampler:mr(),forceFlushTimeoutMillis:3e4,generalLimits:{attributeValueLengthLimit:1/0,attributeCountLimit:128},spanLimits:{attributeValueLengthLimit:1/0,attributeCountLimit:128,linkCountLimit:128,eventCountLimit:128,attributePerEventCountLimit:128,attributePerLinkCountLimit:128}}}function mr(){const t="parentbased_always_on";switch(t){case"always_on":return new Te;case"always_off":return new ye;case"parentbased_always_on":return new hr({root:new Te});case"parentbased_always_off":return new hr({root:new ye});case"traceidratio":return new Se(gr());case"parentbased_traceidratio":return new hr({root:new Se(gr())});default:return f.error(`OTEL_TRACES_SAMPLER value "${t}" invalid, defaulting to "parentbased_always_on".`),new hr({root:new Te})}}function gr(){return f.error(`OTEL_TRACES_SAMPLER_ARG is blank, defaulting to ${dr}.`),dr}const fr=1/0;class _r{_sampler;_generalLimits;_spanLimits;_idGenerator;instrumentationScope;_resource;_spanProcessor;constructor(t,e,r,n){const i=function(t){const e={sampler:mr()},r=pr(),n=Object.assign({},r,e,t);return n.generalLimits=Object.assign({},r.generalLimits,t.generalLimits||{}),n.spanLimits=Object.assign({},r.spanLimits,t.spanLimits||{}),n}(e);this._sampler=i.sampler,this._generalLimits=i.generalLimits,this._spanLimits=i.spanLimits,this._idGenerator=e.idGenerator||new Ee,this._resource=r,this._spanProcessor=n,this.instrumentationScope=t}startSpan(t,e={},r=Q.active()){e.root&&(r=K.deleteSpan(r));const n=K.getSpan(r);if(ge(r))return f.debug("Instrumentation suppressed, returning Noop Span"),K.wrapSpanContext(C);const i=n?.spanContext(),s=this._idGenerator.generateSpanId();let o,a,c;i&&K.isSpanContextValid(i)?(a=i.traceId,c=i.traceState,o=i):a=this._idGenerator.generateTraceId();const u=e.kind??We.INTERNAL,l=(e.links??[]).map((t=>({context:t.context,attributes:Ke(t.attributes)}))),h=Ke(e.attributes),d=this._sampler.shouldSample(r,a,t,u,h,l);c=d.traceState??c;const p={traceId:a,spanId:s,traceFlags:d.decision===Xe.RECORD_AND_SAMPLED?v.SAMPLED:v.NONE,traceState:c};if(d.decision===Xe.NOT_RECORD)return f.debug("Recording is off, propagating context in a non-recording span"),K.wrapSpanContext(p);const m=Ke(Object.assign(h,d.attributes));return new lr({resource:this._resource,scope:this.instrumentationScope,context:r,spanContext:p,name:t,kind:u,links:l,parentSpanContext:o,attributes:m,startTime:e.startTime,spanProcessor:this._spanProcessor,spanLimits:this._spanLimits})}startActiveSpan(t,e,r,n){let i,s,o;if(arguments.length<2)return;2===arguments.length?o=e:3===arguments.length?(i=e,o=r):(i=e,s=r,o=n);const a=s??Q.active(),c=this.startSpan(t,i,a),u=K.setSpan(a,c);return Q.with(u,o,void 0,c)}getGeneralLimits(){return this._generalLimits}getSpanLimits(){return this._spanLimits}}class vr{_spanProcessors;constructor(t){this._spanProcessors=t}forceFlush(){const t=[];for(const e of this._spanProcessors)t.push(e.forceFlush());return new Promise((e=>{Promise.all(t).then((()=>{e()})).catch((t=>{_e(t||new Error("MultiSpanProcessor: forceFlush failed")),e()}))}))}onStart(t,e){for(const r of this._spanProcessors)r.onStart(t,e)}onEnd(t){for(const e of this._spanProcessors)e.onEnd(t)}shutdown(){const t=[];for(const e of this._spanProcessors)t.push(e.shutdown());return new Promise(((e,r)=>{Promise.all(t).then((()=>{e()}),r)}))}}var br;!function(t){t[t.resolved=0]="resolved",t[t.timeout=1]="timeout",t[t.error=2]="error",t[t.unresolved=3]="unresolved"}(br||(br={}));class wr{_config;_tracers=new Map;_resource;_activeSpanProcessor;constructor(t={}){const e=Fe({},pr(),function(t){const e=Object.assign({},t.spanLimits);return e.attributeCountLimit=t.spanLimits?.attributeCountLimit??t.generalLimits?.attributeCountLimit??void 0??void 0??128,e.attributeValueLengthLimit=t.spanLimits?.attributeValueLengthLimit??t.generalLimits?.attributeValueLengthLimit??void 0??void 0??fr,Object.assign({},t,{spanLimits:e})}(t));this._resource=e.resource??ue(),this._config=Object.assign({},e,{resource:this._resource});const r=[];t.spanProcessors?.length&&r.push(...t.spanProcessors),this._activeSpanProcessor=new vr(r)}getTracer(t,e,r){const n=`${t}@${e||""}:${r?.schemaUrl||""}`;return this._tracers.has(n)||this._tracers.set(n,new _r({name:t,version:e,schemaUrl:r?.schemaUrl},this._config,this._resource,this._activeSpanProcessor)),this._tracers.get(n)}forceFlush(){const t=this._config.forceFlushTimeoutMillis,e=this._activeSpanProcessor._spanProcessors.map((e=>new Promise((r=>{let n;const i=setTimeout((()=>{r(new Error(`Span processor did not completed within timeout period of ${t} ms`)),n=br.timeout}),t);e.forceFlush().then((()=>{clearTimeout(i),n!==br.timeout&&(n=br.resolved,r(n))})).catch((t=>{clearTimeout(i),n=br.error,r(t)}))}))));return new Promise(((t,r)=>{Promise.all(e).then((e=>{const n=e.filter((t=>t!==br.resolved));n.length>0?r(n):t()})).catch((t=>r([t])))}))}shutdown(){return this._activeSpanProcessor.shutdown()}}class yr{_enabled=!1;_currentContext=w;_bindFunction(t=w,e){const r=this,n=function(...n){return r.with(t,(()=>e.apply(this,n)))};return Object.defineProperty(n,"length",{enumerable:!1,configurable:!0,writable:!1,value:e.length}),n}active(){return this._currentContext}bind(t,e){return void 0===t&&(t=this.active()),"function"==typeof e?this._bindFunction(t,e):e}disable(){return this._currentContext=w,this._enabled=!1,this}enable(){return this._enabled||(this._enabled=!0,this._currentContext=w),this}with(t,e,r,...n){const i=this._currentContext;this._currentContext=t||w;try{return e.call(r,...n)}finally{this._currentContext=i}}}class Tr{_propagators;_fields;constructor(t={}){this._propagators=t.propagators??[],this._fields=Array.from(new Set(this._propagators.map((t=>"function"==typeof t.fields?t.fields():[])).reduce(((t,e)=>t.concat(e)),[])))}inject(t,e,r){for(const n of this._propagators)try{n.inject(t,e,r)}catch(t){f.warn(`Failed to inject with ${n.constructor.name}. Err: ${t.message}`)}}extract(t,e,r){return this._propagators.reduce(((t,n)=>{try{return n.extract(t,e,r)}catch(t){f.warn(`Failed to extract with ${n.constructor.name}. Err: ${t.message}`)}return t}),t)}fields(){return this._fields.slice()}}const Sr="[_0-9a-z-*/]",Er=new RegExp(`^(?:[a-z]${Sr}{0,255}|[a-z0-9]${Sr}{0,240}@[a-z]${Sr}{0,13})$`),Ar=/^[ -~]{0,255}[!-~]$/,xr=/,|=/;class Cr{_internalState=new Map;constructor(t){t&&this._parse(t)}set(t,e){const r=this._clone();return r._internalState.has(t)&&r._internalState.delete(t),r._internalState.set(t,e),r}unset(t){const e=this._clone();return e._internalState.delete(t),e}get(t){return this._internalState.get(t)}serialize(){return this._keys().reduce(((t,e)=>(t.push(e+"="+this.get(e)),t)),[]).join(",")}_parse(t){t.length>512||(this._internalState=t.split(",").reverse().reduce(((t,e)=>{const r=e.trim(),n=r.indexOf("=");if(-1!==n){const i=r.slice(0,n),s=r.slice(n+1,e.length);(function(t){return Er.test(t)})(i)&&function(t){return Ar.test(t)&&!xr.test(t)}(s)&&t.set(i,s)}return t}),new Map),this._internalState.size>32&&(this._internalState=new Map(Array.from(this._internalState.entries()).reverse().slice(0,32))))}_keys(){return Array.from(this._internalState.keys()).reverse()}_clone(){const t=new Cr;return t._internalState=new Map(this._internalState),t}}const Or="traceparent",Lr="tracestate",Nr=new RegExp("^\\s?((?!ff)[\\da-f]{2})-((?![0]{32})[\\da-f]{32})-((?![0]{16})[\\da-f]{16})-([\\da-f]{2})(-.*)?\\s?$");class Mr{inject(t,e,r){const n=K.getSpanContext(t);if(!n||ge(t)||!F(n))return;const i=`00-${n.traceId}-${n.spanId}-0${Number(n.traceFlags||v.NONE).toString(16)}`;r.set(e,Or,i),n.traceState&&r.set(e,Lr,n.traceState.serialize())}extract(t,e,r){const n=r.get(e,Or);if(!n)return t;const i=Array.isArray(n)?n[0]:n;if("string"!=typeof i)return t;const s=function(t){const e=Nr.exec(t);return e?"00"===e[1]&&e[5]?null:{traceId:e[2],spanId:e[3],traceFlags:parseInt(e[4],16)}:null}(i);if(!s)return t;s.isRemote=!0;const o=r.get(e,Lr);if(o){const t=Array.isArray(o)?o.join(","):o;s.traceState=new Cr("string"==typeof t?t:void 0)}return K.setSpanContext(t,s)}fields(){return[Or,Lr]}}const Pr="baggage";class Rr{inject(t,e,r){const n=Ut.getBaggage(t);if(!n||ge(t))return;const i=function(t){return t.getAllEntries().map((([t,e])=>{let r=`${encodeURIComponent(t)}=${encodeURIComponent(e.value)}`;return void 0!==e.metadata&&(r+=";"+e.metadata.toString()),r}))}(n).filter((t=>t.length<=4096)).slice(0,180),s=function(t){return t.reduce(((t,e)=>{const r=`${t}${""!==t?",":""}${e}`;return r.length>8192?t:r}),"")}(i);s.length>0&&r.set(e,Pr,s)}extract(t,e,r){const n=r.get(e,Pr),i=Array.isArray(n)?n.join(","):n;if(!i)return t;const s={};return 0===i.length?t:(i.split(",").forEach((t=>{const e=function(t){const e=t.split(";");if(e.length<=0)return;const r=e.shift();if(!r)return;const n=r.indexOf("=");if(n<=0)return;const i=decodeURIComponent(r.substring(0,n).trim()),s=decodeURIComponent(r.substring(n+1).trim());let o;var a;return e.length>0&&("string"!=typeof(a=e.join(";"))&&(Rt.error("Cannot create baggage metadata from unknown type: "+typeof a),a=""),o={__TYPE__:Pt,toString:function(){return a}}),{key:i,value:s,metadata:o}}(t);if(e){const t={value:e.value};e.metadata&&(t.metadata=e.metadata),s[e.key]=t}})),0===Object.entries(s).length?t:Ut.setBaggage(t,Ut.createBaggage(s)))}fields(){return[Pr]}}class kr extends wr{constructor(t={}){super(t)}register(t={}){var e;K.setGlobalTracerProvider(this),null!==(e=t.propagator)&&(void 0!==e?Ut.setGlobalPropagator(e):Ut.setGlobalPropagator(new Tr({propagators:[new Mr,new Rr]}))),function(t){if(null!==t){if(void 0===t){const t=new yr;return t.enable(),void Q.setGlobalContextManager(t)}t.enable(),Q.setGlobalContextManager(t)}}(t.contextManager)}}const Ir=t=>null!==t&&"object"==typeof t&&"function"==typeof t.then;class Dr{_rawAttributes;_asyncAttributesPending=!1;_memoizedAttributes;static FromAttributeList(t){const e=new Dr({});return e._rawAttributes=Br(t),e._asyncAttributesPending=t.filter((([t,e])=>Ir(e))).length>0,e}constructor(t){const e=t.attributes??{};this._rawAttributes=Object.entries(e).map((([t,e])=>(Ir(e)&&(this._asyncAttributesPending=!0),[t,e]))),this._rawAttributes=Br(this._rawAttributes)}get asyncAttributesPending(){return this._asyncAttributesPending}async waitForAsyncAttributes(){if(this.asyncAttributesPending){for(let t=0;t<this._rawAttributes.length;t++){const[e,r]=this._rawAttributes[t];this._rawAttributes[t]=[e,Ir(r)?await r:r]}this._asyncAttributesPending=!1}}get attributes(){if(this.asyncAttributesPending&&f.error("Accessing resource attributes before async attributes settled"),this._memoizedAttributes)return this._memoizedAttributes;const t={};for(const[e,r]of this._rawAttributes)Ir(r)?f.debug(`Unsettled resource attribute ${e} skipped`):null!=r&&(t[e]??=r);return this._asyncAttributesPending||(this._memoizedAttributes=t),t}getRawAttributes(){return this._rawAttributes}merge(t){return null==t?this:Dr.FromAttributeList([...t.getRawAttributes(),...this.getRawAttributes()])}}function Ur(){return t={},Dr.FromAttributeList(Object.entries(t));var t}function Br(t){return t.map((([t,e])=>Ir(e)?[t,e.catch((e=>{f.debug("promise rejection for resource attribute: %s - %s",t,e)}))]:[t,e]))}const Fr="browser.platform",$r="browser.user_agent",jr=new class{detect(t){if("undefined"==typeof navigator)return Ur();const e=function(){const t={},e=navigator.userAgentData;return e?(t[Fr]=e.platform,t["browser.brands"]=e.brands.map((t=>`${t.brand} ${t.version}`)),t["browser.mobile"]=e.mobile):t[$r]=navigator.userAgent,t["browser.language"]=navigator.language,t}();return this._getResourceAttributes(e,t)}_getResourceAttributes(t,e){return t[$r]||t[Fr]?{attributes:t}:(f.debug("BrowserDetector failed: Unable to find required browser resources. "),Ur())}},Vr=function(t,e){return new Promise((r=>{Q.with(me(Q.active()),(()=>{t.export(e,(t=>{r(t)}))}))}))};class Gr extends Error{constructor(t){super(t),Object.setPrototypeOf(this,Gr.prototype)}}let Hr=console.error.bind(console);function zr(t,e,r){const n=!!t[e]&&Object.prototype.propertyIsEnumerable.call(t,e);Object.defineProperty(t,e,{configurable:!0,enumerable:n,writable:!0,value:r})}const qr=(t,e,r)=>{if(!t||!t[e])return void Hr("no original function "+String(e)+" to wrap");if(!r)return Hr("no wrapper function"),void Hr((new Error).stack);const n=t[e];if("function"!=typeof n||"function"!=typeof r)return void Hr("original object and wrapper must be functions");const i=r(n,e);return zr(i,"__original",n),zr(i,"__unwrap",(()=>{t[e]===i&&zr(t,e,n)})),zr(i,"__wrapped",!0),zr(t,e,i),i},Wr=(t,e,r)=>{if(!t)return Hr("must provide one or more modules to patch"),void Hr((new Error).stack);Array.isArray(t)||(t=[t]),e&&Array.isArray(e)?t.forEach((t=>{e.forEach((e=>{qr(t,e,r)}))})):Hr("must provide one or more functions to wrap on modules")},Xr=(t,e)=>{if(!t||!t[e])return Hr("no function to unwrap."),void Hr((new Error).stack);const r=t[e];r.__unwrap?r.__unwrap():Hr("no original to unwrap to -- has "+String(e)+" already been unwrapped?")},Kr=(t,e)=>{if(!t)return Hr("must provide one or more modules to patch"),void Hr((new Error).stack);Array.isArray(t)||(t=[t]),e&&Array.isArray(e)?t.forEach((t=>{e.forEach((e=>{Xr(t,e)}))})):Hr("must provide one or more functions to unwrap on modules")};function Yr(t){t&&t.logger&&("function"!=typeof t.logger?Hr("new logger isn't a function, not replacing"):Hr=t.logger)}Yr.wrap=qr,Yr.massWrap=Wr,Yr.unwrap=Xr,Yr.massUnwrap=Kr;class Zr{instrumentationName;instrumentationVersion;_config={};_tracer;_meter;_logger;_diag;constructor(t,e,r){this.instrumentationName=t,this.instrumentationVersion=e,this.setConfig(r),this._diag=f.createComponentLogger({namespace:t}),this._tracer=K.getTracer(t,e),this._meter=wt.getMeter(t,e),this._logger=Wt.getLogger(t,e),this._updateMetricInstruments()}_wrap=qr;_unwrap=Xr;_massWrap=Wr;_massUnwrap=Kr;get meter(){return this._meter}setMeterProvider(t){this._meter=t.getMeter(this.instrumentationName,this.instrumentationVersion),this._updateMetricInstruments()}get logger(){return this._logger}setLoggerProvider(t){this._logger=t.getLogger(this.instrumentationName,this.instrumentationVersion)}getModuleDefinitions(){const t=this.init()??[];return Array.isArray(t)?t:[t]}_updateMetricInstruments(){}getConfig(){return this._config}setConfig(t){this._config={enabled:!0,...t}}setTracerProvider(t){this._tracer=t.getTracer(this.instrumentationName,this.instrumentationVersion)}get tracer(){return this._tracer}_runSpanCustomizationHook(t,e,r,n){if(t)try{t(r,n)}catch(t){this._diag.error("Error running span customization hook due to exception in handler",{triggerName:e},t)}}}class Qr extends Zr{constructor(t,e,r){super(t,e,r),this._config.enabled&&this.enable()}}function Jr(t,e){if(t.nodeType===Node.DOCUMENT_NODE)return"/";const r=function(t,e){const r=t.nodeType,n=function(t){if(!t.parentNode)return 0;const e=[t.nodeType];t.nodeType===Node.CDATA_SECTION_NODE&&e.push(Node.TEXT_NODE);let r=Array.from(t.parentNode.childNodes);return r=r.filter((r=>{const n=r.localName;return e.indexOf(r.nodeType)>=0&&n===t.localName})),r.length>=1?r.indexOf(t)+1:0}(t);let i="";if(r===Node.ELEMENT_NODE){const r=t.getAttribute("id");if(e&&r)return`//*[@id="${r}"]`;i=t.localName}else if(r===Node.TEXT_NODE||r===Node.CDATA_SECTION_NODE)i="text()";else{if(r!==Node.COMMENT_NODE)return"";i="comment()"}return i&&n>1?`/${i}[${n}]`:`/${i}`}(t,e);if(e&&r.indexOf("@id")>0)return r;let n="";return t.parentNode&&(n+=Jr(t.parentNode,!1)),n+=r,n}const tn="1.0.1",en="@honeycombio/user-instrumentation",rn=["click"];class nn extends Qr{constructor(t={}){var e,r;super(en,tn,t),this._config=t,this._isEnabled=null!==(e=this._config.enabled)&&void 0!==e&&e,this._listeners=null!==(r=this._listeners)&&void 0!==r?r:[]}init(){}static handleEndSpan(t){var e;null===(e=nn._eventMap.get(t))||void 0===e||e.end()}static createGlobalEventListener(t,e,r){return n=>{const i=n.target;if(!1===r())return;if(nn._eventMap.has(n))return;if(!sn(n,i,t,e))return;const s=Jr(i),o=K.getTracer(en);Q.with(Q.active(),(()=>{o.startActiveSpan(t,{attributes:{event_type:t,target_element:i.tagName,target_xpath:s,"http.url":window.location.href}},(t=>{an(n,"stopPropagation",t),an(n,"stopImmediatePropagation",t),nn._eventMap.set(n,t)}))}))}}enable(){var t;if(this._isEnabled)return;const e=this.getRootNode();this._listeners=[],(null!==(t=this._config.eventNames)&&void 0!==t?t:rn).forEach((t=>{const r=nn.createGlobalEventListener(t,this._config.rootNodeId,(()=>this._isEnabled));this._listeners.push({eventName:t,handler:r}),e.addEventListener(t,r,{capture:!0}),e.addEventListener(t,nn.handleEndSpan)})),this._isEnabled=!0}getRootNode(){if(this._config.rootNodeId){const t=document.getElementById(this._config.rootNodeId);return null===t?(this._diag.warn(`Root Node id: ${this._config.rootNodeId} not found!`),document):t}return document}disable(){this._isEnabled=!1,this._listeners.forEach((({eventName:t,handler:e})=>{document.removeEventListener(t,e,{capture:!0}),document.removeEventListener(t,nn.handleEndSpan)})),this._listeners=[]}}nn._eventMap=new WeakMap;const sn=(t,e,r,n)=>e instanceof HTMLElement&&(!!on(e,`on${r}`,n)&&!!e.getAttribute&&!e.hasAttribute("disabled")),on=(t,e,r)=>!(!t||r&&t.id===r)&&(!!t[e]||on(t.parentElement,e,r)),an=(t,e,r)=>{const n=t[e].bind(t);t[e]=()=>{r.end(),n()}};var cn=r(132),un=r(199);class ln{_delegate;constructor(t){this._delegate=t}export(t,e){this._delegate.export(t,e)}forceFlush(){return this._delegate.forceFlush()}shutdown(){return this._delegate.shutdown()}}function hn(t){return{attributes:pn(t.attributes),droppedAttributesCount:0}}function dn(t){return{name:t.name,version:t.version}}function pn(t){return Object.keys(t).map((e=>mn(e,t[e])))}function mn(t,e){return{key:t,value:gn(e)}}function gn(t){const e=typeof t;return"string"===e?{stringValue:t}:"number"===e?Number.isInteger(t)?{intValue:t}:{doubleValue:t}:"boolean"===e?{boolValue:t}:t instanceof Uint8Array?{bytesValue:t}:Array.isArray(t)?{arrayValue:{values:t.map(gn)}}:"object"===e&&null!=t?{kvlistValue:{values:Object.entries(t).map((([t,e])=>mn(t,e)))}}:{}}Math.pow(10,6);const fn=Math.pow(10,9);function _n(t){return t>=48&&t<=57?t-48:t>=97&&t<=102?t-87:t-55}function vn(t){const e=new Uint8Array(t.length/2);let r=0;for(let n=0;n<t.length;n+=2){const i=_n(t.charCodeAt(n)),s=_n(t.charCodeAt(n+1));e[r++]=i<<4|s}return e}function bn(t){const e=BigInt(1e9);return BigInt(t[0])*e+BigInt(t[1])}function wn(t){return e=bn(t),{low:Number(BigInt.asUintN(32,e)),high:Number(BigInt.asUintN(32,e>>BigInt(32)))};var e}const yn="undefined"!=typeof BigInt?function(t){return bn(t).toString()}:function(t){return t[0]*fn+t[1]};function Tn(t){return t}function Sn(t){if(void 0!==t)return vn(t)}const En={encodeHrTime:wn,encodeSpanContext:vn,encodeOptionalSpanContext:Sn};function An(t){if(void 0===t)return En;const e=t.useLongBits??!0,r=t.useHex??!1;return{encodeHrTime:e?wn:yn,encodeSpanContext:r?Tn:vn,encodeOptionalSpanContext:r?Tn:Sn}}function xn(t,e){const r=t.spanContext(),n=t.status,i=t.parentSpanContext?.spanId?e.encodeSpanContext(t.parentSpanContext?.spanId):void 0;return{traceId:e.encodeSpanContext(r.traceId),spanId:e.encodeSpanContext(r.spanId),parentSpanId:i,traceState:r.traceState?.serialize(),name:t.name,kind:null==t.kind?0:t.kind+1,startTimeUnixNano:e.encodeHrTime(t.startTime),endTimeUnixNano:e.encodeHrTime(t.endTime),attributes:pn(t.attributes),droppedAttributesCount:t.droppedAttributesCount,events:t.events.map((t=>function(t,e){return{attributes:t.attributes?pn(t.attributes):[],name:t.name,timeUnixNano:e.encodeHrTime(t.time),droppedAttributesCount:t.droppedAttributesCount||0}}(t,e))),droppedEventsCount:t.droppedEventsCount,status:{code:n.code,message:n.message},links:t.links.map((t=>function(t,e){return{attributes:t.attributes?pn(t.attributes):[],spanId:e.encodeSpanContext(t.context.spanId),traceId:e.encodeSpanContext(t.context.traceId),traceState:t.context.traceState?.serialize(),droppedAttributesCount:t.droppedAttributesCount||0}}(t,e))),droppedLinksCount:t.droppedLinksCount}}function Cn(t,e){const r=function(t){const e=new Map;for(const r of t){let t=e.get(r.resource);t||(t=new Map,e.set(r.resource,t));const n=`${r.instrumentationScope.name}@${r.instrumentationScope.version||""}:${r.instrumentationScope.schemaUrl||""}`;let i=t.get(n);i||(i=[],t.set(n,i)),i.push(r)}return e}(t),n=[],i=r.entries();let s=i.next();for(;!s.done;){const[t,r]=s.value,o=[],a=r.values();let c=a.next();for(;!c.done;){const t=c.value;if(t.length>0){const r=t.map((t=>xn(t,e)));o.push({scope:dn(t[0].instrumentationScope),spans:r,schemaUrl:t[0].instrumentationScope.schemaUrl})}c=a.next()}const u={resource:hn(t),scopeSpans:o,schemaUrl:void 0};n.push(u),s=i.next()}return n}const On={serializeRequest:t=>{const e={resourceSpans:Cn(t,An({useHex:!0,useLongBits:!1}))};return(new TextEncoder).encode(JSON.stringify(e))},deserializeResponse:t=>{if(0===t.length)return{};const e=new TextDecoder;return JSON.parse(e.decode(t))}};class Ln{_transport;constructor(t){this._transport=t}retry(t,e,r){return new Promise(((n,i)=>{setTimeout((()=>{this._transport.send(t,e).then(n,i)}),r)}))}async send(t,e){const r=Date.now()+e;let n=await this._transport.send(t,e),i=5,s=1e3;for(;"retryable"===n.status&&i>0;){i--;const e=Math.max(Math.min(s,5e3)+(.4*Math.random()-.2),0);s*=1.5;const o=n.retryInMillis??e,a=r-Date.now();if(o>a)return n;n=await this.retry(t,a,o)}return n}shutdown(){return this._transport.shutdown()}}function Nn(t){return new Ln(t.transport)}function Mn(t){if(null==t)return;const e=Number.parseInt(t,10);if(Number.isInteger(e))return e>0?1e3*e:-1;const r=new Date(t).getTime()-Date.now();return r>=0?r:0}class Pn{_parameters;constructor(t){this._parameters=t}send(t,e){return new Promise((r=>{const n=new XMLHttpRequest;n.timeout=e,n.open("POST",this._parameters.url);const i=this._parameters.headers();Object.entries(i).forEach((([t,e])=>{n.setRequestHeader(t,e)})),n.ontimeout=t=>{r({status:"failure",error:new Error("XHR request timed out")})},n.onreadystatechange=()=>{var t;n.status>=200&&n.status<=299?(f.debug("XHR success"),r({status:"success"})):n.status&&(t=n.status,[429,502,503,504].includes(t))?r({status:"retryable",retryInMillis:Mn(n.getResponseHeader("Retry-After"))}):0!==n.status&&r({status:"failure",error:new Error("XHR request failed with non-retryable status")})},n.onabort=()=>{r({status:"failure",error:new Error("XHR request aborted")})},n.onerror=()=>{r({status:"failure",error:new Error("XHR request errored")})},n.send(t)}))}shutdown(){}}class Rn{_params;constructor(t){this._params=t}send(t){return new Promise((e=>{navigator.sendBeacon(this._params.url,new Blob([t],{type:this._params.blobType}))?(f.debug("SendBeacon success"),e({status:"success"})):e({status:"failure",error:new Error("SendBeacon failed")})}))}shutdown(){}}class kn{_concurrencyLimit;_sendingPromises=[];constructor(t){this._concurrencyLimit=t}pushPromise(t){if(this.hasReachedLimit())throw new Error("Concurrency Limit reached");this._sendingPromises.push(t);const e=()=>{const e=this._sendingPromises.indexOf(t);this._sendingPromises.splice(e,1)};t.then(e,e)}hasReachedLimit(){return this._sendingPromises.length>=this._concurrencyLimit}async awaitAll(){await Promise.all(this._sendingPromises)}}function In(t){return new kn(t.concurrencyLimit)}var Dn,Un,Bn,Fn,$n,jn;!function(t){t[t.SUCCESS=0]="SUCCESS",t[t.FAILED=1]="FAILED"}(Dn||(Dn={}));class Vn extends Error{code;name="OTLPExporterError";data;constructor(t,e,r){super(t),this.data=r,this.code=e}}class Gn{_transport;_serializer;_responseHandler;_promiseQueue;_timeout;_diagLogger;constructor(t,e,r,n,i){this._transport=t,this._serializer=e,this._responseHandler=r,this._promiseQueue=n,this._timeout=i,this._diagLogger=f.createComponentLogger({namespace:"OTLPExportDelegate"})}export(t,e){if(this._diagLogger.debug("items to be sent",t),this._promiseQueue.hasReachedLimit())return void e({code:Dn.FAILED,error:new Error("Concurrent export limit reached")});const r=this._serializer.serializeRequest(t);null!=r?this._promiseQueue.pushPromise(this._transport.send(r,this._timeout).then((t=>{if("success"!==t.status)"failure"===t.status&&t.error?e({code:Dn.FAILED,error:t.error}):"retryable"===t.status?e({code:Dn.FAILED,error:new Vn("Export failed with retryable status")}):e({code:Dn.FAILED,error:new Vn("Export failed with unknown error")});else{if(null!=t.data)try{this._responseHandler.handleResponse(this._serializer.deserializeResponse(t.data))}catch(e){this._diagLogger.warn("Export succeeded but could not deserialize response - is the response specification compliant?",e,t.data)}e({code:Dn.SUCCESS})}}),(t=>e({code:Dn.FAILED,error:t})))):e({code:Dn.FAILED,error:new Error("Nothing to send")})}forceFlush(){return this._promiseQueue.awaitAll()}async shutdown(){this._diagLogger.debug("shutdown started"),await this.forceFlush(),this._transport.shutdown()}}function Hn(t,e,r){return n={transport:r,serializer:e,promiseHandler:In(t)},i={timeout:t.timeoutMillis},new Gn(n.transport,n.serializer,{handleResponse(t){null!=t&&function(t){return Object.prototype.hasOwnProperty.call(t,"partialSuccess")}(t)&&null!=t.partialSuccess&&0!==Object.keys(t.partialSuccess).length&&f.warn("Received Partial Success response:",JSON.stringify(t.partialSuccess))}},n.promiseHandler,i.timeout);var n,i}function zn(t){if(Number.isFinite(t)&&t>0)return t;throw new Error(`Configuration: timeoutMillis is invalid, expected number greater than 0 (actual: '${t}')`)}function qn(t){if(null!=t)return()=>t}function Wn(t,e,r){return{timeoutMillis:zn(t.timeoutMillis??e.timeoutMillis??r.timeoutMillis),concurrencyLimit:t.concurrencyLimit??e.concurrencyLimit??r.concurrencyLimit,compression:t.compression??e.compression??r.compression}}function Xn(t,e,r){const n={...r()},i={};return()=>(null!=e&&Object.assign(i,e()),null!=t&&Object.assign(i,t()),Object.assign(i,n))}function Kn(t){if(null!=t)try{return new URL(t),t}catch{throw new Error(`Configuration: Could not parse user-provided export URL: '${t}'`)}}function Yn(t,e,r,n){const i=!!t.headers||"function"!=typeof navigator.sendBeacon,s=function(t,e,r){return n={url:t.url,timeoutMillis:t.timeoutMillis,headers:qn(t.headers),concurrencyLimit:t.concurrencyLimit},i={},s=function(t,e){return{timeoutMillis:1e4,concurrencyLimit:30,compression:"none",headers:()=>t,url:"http://localhost:4318/"+e,agentOptions:{keepAlive:!0}}}(r,e),{...Wn(n,i,s),headers:Xn((o=n.headers,()=>{const t={};return Object.entries(o?.()??{}).forEach((([e,r])=>{void 0!==r?t[e]=String(r):f.warn(`Header "${e}" has invalid value (${r}) and will be ignored`)})),t}),i.headers,s.headers),url:Kn(n.url)??i.url??s.url,agentOptions:n.agentOptions??i.agentOptions??s.agentOptions};var n,i,s,o}(t,r,n);return i?function(t,e){return Hn(t,e,Nn({transport:(r=t,new Pn(r))}));var r}(s,e):function(t,e){return Hn(t,e,Nn({transport:(r={url:t.url,blobType:t.headers()["Content-Type"]},new Rn(r))}));var r}(s,e)}class Zn extends ln{constructor(t={}){super(Yn(t,On,"v1/traces",{"Content-Type":"application/json"}))}}!function(t){t[t.DELTA=0]="DELTA",t[t.CUMULATIVE=1]="CUMULATIVE"}(Un||(Un={})),function(t){t.COUNTER="COUNTER",t.GAUGE="GAUGE",t.HISTOGRAM="HISTOGRAM",t.UP_DOWN_COUNTER="UP_DOWN_COUNTER",t.OBSERVABLE_COUNTER="OBSERVABLE_COUNTER",t.OBSERVABLE_GAUGE="OBSERVABLE_GAUGE",t.OBSERVABLE_UP_DOWN_COUNTER="OBSERVABLE_UP_DOWN_COUNTER"}(Bn||(Bn={})),function(t){t[t.HISTOGRAM=0]="HISTOGRAM",t[t.EXPONENTIAL_HISTOGRAM=1]="EXPONENTIAL_HISTOGRAM",t[t.GAUGE=2]="GAUGE",t[t.SUM=3]="SUM"}(Fn||(Fn={})),function(t){t[t.DEFAULT=0]="DEFAULT",t[t.DROP=1]="DROP",t[t.SUM=2]="SUM",t[t.LAST_VALUE=3]="LAST_VALUE",t[t.EXPLICIT_BUCKET_HISTOGRAM=4]="EXPLICIT_BUCKET_HISTOGRAM",t[t.EXPONENTIAL_HISTOGRAM=5]="EXPONENTIAL_HISTOGRAM"}($n||($n={})),function(t){t[t.DELTA=0]="DELTA",t[t.CUMULATIVE=1]="CUMULATIVE",t[t.LOWMEMORY=2]="LOWMEMORY"}(jn||(jn={}));const Qn=()=>Un.CUMULATIVE,Jn=t=>{switch(t){case Bn.COUNTER:case Bn.OBSERVABLE_COUNTER:case Bn.GAUGE:case Bn.HISTOGRAM:case Bn.OBSERVABLE_GAUGE:return Un.DELTA;case Bn.UP_DOWN_COUNTER:case Bn.OBSERVABLE_UP_DOWN_COUNTER:return Un.CUMULATIVE}},ti=t=>{switch(t){case Bn.COUNTER:case Bn.HISTOGRAM:return Un.DELTA;case Bn.GAUGE:case Bn.UP_DOWN_COUNTER:case Bn.OBSERVABLE_UP_DOWN_COUNTER:case Bn.OBSERVABLE_COUNTER:case Bn.OBSERVABLE_GAUGE:return Un.CUMULATIVE}};const ei=Object.freeze({type:$n.DEFAULT});class ri extends ln{_aggregationTemporalitySelector;_aggregationSelector;constructor(t,e){var r;super(t),this._aggregationSelector=function(t){return t?.aggregationPreference??(()=>ei)}(e),this._aggregationTemporalitySelector=(r=e?.temporalityPreference,null!=r?r===jn.DELTA?Jn:r===jn.LOWMEMORY?ti:Qn:function(){const t="cumulative".toLowerCase();return"cumulative"===t?Qn:"delta"===t?Jn:"lowmemory"===t?ti:(f.warn(`OTEL_EXPORTER_OTLP_METRICS_TEMPORALITY_PREFERENCE is set to '${t}', but only 'cumulative' and 'delta' are allowed. Using default ('cumulative') instead.`),Qn)}())}selectAggregation(t){return this._aggregationSelector(t)}selectAggregationTemporality(t){return this._aggregationTemporalitySelector(t)}}var ni;function ii(t,e){return Array.from(t.map((t=>({scope:dn(t.scope),metrics:t.metrics.map((t=>function(t,e){const r={name:t.descriptor.name,description:t.descriptor.description,unit:t.descriptor.unit},n=function(t){switch(t){case Un.DELTA:return ni.AGGREGATION_TEMPORALITY_DELTA;case Un.CUMULATIVE:return ni.AGGREGATION_TEMPORALITY_CUMULATIVE}}(t.aggregationTemporality);switch(t.dataPointType){case Fn.SUM:r.sum={aggregationTemporality:n,isMonotonic:t.isMonotonic,dataPoints:si(t,e)};break;case Fn.GAUGE:r.gauge={dataPoints:si(t,e)};break;case Fn.HISTOGRAM:r.histogram={aggregationTemporality:n,dataPoints:oi(t,e)};break;case Fn.EXPONENTIAL_HISTOGRAM:r.exponentialHistogram={aggregationTemporality:n,dataPoints:ai(t,e)}}return r}(t,e))),schemaUrl:t.scope.schemaUrl}))))}function si(t,e){return t.dataPoints.map((r=>function(t,e,r){const n={attributes:pn(t.attributes),startTimeUnixNano:r.encodeHrTime(t.startTime),timeUnixNano:r.encodeHrTime(t.endTime)};switch(e){case j.INT:n.asInt=t.value;break;case j.DOUBLE:n.asDouble=t.value}return n}(r,t.descriptor.valueType,e)))}function oi(t,e){return t.dataPoints.map((t=>{const r=t.value;return{attributes:pn(t.attributes),bucketCounts:r.buckets.counts,explicitBounds:r.buckets.boundaries,count:r.count,sum:r.sum,min:r.min,max:r.max,startTimeUnixNano:e.encodeHrTime(t.startTime),timeUnixNano:e.encodeHrTime(t.endTime)}}))}function ai(t,e){return t.dataPoints.map((t=>{const r=t.value;return{attributes:pn(t.attributes),count:r.count,min:r.min,max:r.max,sum:r.sum,positive:{offset:r.positive.offset,bucketCounts:r.positive.bucketCounts},negative:{offset:r.negative.offset,bucketCounts:r.negative.bucketCounts},scale:r.scale,zeroCount:r.zeroCount,startTimeUnixNano:e.encodeHrTime(t.startTime),timeUnixNano:e.encodeHrTime(t.endTime)}}))}!function(t){t[t.AGGREGATION_TEMPORALITY_UNSPECIFIED=0]="AGGREGATION_TEMPORALITY_UNSPECIFIED",t[t.AGGREGATION_TEMPORALITY_DELTA=1]="AGGREGATION_TEMPORALITY_DELTA",t[t.AGGREGATION_TEMPORALITY_CUMULATIVE=2]="AGGREGATION_TEMPORALITY_CUMULATIVE"}(ni||(ni={}));const ci={serializeRequest:t=>{const e=(r={useLongBits:!1},{resourceMetrics:[t].map((t=>function(t,e){const r=An(e);return{resource:hn(t.resource),schemaUrl:void 0,scopeMetrics:ii(t.scopeMetrics,r)}}(t,r)))});var r;return(new TextEncoder).encode(JSON.stringify(e))},deserializeResponse:t=>{if(0===t.length)return{};const e=new TextDecoder;return JSON.parse(e.decode(t))}};class ui extends ri{constructor(t){super(Yn(t??{},ci,"v1/metrics",{"Content-Type":"application/json"}),t)}}function li(t,e){const r=function(t){const e=new Map;for(const r of t){const{resource:t,instrumentationScope:{name:n,version:i="",schemaUrl:s=""}}=r;let o=e.get(t);o||(o=new Map,e.set(t,o));const a=`${n}@${i}:${s}`;let c=o.get(a);c||(c=[],o.set(a,c)),c.push(r)}return e}(t);return Array.from(r,(([t,r])=>({resource:hn(t),scopeLogs:Array.from(r,(([,t])=>({scope:dn(t[0].instrumentationScope),logRecords:t.map((t=>function(t,e){return{timeUnixNano:e.encodeHrTime(t.hrTime),observedTimeUnixNano:e.encodeHrTime(t.hrTimeObserved),severityNumber:t.severityNumber,severityText:t.severityText,body:gn(t.body),eventName:t.eventName,attributes:(r=t.attributes,Object.keys(r).map((t=>mn(t,r[t])))),droppedAttributesCount:t.droppedAttributesCount,flags:t.spanContext?.traceFlags,traceId:e.encodeOptionalSpanContext(t.spanContext?.traceId),spanId:e.encodeOptionalSpanContext(t.spanContext?.spanId)};var r}(t,e))),schemaUrl:t[0].instrumentationScope.schemaUrl}))),schemaUrl:void 0})))}const hi={serializeRequest:t=>{const e={resourceLogs:li(t,An({useHex:!0,useLongBits:!1}))};return(new TextEncoder).encode(JSON.stringify(e))},deserializeResponse:t=>{if(0===t.length)return{};const e=new TextDecoder;return JSON.parse(e.decode(t))}};class di extends ln{constructor(t={}){super(Yn(t,hi,"v1/logs",{"Content-Type":"application/json"}))}}class pi{_sessionIdProvider;constructor(t){this._sessionIdProvider=t}async forceFlush(){}onStart(t,e){const r=this._sessionIdProvider?.getSessionId();r&&t.setAttribute("session.id",r)}onEnd(t){}async shutdown(){}}var mi,gi,fi,_i,vi=r(232),bi=r.n(vi);function wi(t){return null!=t}function yi(t){let e=Object.keys(t);return 0===e.length?"":(e=e.sort(),JSON.stringify(e.map((e=>[e,t[e]]))))}!function(t){t[t.DELTA=0]="DELTA",t[t.CUMULATIVE=1]="CUMULATIVE"}(mi||(mi={})),function(t){t.COUNTER="COUNTER",t.GAUGE="GAUGE",t.HISTOGRAM="HISTOGRAM",t.UP_DOWN_COUNTER="UP_DOWN_COUNTER",t.OBSERVABLE_COUNTER="OBSERVABLE_COUNTER",t.OBSERVABLE_GAUGE="OBSERVABLE_GAUGE",t.OBSERVABLE_UP_DOWN_COUNTER="OBSERVABLE_UP_DOWN_COUNTER"}(gi||(gi={})),function(t){t[t.HISTOGRAM=0]="HISTOGRAM",t[t.EXPONENTIAL_HISTOGRAM=1]="EXPONENTIAL_HISTOGRAM",t[t.GAUGE=2]="GAUGE",t[t.SUM=3]="SUM"}(fi||(fi={}));class Ti extends Error{constructor(t){super(t),Object.setPrototypeOf(this,Ti.prototype)}}function Si(t,e){let r;const n=new Promise((function(t,n){r=setTimeout((function(){n(new Ti("Operation timed out."))}),e)}));return Promise.race([t,n]).then((t=>(clearTimeout(r),t)),(t=>{throw clearTimeout(r),t}))}function Ei(t){return"rejected"===t.status}function Ai(t,e){const r=[];return t.forEach((t=>{r.push(...e(t))})),r}!function(t){t[t.DROP=0]="DROP",t[t.SUM=1]="SUM",t[t.LAST_VALUE=2]="LAST_VALUE",t[t.HISTOGRAM=3]="HISTOGRAM",t[t.EXPONENTIAL_HISTOGRAM=4]="EXPONENTIAL_HISTOGRAM"}(_i||(_i={}));class xi{kind=_i.DROP;createAccumulation(){}merge(t,e){}diff(t,e){}toMetricData(t,e,r,n){}}class Ci{startTime;_boundaries;_recordMinMax;_current;constructor(t,e,r=!0,n=function(t){const e=t.map((()=>0));return e.push(0),{buckets:{boundaries:t,counts:e},sum:0,count:0,hasMinMax:!1,min:1/0,max:-1/0}}(e)){this.startTime=t,this._boundaries=e,this._recordMinMax=r,this._current=n}record(t){if(Number.isNaN(t))return;this._current.count+=1,this._current.sum+=t,this._recordMinMax&&(this._current.min=Math.min(t,this._current.min),this._current.max=Math.max(t,this._current.max),this._current.hasMinMax=!0);const e=function(t,e){let r=0,n=t.length-1,i=t.length;for(;n>=r;){const s=r+Math.trunc((n-r)/2);t[s]<e?r=s+1:(i=s,n=s-1)}return i}(this._boundaries,t);this._current.buckets.counts[e]+=1}setStartTime(t){this.startTime=t}toPointValue(){return this._current}}class Oi{_boundaries;_recordMinMax;kind=_i.HISTOGRAM;constructor(t,e){this._boundaries=t,this._recordMinMax=e}createAccumulation(t){return new Ci(t,this._boundaries,this._recordMinMax)}merge(t,e){const r=t.toPointValue(),n=e.toPointValue(),i=r.buckets.counts,s=n.buckets.counts,o=new Array(i.length);for(let t=0;t<i.length;t++)o[t]=i[t]+s[t];let a=1/0,c=-1/0;return this._recordMinMax&&(r.hasMinMax&&n.hasMinMax?(a=Math.min(r.min,n.min),c=Math.max(r.max,n.max)):r.hasMinMax?(a=r.min,c=r.max):n.hasMinMax&&(a=n.min,c=n.max)),new Ci(t.startTime,r.buckets.boundaries,this._recordMinMax,{buckets:{boundaries:r.buckets.boundaries,counts:o},count:r.count+n.count,sum:r.sum+n.sum,hasMinMax:this._recordMinMax&&(r.hasMinMax||n.hasMinMax),min:a,max:c})}diff(t,e){const r=t.toPointValue(),n=e.toPointValue(),i=r.buckets.counts,s=n.buckets.counts,o=new Array(i.length);for(let t=0;t<i.length;t++)o[t]=s[t]-i[t];return new Ci(e.startTime,r.buckets.boundaries,this._recordMinMax,{buckets:{boundaries:r.buckets.boundaries,counts:o},count:n.count-r.count,sum:n.sum-r.sum,hasMinMax:!1,min:1/0,max:-1/0})}toMetricData(t,e,r,n){return{descriptor:t,aggregationTemporality:e,dataPointType:fi.HISTOGRAM,dataPoints:r.map((([e,r])=>{const i=r.toPointValue(),s=t.type===gi.GAUGE||t.type===gi.UP_DOWN_COUNTER||t.type===gi.OBSERVABLE_GAUGE||t.type===gi.OBSERVABLE_UP_DOWN_COUNTER;return{attributes:e,startTime:r.startTime,endTime:n,value:{min:i.hasMinMax?i.min:void 0,max:i.hasMinMax?i.max:void 0,sum:s?void 0:i.sum,buckets:i.buckets,count:i.count}}}))}}}class Li{backing;indexBase;indexStart;indexEnd;constructor(t=new Ni,e=0,r=0,n=0){this.backing=t,this.indexBase=e,this.indexStart=r,this.indexEnd=n}get offset(){return this.indexStart}get length(){return 0===this.backing.length||this.indexEnd===this.indexStart&&0===this.at(0)?0:this.indexEnd-this.indexStart+1}counts(){return Array.from({length:this.length},((t,e)=>this.at(e)))}at(t){const e=this.indexBase-this.indexStart;return t<e&&(t+=this.backing.length),t-=e,this.backing.countAt(t)}incrementBucket(t,e){this.backing.increment(t,e)}decrementBucket(t,e){this.backing.decrement(t,e)}trim(){for(let t=0;t<this.length;t++){if(0!==this.at(t)){this.indexStart+=t;break}if(t===this.length-1)return void(this.indexStart=this.indexEnd=this.indexBase=0)}for(let t=this.length-1;t>=0;t--)if(0!==this.at(t)){this.indexEnd-=this.length-t-1;break}this._rotate()}downscale(t){this._rotate();const e=1+this.indexEnd-this.indexStart,r=1<<t;let n=0,i=0;for(let t=this.indexStart;t<=this.indexEnd;){let s=t%r;s<0&&(s+=r);for(let o=s;o<r&&n<e;o++)this._relocateBucket(i,n),n++,t++;i++}this.indexStart>>=t,this.indexEnd>>=t,this.indexBase=this.indexStart}clone(){return new Li(this.backing.clone(),this.indexBase,this.indexStart,this.indexEnd)}_rotate(){const t=this.indexBase-this.indexStart;0!==t&&(t>0?(this.backing.reverse(0,this.backing.length),this.backing.reverse(0,t),this.backing.reverse(t,this.backing.length)):(this.backing.reverse(0,this.backing.length),this.backing.reverse(0,this.backing.length+t)),this.indexBase=this.indexStart)}_relocateBucket(t,e){t!==e&&this.incrementBucket(t,this.backing.emptyBucket(e))}}class Ni{_counts;constructor(t=[0]){this._counts=t}get length(){return this._counts.length}countAt(t){return this._counts[t]}growTo(t,e,r){const n=new Array(t).fill(0);n.splice(r,this._counts.length-e,...this._counts.slice(e)),n.splice(0,e,...this._counts.slice(0,e)),this._counts=n}reverse(t,e){const r=Math.floor((t+e)/2)-t;for(let n=0;n<r;n++){const r=this._counts[t+n];this._counts[t+n]=this._counts[e-n-1],this._counts[e-n-1]=r}}emptyBucket(t){const e=this._counts[t];return this._counts[t]=0,e}increment(t,e){this._counts[t]+=e}decrement(t,e){this._counts[t]>=e?this._counts[t]-=e:this._counts[t]=0}clone(){return new Ni([...this._counts])}}const Mi=Math.pow(2,-1022);function Pi(t){const e=new DataView(new ArrayBuffer(8));return e.setFloat64(0,t),((2146435072&e.getUint32(0))>>20)-1023}function Ri(t){const e=new DataView(new ArrayBuffer(8));e.setFloat64(0,t);const r=e.getUint32(0),n=e.getUint32(4);return(1048575&r)*Math.pow(2,32)+n}function ki(t,e){return 0===t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY||Number.isNaN(t)?t:t*Math.pow(2,e)}class Ii extends Error{}class Di{_shift;constructor(t){this._shift=-t}mapToIndex(t){return t<Mi?this._minNormalLowerBoundaryIndex():Pi(t)+this._rightShift(Ri(t)-1,52)>>this._shift}lowerBoundary(t){const e=this._minNormalLowerBoundaryIndex();if(t<e)throw new Ii(`underflow: ${t} is < minimum lower boundary: ${e}`);const r=this._maxNormalLowerBoundaryIndex();if(t>r)throw new Ii(`overflow: ${t} is > maximum lower boundary: ${r}`);return ki(1,t<<this._shift)}get scale(){return 0===this._shift?0:-this._shift}_minNormalLowerBoundaryIndex(){let t=-1022>>this._shift;return this._shift<2&&t--,t}_maxNormalLowerBoundaryIndex(){return 1023>>this._shift}_rightShift(t,e){return Math.floor(t*Math.pow(2,-e))}}class Ui{_scale;_scaleFactor;_inverseFactor;constructor(t){this._scale=t,this._scaleFactor=ki(Math.LOG2E,t),this._inverseFactor=ki(Math.LN2,-t)}mapToIndex(t){if(t<=Mi)return this._minNormalLowerBoundaryIndex()-1;if(0===Ri(t))return(Pi(t)<<this._scale)-1;const e=Math.floor(Math.log(t)*this._scaleFactor),r=this._maxNormalLowerBoundaryIndex();return e>=r?r:e}lowerBoundary(t){const e=this._maxNormalLowerBoundaryIndex();if(t>=e){if(t===e)return 2*Math.exp((t-(1<<this._scale))/this._scaleFactor);throw new Ii(`overflow: ${t} is > maximum lower boundary: ${e}`)}const r=this._minNormalLowerBoundaryIndex();if(t<=r){if(t===r)return Mi;if(t===r-1)return Math.exp((t+(1<<this._scale))/this._scaleFactor)/2;throw new Ii(`overflow: ${t} is < minimum lower boundary: ${r}`)}return Math.exp(t*this._inverseFactor)}get scale(){return this._scale}_minNormalLowerBoundaryIndex(){return-1022<<this._scale}_maxNormalLowerBoundaryIndex(){return(1024<<this._scale)-1}}const Bi=Array.from({length:31},((t,e)=>e>10?new Ui(e-10):new Di(e-10)));function Fi(t){if(t>20||t<-10)throw new Ii(`expected scale >= -10 && <= 20, got: ${t}`);return Bi[t+10]}class $i{low;high;static combine(t,e){return new $i(Math.min(t.low,e.low),Math.max(t.high,e.high))}constructor(t,e){this.low=t,this.high=e}}class ji{startTime;_maxSize;_recordMinMax;_sum;_count;_zeroCount;_min;_max;_positive;_negative;_mapping;constructor(t=t,e=160,r=!0,n=0,i=0,s=0,o=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY,c=new Li,u=new Li,l=Fi(20)){this.startTime=t,this._maxSize=e,this._recordMinMax=r,this._sum=n,this._count=i,this._zeroCount=s,this._min=o,this._max=a,this._positive=c,this._negative=u,this._mapping=l,this._maxSize<2&&(f.warn(`Exponential Histogram Max Size set to ${this._maxSize},                 changing to the minimum size of: 2`),this._maxSize=2)}record(t){this.updateByIncrement(t,1)}setStartTime(t){this.startTime=t}toPointValue(){return{hasMinMax:this._recordMinMax,min:this.min,max:this.max,sum:this.sum,positive:{offset:this.positive.offset,bucketCounts:this.positive.counts()},negative:{offset:this.negative.offset,bucketCounts:this.negative.counts()},count:this.count,scale:this.scale,zeroCount:this.zeroCount}}get sum(){return this._sum}get min(){return this._min}get max(){return this._max}get count(){return this._count}get zeroCount(){return this._zeroCount}get scale(){return this._count===this._zeroCount?0:this._mapping.scale}get positive(){return this._positive}get negative(){return this._negative}updateByIncrement(t,e){Number.isNaN(t)||(t>this._max&&(this._max=t),t<this._min&&(this._min=t),this._count+=e,0!==t?(this._sum+=t*e,t>0?this._updateBuckets(this._positive,t,e):this._updateBuckets(this._negative,-t,e)):this._zeroCount+=e)}merge(t){0===this._count?(this._min=t.min,this._max=t.max):0!==t.count&&(t.min<this.min&&(this._min=t.min),t.max>this.max&&(this._max=t.max)),this.startTime=t.startTime,this._sum+=t.sum,this._count+=t.count,this._zeroCount+=t.zeroCount;const e=this._minScale(t);this._downscale(this.scale-e),this._mergeBuckets(this.positive,t,t.positive,e),this._mergeBuckets(this.negative,t,t.negative,e)}diff(t){this._min=1/0,this._max=-1/0,this._sum-=t.sum,this._count-=t.count,this._zeroCount-=t.zeroCount;const e=this._minScale(t);this._downscale(this.scale-e),this._diffBuckets(this.positive,t,t.positive,e),this._diffBuckets(this.negative,t,t.negative,e)}clone(){return new ji(this.startTime,this._maxSize,this._recordMinMax,this._sum,this._count,this._zeroCount,this._min,this._max,this.positive.clone(),this.negative.clone(),this._mapping)}_updateBuckets(t,e,r){let n=this._mapping.mapToIndex(e),i=!1,s=0,o=0;if(0===t.length?(t.indexStart=n,t.indexEnd=t.indexStart,t.indexBase=t.indexStart):n<t.indexStart&&t.indexEnd-n>=this._maxSize?(i=!0,o=n,s=t.indexEnd):n>t.indexEnd&&n-t.indexStart>=this._maxSize&&(i=!0,o=t.indexStart,s=n),i){const t=this._changeScale(s,o);this._downscale(t),n=this._mapping.mapToIndex(e)}this._incrementIndexBy(t,n,r)}_incrementIndexBy(t,e,r){if(0===r)return;if(0===t.length&&(t.indexStart=t.indexEnd=t.indexBase=e),e<t.indexStart){const r=t.indexEnd-e;r>=t.backing.length&&this._grow(t,r+1),t.indexStart=e}else if(e>t.indexEnd){const r=e-t.indexStart;r>=t.backing.length&&this._grow(t,r+1),t.indexEnd=e}let n=e-t.indexBase;n<0&&(n+=t.backing.length),t.incrementBucket(n,r)}_grow(t,e){const r=t.backing.length,n=t.indexBase-t.indexStart,i=r-n;let s=function(t){return t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,++t}(e);s>this._maxSize&&(s=this._maxSize);const o=s-n;t.backing.growTo(s,i,o)}_changeScale(t,e){let r=0;for(;t-e>=this._maxSize;)t>>=1,e>>=1,r++;return r}_downscale(t){if(0===t)return;if(t<0)throw new Error(`impossible change of scale: ${this.scale}`);const e=this._mapping.scale-t;this._positive.downscale(t),this._negative.downscale(t),this._mapping=Fi(e)}_minScale(t){const e=Math.min(this.scale,t.scale),r=$i.combine(this._highLowAtScale(this.positive,this.scale,e),this._highLowAtScale(t.positive,t.scale,e)),n=$i.combine(this._highLowAtScale(this.negative,this.scale,e),this._highLowAtScale(t.negative,t.scale,e));return Math.min(e-this._changeScale(r.high,r.low),e-this._changeScale(n.high,n.low))}_highLowAtScale(t,e,r){if(0===t.length)return new $i(0,-1);const n=e-r;return new $i(t.indexStart>>n,t.indexEnd>>n)}_mergeBuckets(t,e,r,n){const i=r.offset,s=e.scale-n;for(let e=0;e<r.length;e++)this._incrementIndexBy(t,i+e>>s,r.at(e))}_diffBuckets(t,e,r,n){const i=r.offset,s=e.scale-n;for(let e=0;e<r.length;e++){let n=(i+e>>s)-t.indexBase;n<0&&(n+=t.backing.length),t.decrementBucket(n,r.at(e))}t.trim()}}class Vi{_maxSize;_recordMinMax;kind=_i.EXPONENTIAL_HISTOGRAM;constructor(t,e){this._maxSize=t,this._recordMinMax=e}createAccumulation(t){return new ji(t,this._maxSize,this._recordMinMax)}merge(t,e){const r=e.clone();return r.merge(t),r}diff(t,e){const r=e.clone();return r.diff(t),r}toMetricData(t,e,r,n){return{descriptor:t,aggregationTemporality:e,dataPointType:fi.EXPONENTIAL_HISTOGRAM,dataPoints:r.map((([e,r])=>{const i=r.toPointValue(),s=t.type===gi.GAUGE||t.type===gi.UP_DOWN_COUNTER||t.type===gi.OBSERVABLE_GAUGE||t.type===gi.OBSERVABLE_UP_DOWN_COUNTER;return{attributes:e,startTime:r.startTime,endTime:n,value:{min:i.hasMinMax?i.min:void 0,max:i.hasMinMax?i.max:void 0,sum:s?void 0:i.sum,positive:{offset:i.positive.offset,bucketCounts:i.positive.bucketCounts},negative:{offset:i.negative.offset,bucketCounts:i.negative.bucketCounts},count:i.count,scale:i.scale,zeroCount:i.zeroCount}}}))}}}class Gi{startTime;_current;sampleTime;constructor(t,e=0,r=[0,0]){this.startTime=t,this._current=e,this.sampleTime=r}record(t){this._current=t,this.sampleTime=rr(Date.now())}setStartTime(t){this.startTime=t}toPointValue(){return this._current}}class Hi{kind=_i.LAST_VALUE;createAccumulation(t){return new Gi(t)}merge(t,e){const r=or(e.sampleTime)>=or(t.sampleTime)?e:t;return new Gi(t.startTime,r.toPointValue(),r.sampleTime)}diff(t,e){const r=or(e.sampleTime)>=or(t.sampleTime)?e:t;return new Gi(e.startTime,r.toPointValue(),r.sampleTime)}toMetricData(t,e,r,n){return{descriptor:t,aggregationTemporality:e,dataPointType:fi.GAUGE,dataPoints:r.map((([t,e])=>({attributes:t,startTime:e.startTime,endTime:n,value:e.toPointValue()})))}}}class zi{startTime;monotonic;_current;reset;constructor(t,e,r=0,n=!1){this.startTime=t,this.monotonic=e,this._current=r,this.reset=n}record(t){this.monotonic&&t<0||(this._current+=t)}setStartTime(t){this.startTime=t}toPointValue(){return this._current}}class qi{monotonic;kind=_i.SUM;constructor(t){this.monotonic=t}createAccumulation(t){return new zi(t,this.monotonic)}merge(t,e){const r=t.toPointValue(),n=e.toPointValue();return e.reset?new zi(e.startTime,this.monotonic,n,e.reset):new zi(t.startTime,this.monotonic,r+n)}diff(t,e){const r=t.toPointValue(),n=e.toPointValue();return this.monotonic&&r>n?new zi(e.startTime,this.monotonic,n,!0):new zi(e.startTime,this.monotonic,n-r)}toMetricData(t,e,r,n){return{descriptor:t,aggregationTemporality:e,dataPointType:fi.SUM,dataPoints:r.map((([t,e])=>({attributes:t,startTime:e.startTime,endTime:n,value:e.toPointValue()}))),isMonotonic:this.monotonic}}}class Wi{static DEFAULT_INSTANCE=new xi;createAggregator(t){return Wi.DEFAULT_INSTANCE}}class Xi{static MONOTONIC_INSTANCE=new qi(!0);static NON_MONOTONIC_INSTANCE=new qi(!1);createAggregator(t){switch(t.type){case gi.COUNTER:case gi.OBSERVABLE_COUNTER:case gi.HISTOGRAM:return Xi.MONOTONIC_INSTANCE;default:return Xi.NON_MONOTONIC_INSTANCE}}}class Ki{static DEFAULT_INSTANCE=new Hi;createAggregator(t){return Ki.DEFAULT_INSTANCE}}class Yi{static DEFAULT_INSTANCE=new Oi([0,5,10,25,50,75,100,250,500,750,1e3,2500,5e3,7500,1e4],!0);createAggregator(t){return Yi.DEFAULT_INSTANCE}}class Zi{_recordMinMax;_boundaries;constructor(t,e=!0){if(this._recordMinMax=e,null==t)throw new Error("ExplicitBucketHistogramAggregation should be created with explicit boundaries, if a single bucket histogram is required, please pass an empty array");t=(t=t.concat()).sort(((t,e)=>t-e));const r=t.lastIndexOf(-1/0);let n=t.indexOf(1/0);-1===n&&(n=void 0),this._boundaries=t.slice(r+1,n)}createAggregator(t){return new Oi(this._boundaries,this._recordMinMax)}}class Qi{_maxSize;_recordMinMax;constructor(t=160,e=!0){this._maxSize=t,this._recordMinMax=e}createAggregator(t){return new Vi(this._maxSize,this._recordMinMax)}}const Ji=new Wi,ts=new Xi,es=new Ki,rs=new Yi,ns=new class{_resolve(t){switch(t.type){case gi.COUNTER:case gi.UP_DOWN_COUNTER:case gi.OBSERVABLE_COUNTER:case gi.OBSERVABLE_UP_DOWN_COUNTER:return ts;case gi.GAUGE:case gi.OBSERVABLE_GAUGE:return es;case gi.HISTOGRAM:return t.advice.explicitBucketBoundaries?new Zi(t.advice.explicitBucketBoundaries):rs}return f.warn(`Unable to recognize instrument type: ${t.type}`),Ji}createAggregator(t){return this._resolve(t).createAggregator(t)}};var is;function ss(t){switch(t.type){case is.DEFAULT:return ns;case is.DROP:return Ji;case is.SUM:return ts;case is.LAST_VALUE:return es;case is.EXPONENTIAL_HISTOGRAM:{const e=t;return new Qi(e.options?.maxSize,e.options?.recordMinMax)}case is.EXPLICIT_BUCKET_HISTOGRAM:{const e=t;return null==e.options?rs:new Zi(e.options?.boundaries,e.options?.recordMinMax)}default:throw new Error("Unsupported Aggregation")}}!function(t){t[t.DEFAULT=0]="DEFAULT",t[t.DROP=1]="DROP",t[t.SUM=2]="SUM",t[t.LAST_VALUE=3]="LAST_VALUE",t[t.EXPLICIT_BUCKET_HISTOGRAM=4]="EXPLICIT_BUCKET_HISTOGRAM",t[t.EXPONENTIAL_HISTOGRAM=5]="EXPONENTIAL_HISTOGRAM"}(is||(is={}));const os=t=>({type:is.DEFAULT}),as=t=>mi.CUMULATIVE;class cs{_shutdown=!1;_metricProducers;_sdkMetricProducer;_aggregationTemporalitySelector;_aggregationSelector;_cardinalitySelector;constructor(t){this._aggregationSelector=t?.aggregationSelector??os,this._aggregationTemporalitySelector=t?.aggregationTemporalitySelector??as,this._metricProducers=t?.metricProducers??[],this._cardinalitySelector=t?.cardinalitySelector}setMetricProducer(t){if(this._sdkMetricProducer)throw new Error("MetricReader can not be bound to a MeterProvider again.");this._sdkMetricProducer=t,this.onInitialized()}selectAggregation(t){return this._aggregationSelector(t)}selectAggregationTemporality(t){return this._aggregationTemporalitySelector(t)}selectCardinalityLimit(t){return this._cardinalitySelector?this._cardinalitySelector(t):2e3}onInitialized(){}async collect(t){if(void 0===this._sdkMetricProducer)throw new Error("MetricReader is not bound to a MetricProducer");if(this._shutdown)throw new Error("MetricReader is shutdown");const[e,...r]=await Promise.all([this._sdkMetricProducer.collect({timeoutMillis:t?.timeoutMillis}),...this._metricProducers.map((e=>e.collect({timeoutMillis:t?.timeoutMillis})))]),n=e.errors.concat(Ai(r,(t=>t.errors)));return{resourceMetrics:{resource:e.resourceMetrics.resource,scopeMetrics:e.resourceMetrics.scopeMetrics.concat(Ai(r,(t=>t.resourceMetrics.scopeMetrics)))},errors:n}}async shutdown(t){this._shutdown?f.error("Cannot call shutdown twice."):(null==t?.timeoutMillis?await this.onShutdown():await Si(this.onShutdown(),t.timeoutMillis),this._shutdown=!0)}async forceFlush(t){this._shutdown?f.warn("Cannot forceFlush on already shutdown MetricReader."):null!=t?.timeoutMillis?await Si(this.onForceFlush(),t.timeoutMillis):await this.onForceFlush()}}class us extends cs{_interval;_exporter;_exportInterval;_exportTimeout;constructor(t){if(super({aggregationSelector:t.exporter.selectAggregation?.bind(t.exporter),aggregationTemporalitySelector:t.exporter.selectAggregationTemporality?.bind(t.exporter),metricProducers:t.metricProducers}),void 0!==t.exportIntervalMillis&&t.exportIntervalMillis<=0)throw Error("exportIntervalMillis must be greater than 0");if(void 0!==t.exportTimeoutMillis&&t.exportTimeoutMillis<=0)throw Error("exportTimeoutMillis must be greater than 0");if(void 0!==t.exportTimeoutMillis&&void 0!==t.exportIntervalMillis&&t.exportIntervalMillis<t.exportTimeoutMillis)throw Error("exportIntervalMillis must be greater than or equal to exportTimeoutMillis");this._exportInterval=t.exportIntervalMillis??6e4,this._exportTimeout=t.exportTimeoutMillis??3e4,this._exporter=t.exporter}async _runOnce(){try{await Si(this._doRun(),this._exportTimeout)}catch(t){if(t instanceof Ti)return void f.error("Export took longer than %s milliseconds and timed out.",this._exportTimeout);_e(t)}}async _doRun(){const{resourceMetrics:t,errors:e}=await this.collect({timeoutMillis:this._exportTimeout});if(e.length>0&&f.error("PeriodicExportingMetricReader: metrics collection errors",...e),t.resource.asyncAttributesPending)try{await(t.resource.waitForAsyncAttributes?.())}catch(t){f.debug("Error while resolving async portion of resource: ",t),_e(t)}if(0===t.scopeMetrics.length)return;const r=await Vr(this._exporter,t);if(r.code!==fe.SUCCESS)throw new Error(`PeriodicExportingMetricReader: metrics export failed (error ${r.error})`)}onInitialized(){this._interval=setInterval((()=>{this._runOnce()}),this._exportInterval),this._interval}async onForceFlush(){await this._runOnce(),await this._exporter.forceFlush()}async onShutdown(){this._interval&&clearInterval(this._interval),await this.onForceFlush(),await this._exporter.shutdown()}}class ls{_shutdown=!1;_temporalitySelector;constructor(t){this._temporalitySelector=t?.temporalitySelector??as}export(t,e){if(!this._shutdown)return ls._sendMetrics(t,e);setImmediate(e,{code:fe.FAILED})}forceFlush(){return Promise.resolve()}selectAggregationTemporality(t){return this._temporalitySelector(t)}shutdown(){return this._shutdown=!0,Promise.resolve()}static _sendMetrics(t,e){for(const e of t.scopeMetrics)for(const t of e.metrics)console.dir({descriptor:t.descriptor,dataPointType:t.dataPointType,dataPoints:t.dataPoints},{depth:null});e({code:fe.SUCCESS})}}class hs{_registeredViews=[];addView(t){this._registeredViews.push(t)}findViews(t,e){return this._registeredViews.filter((r=>this._matchInstrument(r.instrumentSelector,t)&&this._matchMeter(r.meterSelector,e)))}_matchInstrument(t,e){return(void 0===t.getType()||e.type===t.getType())&&t.getNameFilter().match(e.name)&&t.getUnitFilter().match(e.unit)}_matchMeter(t,e){return t.getNameFilter().match(e.name)&&(void 0===e.version||t.getVersionFilter().match(e.version))&&(void 0===e.schemaUrl||t.getSchemaUrlFilter().match(e.schemaUrl))}}function ds(t,e,r){return function(t){return null!=t.match(ps)}(t)||f.warn(`Invalid metric name: "${t}". The metric name should be a ASCII string with a length no greater than 255 characters.`),{name:t,type:e,description:r?.description??"",unit:r?.unit??"",valueType:r?.valueType??j.DOUBLE,advice:r?.advice??{}}}const ps=/^[a-z][a-z0-9_.\-/]{0,254}$/i;class ms{_writableMetricStorage;_descriptor;constructor(t,e){this._writableMetricStorage=t,this._descriptor=e}_record(t,e={},r=Q.active()){"number"==typeof t?(this._descriptor.valueType!==j.INT||Number.isInteger(t)||(f.warn(`INT value type cannot accept a floating-point value for ${this._descriptor.name}, ignoring the fractional digits.`),t=Math.trunc(t),Number.isInteger(t)))&&this._writableMetricStorage.record(t,e,r,rr(Date.now())):f.warn(`non-number value provided to metric ${this._descriptor.name}: ${t}`)}}class gs extends ms{add(t,e,r){this._record(t,e,r)}}class fs extends ms{add(t,e,r){t<0?f.warn(`negative value provided to counter ${this._descriptor.name}: ${t}`):this._record(t,e,r)}}class _s extends ms{record(t,e,r){this._record(t,e,r)}}class vs extends ms{record(t,e,r){t<0?f.warn(`negative value provided to histogram ${this._descriptor.name}: ${t}`):this._record(t,e,r)}}class bs{_observableRegistry;_metricStorages;_descriptor;constructor(t,e,r){this._observableRegistry=r,this._descriptor=t,this._metricStorages=e}addCallback(t){this._observableRegistry.addCallback(t,this)}removeCallback(t){this._observableRegistry.removeCallback(t,this)}}class ws extends bs{}class ys extends bs{}class Ts extends bs{}function Ss(t){return t instanceof bs}class Es{_meterSharedState;constructor(t){this._meterSharedState=t}createGauge(t,e){const r=ds(t,gi.GAUGE,e),n=this._meterSharedState.registerMetricStorage(r);return new _s(n,r)}createHistogram(t,e){const r=ds(t,gi.HISTOGRAM,e),n=this._meterSharedState.registerMetricStorage(r);return new vs(n,r)}createCounter(t,e){const r=ds(t,gi.COUNTER,e),n=this._meterSharedState.registerMetricStorage(r);return new fs(n,r)}createUpDownCounter(t,e){const r=ds(t,gi.UP_DOWN_COUNTER,e),n=this._meterSharedState.registerMetricStorage(r);return new gs(n,r)}createObservableGauge(t,e){const r=ds(t,gi.OBSERVABLE_GAUGE,e),n=this._meterSharedState.registerAsyncMetricStorage(r);return new ys(r,n,this._meterSharedState.observableRegistry)}createObservableCounter(t,e){const r=ds(t,gi.OBSERVABLE_COUNTER,e),n=this._meterSharedState.registerAsyncMetricStorage(r);return new ws(r,n,this._meterSharedState.observableRegistry)}createObservableUpDownCounter(t,e){const r=ds(t,gi.OBSERVABLE_UP_DOWN_COUNTER,e),n=this._meterSharedState.registerAsyncMetricStorage(r);return new Ts(r,n,this._meterSharedState.observableRegistry)}addBatchObservableCallback(t,e){this._meterSharedState.observableRegistry.addBatchCallback(t,e)}removeBatchObservableCallback(t,e){this._meterSharedState.observableRegistry.removeBatchCallback(t,e)}}class As{_instrumentDescriptor;constructor(t){this._instrumentDescriptor=t}getInstrumentDescriptor(){return this._instrumentDescriptor}updateDescription(t){this._instrumentDescriptor=ds(this._instrumentDescriptor.name,this._instrumentDescriptor.type,{description:t,valueType:this._instrumentDescriptor.valueType,unit:this._instrumentDescriptor.unit,advice:this._instrumentDescriptor.advice})}}class xs{_hash;_valueMap=new Map;_keyMap=new Map;constructor(t){this._hash=t}get(t,e){return e??=this._hash(t),this._valueMap.get(e)}getOrDefault(t,e){const r=this._hash(t);if(this._valueMap.has(r))return this._valueMap.get(r);const n=e();return this._keyMap.has(r)||this._keyMap.set(r,t),this._valueMap.set(r,n),n}set(t,e,r){r??=this._hash(t),this._keyMap.has(r)||this._keyMap.set(r,t),this._valueMap.set(r,e)}has(t,e){return e??=this._hash(t),this._valueMap.has(e)}*keys(){const t=this._keyMap.entries();let e=t.next();for(;!0!==e.done;)yield[e.value[1],e.value[0]],e=t.next()}*entries(){const t=this._valueMap.entries();let e=t.next();for(;!0!==e.done;)yield[this._keyMap.get(e.value[0]),e.value[1],e.value[0]],e=t.next()}get size(){return this._valueMap.size}}class Cs extends xs{constructor(){super(yi)}}class Os{_aggregator;_activeCollectionStorage=new Cs;_cumulativeMemoStorage=new Cs;_cardinalityLimit;_overflowAttributes={"otel.metric.overflow":!0};_overflowHashCode;constructor(t,e){this._aggregator=t,this._cardinalityLimit=(e??2e3)-1,this._overflowHashCode=yi(this._overflowAttributes)}record(t,e,r,n){let i=this._activeCollectionStorage.get(e);if(!i){if(this._activeCollectionStorage.size>=this._cardinalityLimit){const e=this._activeCollectionStorage.getOrDefault(this._overflowAttributes,(()=>this._aggregator.createAccumulation(n)));return void e?.record(t)}i=this._aggregator.createAccumulation(n),this._activeCollectionStorage.set(e,i)}i?.record(t)}batchCumulate(t,e){Array.from(t.entries()).forEach((([t,r,n])=>{const i=this._aggregator.createAccumulation(e);i?.record(r);let s=i;if(this._cumulativeMemoStorage.has(t,n)){const e=this._cumulativeMemoStorage.get(t,n);s=this._aggregator.diff(e,i)}else if(this._cumulativeMemoStorage.size>=this._cardinalityLimit&&(t=this._overflowAttributes,n=this._overflowHashCode,this._cumulativeMemoStorage.has(t,n))){const e=this._cumulativeMemoStorage.get(t,n);s=this._aggregator.diff(e,i)}if(this._activeCollectionStorage.has(t,n)){const e=this._activeCollectionStorage.get(t,n);s=this._aggregator.merge(e,s)}this._cumulativeMemoStorage.set(t,i,n),this._activeCollectionStorage.set(t,s,n)}))}collect(){const t=this._activeCollectionStorage;return this._activeCollectionStorage=new Cs,t}}class Ls{_aggregator;_unreportedAccumulations=new Map;_reportHistory=new Map;constructor(t,e){this._aggregator=t,e.forEach((t=>{this._unreportedAccumulations.set(t,[])}))}buildMetrics(t,e,r,n){this._stashAccumulations(r);const i=this._getMergedUnreportedAccumulations(t);let s,o=i;if(this._reportHistory.has(t)){const e=this._reportHistory.get(t),r=e.collectionTime;s=e.aggregationTemporality,o=s===mi.CUMULATIVE?Ls.merge(e.accumulations,i,this._aggregator):Ls.calibrateStartTime(e.accumulations,i,r)}else s=t.selectAggregationTemporality(e.type);this._reportHistory.set(t,{accumulations:o,collectionTime:n,aggregationTemporality:s});const a=(c=o,Array.from(c.entries()));var c;if(0!==a.length)return this._aggregator.toMetricData(e,s,a,n)}_stashAccumulations(t){const e=this._unreportedAccumulations.keys();for(const r of e){let e=this._unreportedAccumulations.get(r);void 0===e&&(e=[],this._unreportedAccumulations.set(r,e)),e.push(t)}}_getMergedUnreportedAccumulations(t){let e=new Cs;const r=this._unreportedAccumulations.get(t);if(this._unreportedAccumulations.set(t,[]),void 0===r)return e;for(const t of r)e=Ls.merge(e,t,this._aggregator);return e}static merge(t,e,r){const n=t,i=e.entries();let s=i.next();for(;!0!==s.done;){const[e,o,a]=s.value;if(t.has(e,a)){const i=t.get(e,a),s=r.merge(i,o);n.set(e,s,a)}else n.set(e,o,a);s=i.next()}return n}static calibrateStartTime(t,e,r){for(const[n,i]of t.keys()){const t=e.get(n,i);t?.setStartTime(r)}return e}}class Ns extends As{_attributesProcessor;_aggregationCardinalityLimit;_deltaMetricStorage;_temporalMetricStorage;constructor(t,e,r,n,i){super(t),this._attributesProcessor=r,this._aggregationCardinalityLimit=i,this._deltaMetricStorage=new Os(e,this._aggregationCardinalityLimit),this._temporalMetricStorage=new Ls(e,n)}record(t,e){const r=new Cs;Array.from(t.entries()).forEach((([t,e])=>{r.set(this._attributesProcessor.process(t),e)})),this._deltaMetricStorage.batchCumulate(r,e)}collect(t,e){const r=this._deltaMetricStorage.collect();return this._temporalMetricStorage.buildMetrics(t,this._instrumentDescriptor,r,e)}}function Ms(t,e){let r="";return t.unit!==e.unit&&(r+=`\t- Unit '${t.unit}' does not match '${e.unit}'\n`),t.type!==e.type&&(r+=`\t- Type '${t.type}' does not match '${e.type}'\n`),t.valueType!==e.valueType&&(r+=`\t- Value Type '${t.valueType}' does not match '${e.valueType}'\n`),t.description!==e.description&&(r+=`\t- Description '${t.description}' does not match '${e.description}'\n`),r}function Ps(t,e){return t.valueType!==e.valueType?function(t,e){return`\t- use valueType '${t.valueType}' on instrument creation or use an instrument name other than '${e.name}'`}(t,e):t.unit!==e.unit?function(t,e){return`\t- use unit '${t.unit}' on instrument creation or use an instrument name other than '${e.name}'`}(t,e):t.type!==e.type?function(t,e){const r={name:e.name,type:e.type,unit:e.unit},n=JSON.stringify(r);return`\t- create a new view with a name other than '${t.name}' and InstrumentSelector '${n}'`}(t,e):t.description!==e.description?function(t,e){const r={name:e.name,type:e.type,unit:e.unit},n=JSON.stringify(r);return`\t- create a new view with a name other than '${t.name}' and InstrumentSelector '${n}'\n    \t- OR - create a new view with the name ${t.name} and description '${t.description}' and InstrumentSelector ${n}\n    \t- OR - create a new view with the name ${e.name} and description '${t.description}' and InstrumentSelector ${n}`}(t,e):""}class Rs{_sharedRegistry=new Map;_perCollectorRegistry=new Map;static create(){return new Rs}getStorages(t){let e=[];for(const t of this._sharedRegistry.values())e=e.concat(t);const r=this._perCollectorRegistry.get(t);if(null!=r)for(const t of r.values())e=e.concat(t);return e}register(t){this._registerStorage(t,this._sharedRegistry)}registerForCollector(t,e){let r=this._perCollectorRegistry.get(t);null==r&&(r=new Map,this._perCollectorRegistry.set(t,r)),this._registerStorage(e,r)}findOrUpdateCompatibleStorage(t){const e=this._sharedRegistry.get(t.name);return void 0===e?null:this._findOrUpdateCompatibleStorage(t,e)}findOrUpdateCompatibleCollectorStorage(t,e){const r=this._perCollectorRegistry.get(t);if(void 0===r)return null;const n=r.get(e.name);return void 0===n?null:this._findOrUpdateCompatibleStorage(e,n)}_registerStorage(t,e){const r=t.getInstrumentDescriptor(),n=e.get(r.name);void 0!==n?n.push(t):e.set(r.name,[t])}_findOrUpdateCompatibleStorage(t,e){let r=null;for(const a of e){const e=a.getInstrumentDescriptor();i=t,s=void 0,o=void 0,s=(n=e).name,o=i.name,s.toLowerCase()===o.toLowerCase()&&n.unit===i.unit&&n.type===i.type&&n.valueType===i.valueType?(e.description!==t.description&&(t.description.length>e.description.length&&a.updateDescription(t.description),f.warn("A view or instrument with the name ",t.name," has already been registered, but has a different description and is incompatible with another registered view.\n","Details:\n",Ms(e,t),"The longer description will be used.\nTo resolve the conflict:",Ps(e,t))),r=a):f.warn("A view or instrument with the name ",t.name," has already been registered and is incompatible with another registered view.\n","Details:\n",Ms(e,t),"To resolve the conflict:\n",Ps(e,t))}var n,i,s,o;return r}}class ks{_backingStorages;constructor(t){this._backingStorages=t}record(t,e,r,n){this._backingStorages.forEach((i=>{i.record(t,e,r,n)}))}}class Is{_instrumentName;_valueType;_buffer=new Cs;constructor(t,e){this._instrumentName=t,this._valueType=e}observe(t,e={}){"number"==typeof t?(this._valueType!==j.INT||Number.isInteger(t)||(f.warn(`INT value type cannot accept a floating-point value for ${this._instrumentName}, ignoring the fractional digits.`),t=Math.trunc(t),Number.isInteger(t)))&&this._buffer.set(e,t):f.warn(`non-number value provided to metric ${this._instrumentName}: ${t}`)}}class Ds{_buffer=new Map;observe(t,e,r={}){if(!Ss(t))return;let n=this._buffer.get(t);null==n&&(n=new Cs,this._buffer.set(t,n)),"number"==typeof e?(t._descriptor.valueType!==j.INT||Number.isInteger(e)||(f.warn(`INT value type cannot accept a floating-point value for ${t._descriptor.name}, ignoring the fractional digits.`),e=Math.trunc(e),Number.isInteger(e)))&&n.set(r,e):f.warn(`non-number value provided to metric ${t._descriptor.name}: ${e}`)}}class Us{_callbacks=[];_batchCallbacks=[];addCallback(t,e){this._findCallback(t,e)>=0||this._callbacks.push({callback:t,instrument:e})}removeCallback(t,e){const r=this._findCallback(t,e);r<0||this._callbacks.splice(r,1)}addBatchCallback(t,e){const r=new Set(e.filter(Ss));0!==r.size?this._findBatchCallback(t,r)>=0||this._batchCallbacks.push({callback:t,instruments:r}):f.error("BatchObservableCallback is not associated with valid instruments",e)}removeBatchCallback(t,e){const r=new Set(e.filter(Ss)),n=this._findBatchCallback(t,r);n<0||this._batchCallbacks.splice(n,1)}async observe(t,e){const r=this._observeCallbacks(t,e),n=this._observeBatchCallbacks(t,e),i=await async function(t){return Promise.all(t.map((async t=>{try{return{status:"fulfilled",value:await t}}catch(t){return{status:"rejected",reason:t}}})))}([...r,...n]);return i.filter(Ei).map((t=>t.reason))}_observeCallbacks(t,e){return this._callbacks.map((async({callback:r,instrument:n})=>{const i=new Is(n._descriptor.name,n._descriptor.valueType);let s=Promise.resolve(r(i));null!=e&&(s=Si(s,e)),await s,n._metricStorages.forEach((e=>{e.record(i._buffer,t)}))}))}_observeBatchCallbacks(t,e){return this._batchCallbacks.map((async({callback:r,instruments:n})=>{const i=new Ds;let s=Promise.resolve(r(i));null!=e&&(s=Si(s,e)),await s,n.forEach((e=>{const r=i._buffer.get(e);null!=r&&e._metricStorages.forEach((e=>{e.record(r,t)}))}))}))}_findCallback(t,e){return this._callbacks.findIndex((r=>r.callback===t&&r.instrument===e))}_findBatchCallback(t,e){return this._batchCallbacks.findIndex((r=>r.callback===t&&function(t,e){if(t.size!==e.size)return!1;for(const r of t)if(!e.has(r))return!1;return!0}(r.instruments,e)))}}class Bs extends As{_attributesProcessor;_aggregationCardinalityLimit;_deltaMetricStorage;_temporalMetricStorage;constructor(t,e,r,n,i){super(t),this._attributesProcessor=r,this._aggregationCardinalityLimit=i,this._deltaMetricStorage=new Os(e,this._aggregationCardinalityLimit),this._temporalMetricStorage=new Ls(e,n)}record(t,e,r,n){e=this._attributesProcessor.process(e,r),this._deltaMetricStorage.record(t,e,r,n)}collect(t,e){const r=this._deltaMetricStorage.collect();return this._temporalMetricStorage.buildMetrics(t,this._instrumentDescriptor,r,e)}}class Fs{_processors;constructor(t){this._processors=t}process(t,e){let r=t;for(const t of this._processors)r=t.process(r,e);return r}}function $s(){return js}const js=new class{process(t,e){return t}};class Vs{_meterProviderSharedState;_instrumentationScope;metricStorageRegistry=new Rs;observableRegistry=new Us;meter;constructor(t,e){this._meterProviderSharedState=t,this._instrumentationScope=e,this.meter=new Es(this)}registerMetricStorage(t){const e=this._registerMetricStorage(t,Bs);return 1===e.length?e[0]:new ks(e)}registerAsyncMetricStorage(t){return this._registerMetricStorage(t,Ns)}async collect(t,e,r){const n=await this.observableRegistry.observe(e,r?.timeoutMillis),i=this.metricStorageRegistry.getStorages(t);if(0===i.length)return null;const s=i.map((r=>r.collect(t,e))).filter(wi);return 0===s.length?{errors:n}:{scopeMetrics:{scope:this._instrumentationScope,metrics:s},errors:n}}_registerMetricStorage(t,e){let r=this._meterProviderSharedState.viewRegistry.findViews(t,this._instrumentationScope).map((r=>{const n=function(t,e){return{name:t.name??e.name,description:t.description??e.description,type:e.type,unit:e.unit,valueType:e.valueType,advice:e.advice}}(r,t),i=this.metricStorageRegistry.findOrUpdateCompatibleStorage(n);if(null!=i)return i;const s=r.aggregation.createAggregator(n),o=new e(n,s,r.attributesProcessor,this._meterProviderSharedState.metricCollectors,r.aggregationCardinalityLimit);return this.metricStorageRegistry.register(o),o}));if(0===r.length){const n=this._meterProviderSharedState.selectAggregations(t.type).map((([r,n])=>{const i=this.metricStorageRegistry.findOrUpdateCompatibleCollectorStorage(r,t);if(null!=i)return i;const s=n.createAggregator(t),o=r.selectCardinalityLimit(t.type),a=new e(t,s,$s(),[r],o);return this.metricStorageRegistry.registerForCollector(r,a),a}));r=r.concat(n)}return r}}class Gs{resource;viewRegistry=new hs;metricCollectors=[];meterSharedStates=new Map;constructor(t){this.resource=t}getMeterSharedState(t){const e=function(t){return`${t.name}:${t.version??""}:${t.schemaUrl??""}`}(t);let r=this.meterSharedStates.get(e);return null==r&&(r=new Vs(this,t),this.meterSharedStates.set(e,r)),r}selectAggregations(t){const e=[];for(const r of this.metricCollectors)e.push([r,ss(r.selectAggregation(t))]);return e}}class Hs{_sharedState;_metricReader;constructor(t,e){this._sharedState=t,this._metricReader=e}async collect(t){const e=rr(Date.now()),r=[],n=[],i=Array.from(this._sharedState.meterSharedStates.values()).map((async i=>{const s=await i.collect(this,e,t);null!=s?.scopeMetrics&&r.push(s.scopeMetrics),null!=s?.errors&&n.push(...s.errors)}));return await Promise.all(i),{resourceMetrics:{resource:this._sharedState.resource,scopeMetrics:r},errors:n}}async forceFlush(t){await this._metricReader.forceFlush(t)}async shutdown(t){await this._metricReader.shutdown(t)}selectAggregationTemporality(t){return this._metricReader.selectAggregationTemporality(t)}selectAggregation(t){return this._metricReader.selectAggregation(t)}selectCardinalityLimit(t){return this._metricReader.selectCardinalityLimit?.(t)??2e3}}const zs=/[\^$\\.+?()[\]{}|]/g;class qs{_matchAll;_regexp;constructor(t){"*"===t?(this._matchAll=!0,this._regexp=/.*/):(this._matchAll=!1,this._regexp=new RegExp(qs.escapePattern(t)))}match(t){return!!this._matchAll||this._regexp.test(t)}static escapePattern(t){return`^${t.replace(zs,"\\$&").replace("*",".*")}$`}static hasWildcard(t){return t.includes("*")}}class Ws{_matchAll;_pattern;constructor(t){this._matchAll=void 0===t,this._pattern=t}match(t){return!!this._matchAll||t===this._pattern}}class Xs{_nameFilter;_type;_unitFilter;constructor(t){this._nameFilter=new qs(t?.name??"*"),this._type=t?.type,this._unitFilter=new Ws(t?.unit)}getType(){return this._type}getNameFilter(){return this._nameFilter}getUnitFilter(){return this._unitFilter}}class Ks{_nameFilter;_versionFilter;_schemaUrlFilter;constructor(t){this._nameFilter=new Ws(t?.name),this._versionFilter=new Ws(t?.version),this._schemaUrlFilter=new Ws(t?.schemaUrl)}getNameFilter(){return this._nameFilter}getVersionFilter(){return this._versionFilter}getSchemaUrlFilter(){return this._schemaUrlFilter}}class Ys{name;description;aggregation;attributesProcessor;instrumentSelector;meterSelector;aggregationCardinalityLimit;constructor(t){var e;!function(t){if(null==(e=t).instrumentName&&null==e.instrumentType&&null==e.instrumentUnit&&null==e.meterName&&null==e.meterVersion&&null==e.meterSchemaUrl)throw new Error("Cannot create view with no selector arguments supplied");var e;if(null!=t.name&&(null==t?.instrumentName||qs.hasWildcard(t.instrumentName)))throw new Error("Views with a specified name must be declared with an instrument selector that selects at most one instrument per meter.")}(t),null!=t.attributesProcessors?this.attributesProcessor=(e=t.attributesProcessors,new Fs(e)):this.attributesProcessor=$s(),this.name=t.name,this.description=t.description,this.aggregation=ss(t.aggregation??{type:is.DEFAULT}),this.instrumentSelector=new Xs({name:t.instrumentName,type:t.instrumentType,unit:t.instrumentUnit}),this.meterSelector=new Ks({name:t.meterName,version:t.meterVersion,schemaUrl:t.meterSchemaUrl}),this.aggregationCardinalityLimit=t.aggregationCardinalityLimit}}class Zs{_sharedState;_shutdown=!1;constructor(t){if(this._sharedState=new Gs(t?.resource??ue()),null!=t?.views&&t.views.length>0)for(const e of t.views)this._sharedState.viewRegistry.addView(new Ys(e));if(null!=t?.readers&&t.readers.length>0)for(const e of t.readers){const t=new Hs(this._sharedState,e);e.setMetricProducer(t),this._sharedState.metricCollectors.push(t)}}getMeter(t,e="",r={}){return this._shutdown?(f.warn("A shutdown MeterProvider cannot provide a Meter"),lt):this._sharedState.getMeterSharedState({name:t,version:e,schemaUrl:r.schemaUrl}).meter}async shutdown(t){this._shutdown?f.warn("shutdown may only be called once per MeterProvider"):(this._shutdown=!0,await Promise.all(this._sharedState.metricCollectors.map((e=>e.shutdown(t)))))}async forceFlush(t){this._shutdown?f.warn("invalid attempt to force flush after MeterProvider shutdown"):await Promise.all(this._sharedState.metricCollectors.map((e=>e.forceFlush(t))))}}class Qs{emit(t){}}const Js=new Qs,to=new class{getLogger(t,e,r){return new Qs}};class eo{constructor(t,e,r,n){this._provider=t,this.name=e,this.version=r,this.options=n}emit(t){this._getLogger().emit(t)}_getLogger(){if(this._delegate)return this._delegate;const t=this._provider.getDelegateLogger(this.name,this.version,this.options);return t?(this._delegate=t,this._delegate):Js}}class ro{getLogger(t,e,r){var n;return null!==(n=this.getDelegateLogger(t,e,r))&&void 0!==n?n:new eo(this,t,e,r)}getDelegate(){var t;return null!==(t=this._delegate)&&void 0!==t?t:to}setDelegate(t){this._delegate=t}getDelegateLogger(t,e,r){var n;return null===(n=this._delegate)||void 0===n?void 0:n.getLogger(t,e,r)}}const no="object"==typeof globalThis?globalThis:"object"==typeof self?self:"object"==typeof window?window:"object"==typeof r.g?r.g:{},io=Symbol.for("io.opentelemetry.js.api.logs"),so=no;class oo{constructor(){this._proxyLoggerProvider=new ro}static getInstance(){return this._instance||(this._instance=new oo),this._instance}setGlobalLoggerProvider(t){return so[io]?this.getLoggerProvider():(so[io]=(1,e=t,r=to,t=>1===t?e:r),this._proxyLoggerProvider.setDelegate(t),t);var e,r}getLoggerProvider(){var t,e;return null!==(e=null===(t=so[io])||void 0===t?void 0:t.call(so,1))&&void 0!==e?e:this._proxyLoggerProvider}getLogger(t,e,r){return this.getLoggerProvider().getLogger(t,e,r)}disable(){delete so[io],this._proxyLoggerProvider=new ro}}const ao=oo.getInstance();class co{hrTime;hrTimeObserved;spanContext;resource;instrumentationScope;attributes={};_severityText;_severityNumber;_body;_eventName;totalAttributesCount=0;_isReadonly=!1;_logRecordLimits;set severityText(t){this._isLogRecordReadonly()||(this._severityText=t)}get severityText(){return this._severityText}set severityNumber(t){this._isLogRecordReadonly()||(this._severityNumber=t)}get severityNumber(){return this._severityNumber}set body(t){this._isLogRecordReadonly()||(this._body=t)}get body(){return this._body}get eventName(){return this._eventName}set eventName(t){this._isLogRecordReadonly()||(this._eventName=t)}get droppedAttributesCount(){return this.totalAttributesCount-Object.keys(this.attributes).length}constructor(t,e,r){const{timestamp:n,observedTimestamp:i,eventName:s,severityNumber:o,severityText:a,body:c,attributes:u={},context:l}=r,h=Date.now();if(this.hrTime=sr(n??h),this.hrTimeObserved=sr(i??h),l){const t=K.getSpanContext(l);t&&F(t)&&(this.spanContext=t)}this.severityNumber=o,this.severityText=a,this.body=c,this.resource=t.resource,this.instrumentationScope=e,this._logRecordLimits=t.logRecordLimits,this._eventName=s,this.setAttributes(u)}setAttribute(t,e){return this._isLogRecordReadonly()||null===e?this:0===t.length?(f.warn(`Invalid attribute key: ${t}`),this):Ze(e)||"object"==typeof e&&!Array.isArray(e)&&Object.keys(e).length>0?(this.totalAttributesCount+=1,Object.keys(this.attributes).length>=this._logRecordLimits.attributeCountLimit&&!Object.prototype.hasOwnProperty.call(this.attributes,t)?(1===this.droppedAttributesCount&&f.warn("Dropping extra attributes."),this):(Ze(e)?this.attributes[t]=this._truncateToSize(e):this.attributes[t]=e,this)):(f.warn(`Invalid attribute value set for key: ${t}`),this)}setAttributes(t){for(const[e,r]of Object.entries(t))this.setAttribute(e,r);return this}setBody(t){return this.body=t,this}setEventName(t){return this.eventName=t,this}setSeverityNumber(t){return this.severityNumber=t,this}setSeverityText(t){return this.severityText=t,this}_makeReadonly(){this._isReadonly=!0}_truncateToSize(t){const e=this._logRecordLimits.attributeValueLengthLimit;return e<=0?(f.warn(`Attribute value limit must be positive, got ${e}`),t):"string"==typeof t?this._truncateToLimitUtil(t,e):Array.isArray(t)?t.map((t=>"string"==typeof t?this._truncateToLimitUtil(t,e):t)):t}_truncateToLimitUtil(t,e){return t.length<=e?t:t.substring(0,e)}_isLogRecordReadonly(){return this._isReadonly&&f.warn("Can not execute the operation on emitted log record"),this._isReadonly}}class uo{instrumentationScope;_sharedState;constructor(t,e){this.instrumentationScope=t,this._sharedState=e}emit(t){const e=t.context||Q.active(),r=new co(this._sharedState,this.instrumentationScope,{context:e,...t});this._sharedState.activeProcessor.onEmit(r,e),r._makeReadonly()}}class lo{forceFlush(){return Promise.resolve()}onEmit(t,e){}shutdown(){return Promise.resolve()}}class ho{processors;forceFlushTimeoutMillis;constructor(t,e){this.processors=t,this.forceFlushTimeoutMillis=e}async forceFlush(){const t=this.forceFlushTimeoutMillis;await Promise.all(this.processors.map((e=>function(t,e){let r;const n=new Promise((function(t,n){r=setTimeout((function(){n(new Gr("Operation timed out."))}),e)}));return Promise.race([t,n]).then((t=>(clearTimeout(r),t)),(t=>{throw clearTimeout(r),t}))}(e.forceFlush(),t))))}onEmit(t,e){this.processors.forEach((r=>r.onEmit(t,e)))}async shutdown(){await Promise.all(this.processors.map((t=>t.shutdown())))}}class po{resource;forceFlushTimeoutMillis;logRecordLimits;processors;loggers=new Map;activeProcessor;registeredLogRecordProcessors=[];constructor(t,e,r,n){this.resource=t,this.forceFlushTimeoutMillis=e,this.logRecordLimits=r,this.processors=n,n.length>0?(this.registeredLogRecordProcessors=n,this.activeProcessor=new ho(this.registeredLogRecordProcessors,this.forceFlushTimeoutMillis)):this.activeProcessor=new lo}}class mo{_shutdownOnce;_sharedState;constructor(t={}){const e=Fe({},{forceFlushTimeoutMillis:3e4,logRecordLimits:{attributeValueLengthLimit:1/0,attributeCountLimit:128},includeTraceContext:!0},t),r=t.resource??ue();var n;this._sharedState=new po(r,e.forceFlushTimeoutMillis,{attributeCountLimit:(n=e.logRecordLimits).attributeCountLimit??void 0??void 0??128,attributeValueLengthLimit:n.attributeValueLengthLimit??void 0??void 0??1/0},t?.processors??[]),this._shutdownOnce=new de(this._shutdown,this)}getLogger(t,e,r){if(this._shutdownOnce.isCalled)return f.warn("A shutdown LoggerProvider cannot provide a Logger"),Js;t||f.warn("Logger requested without instrumentation scope name.");const n=t||"unknown",i=`${n}@${e||""}:${r?.schemaUrl||""}`;return this._sharedState.loggers.has(i)||this._sharedState.loggers.set(i,new uo({name:n,version:e,schemaUrl:r?.schemaUrl},this._sharedState)),this._sharedState.loggers.get(i)}forceFlush(){return this._shutdownOnce.isCalled?(f.warn("invalid attempt to force flush after LoggerProvider shutdown"),this._shutdownOnce.promise):this._sharedState.activeProcessor.forceFlush()}shutdown(){return this._shutdownOnce.isCalled?(f.warn("shutdown may only be called once per LoggerProvider"),this._shutdownOnce.promise):this._shutdownOnce.call()}_shutdown(){return this._sharedState.activeProcessor.shutdown()}}class go{export(t,e){this._sendLogRecords(t,e)}shutdown(){return Promise.resolve()}_exportInfo(t){return{resource:{attributes:t.resource.attributes},instrumentationScope:t.instrumentationScope,timestamp:or(t.hrTime),traceId:t.spanContext?.traceId,spanId:t.spanContext?.spanId,traceFlags:t.spanContext?.traceFlags,severityText:t.severityText,severityNumber:t.severityNumber,body:t.body,attributes:t.attributes}}_sendLogRecords(t,e){for(const e of t)console.dir(this._exportInfo(e),{depth:3});e?.({code:fe.SUCCESS})}}class fo{_exporter;_shutdownOnce;_unresolvedExports;constructor(t){this._exporter=t,this._shutdownOnce=new de(this._shutdown,this),this._unresolvedExports=new Set}onEmit(t){if(this._shutdownOnce.isCalled)return;const e=()=>Vr(this._exporter,[t]).then((t=>{t.code!==fe.SUCCESS&&_e(t.error??new Error(`SimpleLogRecordProcessor: log record export failed (status ${t})`))})).catch(_e);if(t.resource.asyncAttributesPending){const r=t.resource.waitForAsyncAttributes?.().then((()=>(this._unresolvedExports.delete(r),e())),_e);null!=r&&this._unresolvedExports.add(r)}else e()}async forceFlush(){await Promise.all(Array.from(this._unresolvedExports))}shutdown(){return this._shutdownOnce.call()}_shutdown(){return this._exporter.shutdown()}}class _o{constructor(t={}){var e,r,n;if(this._resource=ue().merge(null!==(e=t.resource)&&void 0!==e?e:ae({})),this._resourceDetectors=null!==(r=t.resourceDetectors)&&void 0!==r?r:[jr],this._serviceName=t.serviceName,this._serviceVersion=t.serviceVersion,this._autoDetectResources=null===(n=t.autoDetectResources)||void 0===n||n,t.spanProcessor||t.traceExporter||t.spanProcessors){const e={};t.sampler&&(e.sampler=t.sampler),t.spanLimits&&(e.spanLimits=t.spanLimits),t.idGenerator&&(e.idGenerator=t.idGenerator);const r=t.spanProcessors||[];t.traceExporter&&r.push(new be(t.traceExporter)),this._tracerProviderConfig={tracerConfig:e,spanProcessor:t.spanProcessor,spanProcessors:r,contextManager:t.contextManager,textMapPropagator:t.textMapPropagator}}t.metricExporters&&(this._meterProviderConfig={metricExporters:t.metricExporters}),t.logExporters&&(this._loggerProviderConfig={logExporters:t.logExporters});let i=[];t.instrumentations&&(i=t.instrumentations),this._instrumentations=i}start(){var t,e,r,n,i;if(this._disabled)return;if(function(t){const e=t.tracerProvider||K.getTracerProvider(),r=t.meterProvider||wt.getMeterProvider(),n=t.loggerProvider||Wt.getLoggerProvider();!function(t,e,r,n){for(let i=0,s=t.length;i<s;i++){const s=t[i];e&&s.setTracerProvider(e),r&&s.setMeterProvider(r),n&&s.setLoggerProvider&&s.setLoggerProvider(n),s.getConfig().enabled||s.enable()}}(t.instrumentations?.flat()??[],e,r,n)}({instrumentations:this._instrumentations}),this._autoDetectResources){const t={detectors:this._resourceDetectors};this._resource=this._resource.merge(((t={})=>{const e=(t.detectors||[]).map((e=>{try{const n=(r=e.detect(t),new oe(r));return f.debug(`${e.constructor.name} found resource.`,n),n}catch(t){return f.debug(`${e.constructor.name} failed: ${t.message}`),ce()}var r}));return e.reduce(((t,e)=>t.merge(e)),ce())})(t))}this._resource=void 0===this._serviceName?this._resource:this._resource.merge(ae({[Zt]:this._serviceName})),void 0!==this._serviceVersion&&(this._resource=this._resource.merge(ae({[Qt]:this._serviceVersion})));const s=[];(null===(t=this._tracerProviderConfig)||void 0===t?void 0:t.spanProcessor)&&s.push(this._tracerProviderConfig.spanProcessor),(null===(e=this._tracerProviderConfig)||void 0===e?void 0:e.spanProcessors)&&s.push(...this._tracerProviderConfig.spanProcessors);const o=new kr(Object.assign(Object.assign({},null===(r=this._tracerProviderConfig)||void 0===r?void 0:r.tracerConfig),{resource:this._resource,spanProcessors:s}));if(this._tracerProvider=o,o.register({contextManager:null===(n=this._tracerProviderConfig)||void 0===n?void 0:n.contextManager,propagator:null===(i=this._tracerProviderConfig)||void 0===i?void 0:i.textMapPropagator}),this._meterProviderConfig){const t=this._meterProviderConfig.metricExporters.map((t=>new us({exporter:t})));this._meterProvider=new Zs({resource:this._resource,readers:t}),wt.setGlobalMeterProvider(this._meterProvider)}if(this._loggerProviderConfig){const t=this._loggerProviderConfig.logExporters.map((t=>new fo(t)));this._loggerProvider=new mo({resource:this._resource,processors:t}),ao.setGlobalLoggerProvider(this._loggerProvider)}}getResourceAttributes(){return this._resource.attributes}forceFlush(){const t=[];return this._tracerProvider&&t.push(this._tracerProvider.forceFlush()),this._meterProvider&&t.push(this._meterProvider.forceFlush()),this._loggerProvider&&t.push(this._loggerProvider.forceFlush()),Promise.all(t).then((()=>{}))}shutdown(){const t=[];return this._tracerProvider&&t.push(this._tracerProvider.shutdown()),this._meterProvider&&t.push(this._meterProvider.shutdown()),this._loggerProvider&&t.push(this._loggerProvider.shutdown()),Promise.all(t).then((()=>{}))}}const vo="https://api.honeycomb.io",bo="v1/traces",wo=`${vo}/${bo}`,yo="v1/metrics",To=`${vo}/${yo}`,So="v1/logs",Eo=`${vo}/${So}`,Ao={apiKey:"",tracesApiKey:"",endpoint:wo,tracesEndpoint:wo,serviceName:"unknown_service",debug:!1,sampleRate:1,skipOptionsValidation:!1,localVisualizations:!1,webVitalsInstrumentationConfig:{enabled:!0}},xo=t=>`@honeycombio/opentelemetry-web: ${t}`,Co=/^[a-f0-9]*$/,Oo=/^hc[a-z]ic_[a-z0-9]*$/;function Lo(t){return null!=t&&0!==t.length&&(32===t.length?Co.test(t):64===t.length&&Oo.test(t))}function No(t,e){return t.endsWith(e)||t.endsWith(`${e}/`)?t:t.endsWith("/")?t+e:t+"/"+e}const Mo=t=>(null==t?void 0:t.tracesEndpoint)?t.tracesEndpoint:(null==t?void 0:t.endpoint)?No(t.endpoint,bo):wo,Po=t=>(null==t?void 0:t.metricsEndpoint)?t.metricsEndpoint:(null==t?void 0:t.endpoint)?No(t.endpoint,yo):To,Ro=t=>(null==t?void 0:t.logsEndpoint)?t.logsEndpoint:(null==t?void 0:t.endpoint)?No(t.endpoint,So):Eo,ko=t=>(null==t?void 0:t.tracesApiKey)||(null==t?void 0:t.apiKey),Io=t=>"number"==typeof(null==t?void 0:t.sampleRate)&&Number.isSafeInteger(null==t?void 0:t.sampleRate)&&(null==t?void 0:t.sampleRate)>=0?null==t?void 0:t.sampleRate:1,Do=xo("❌ Missing API Key. Set `apiKey` in HoneycombOptions. Telemetry will not be exported."),Uo=xo(`❌ Missing Service Name. Set \`serviceName\` in HoneycombOptions. Defaulting to '${Ao.serviceName}'`),Bo=xo("🔕 Dataset is ignored in favor of service name."),Fo=xo("❌ Missing dataset. Specify either HONEYCOMB_DATASET environment variable or dataset in the options parameter."),$o=xo("⏭️ Skipping options validation. To re-enable, set skipOptionsValidation option or HONEYCOMB_SKIP_OPTIONS_VALIDATION to false."),jo=xo("⏭️ Skipping options validation, because a custom collector is being used."),Vo=xo("🔨 Default deterministic sampler has been overridden. Honeycomb requires a resource attribute called SampleRate to properly show weighted values. Non-deterministic sampleRate could lead to missing spans in Honeycomb. See our docs for more details. https://docs.honeycomb.io/getting-data-in/opentelemetry/node-distro/#sampling-without-the-honeycomb-sdk"),Go=xo("🔕 Disabling local visualizations - must have both service name and API key configured."),Ho=xo("🔕 Disabling local visualizations - cannot infer auth and ui url roots from endpoint url."),zo=xo("🔕 Failed to get proper auth response from Honeycomb. No local visualization available."),qo=xo("🔕 Default honeycomb exporter disabled but no exporters provided");const Wo=t=>{if(null==t?void 0:t.sampler)return t.sampler;const e=Io(t);return new Xo(e)};class Xo{constructor(t){switch(this._sampleRate=t,t){case 0:this._sampler=new ye;break;case 1:this._sampler=new Te;break;default:{const e=1/t;this._sampler=new Se(e);break}}}shouldSample(t,e,r,n,i,s){const o=this._sampler.shouldSample(t,e,r,n,i,s);return Object.assign(Object.assign({},o),{attributes:Object.assign(Object.assign({},o.attributes),{SampleRate:this._sampleRate})})}toString(){return`DeterministicSampler(${this._sampler.toString()})`}}class Ko{t;o=0;i=[];u(t){if(t.hadRecentInput)return;const e=this.i[0],r=this.i.at(-1);this.o&&e&&r&&t.startTime-r.startTime<1e3&&t.startTime-e.startTime<5e3?(this.o+=t.value,this.i.push(t)):(this.o=t.value,this.i=[t]),this.t?.(t)}}const Yo=()=>{const t=performance.getEntriesByType("navigation")[0];if(t&&t.responseStart>0&&t.responseStart<performance.now())return t},Zo=t=>{if("loading"===document.readyState)return"loading";{const e=Yo();if(e){if(t<e.domInteractive)return"loading";if(0===e.domContentLoadedEventStart||t<e.domContentLoadedEventStart)return"dom-interactive";if(0===e.domComplete||t<e.domComplete)return"dom-content-loaded"}}return"complete"},Qo=t=>{const e=t.nodeName;return 1===t.nodeType?e.toLowerCase():e.toUpperCase().replace(/^#/,"")},Jo=t=>{let e="";try{for(;9!==t?.nodeType;){const r=t,n=r.id?"#"+r.id:[Qo(r),...Array.from(r.classList).sort()].join(".");if(e.length+n.length>99)return e||n;if(e=e?n+">"+e:n,r.id)break;t=r.parentNode}}catch{}return e},ta=new WeakMap;function ea(t,e){return ta.get(t)||ta.set(t,new e),ta.get(t)}let ra=-1;const na=()=>ra,ia=t=>{addEventListener("pageshow",(e=>{e.persisted&&(ra=e.timeStamp,t(e))}),!0)},sa=(t,e,r,n)=>{let i,s;return o=>{e.value>=0&&(o||n)&&(s=e.value-(i??0),(s||void 0===i)&&(i=e.value,e.delta=s,e.rating=((t,e)=>t>e[1]?"poor":t>e[0]?"needs-improvement":"good")(e.value,r),t(e)))}},oa=t=>{requestAnimationFrame((()=>requestAnimationFrame((()=>t()))))},aa=()=>{const t=Yo();return t?.activationStart??0},ca=(t,e=-1)=>{const r=Yo();let n="navigate";return na()>=0?n="back-forward-cache":r&&(document.prerendering||aa()>0?n="prerender":document.wasDiscarded?n="restore":r.type&&(n=r.type.replace(/_/g,"-"))),{name:t,value:e,rating:"good",delta:0,entries:[],id:`v5-${Date.now()}-${Math.floor(8999999999999*Math.random())+1e12}`,navigationType:n}},ua=(t,e,r={})=>{try{if(PerformanceObserver.supportedEntryTypes.includes(t)){const n=new PerformanceObserver((t=>{Promise.resolve().then((()=>{e(t.getEntries())}))}));return n.observe({type:t,buffered:!0,...r}),n}}catch{}},la=t=>{let e=!1;return()=>{e||(t(),e=!0)}};let ha=-1;const da=()=>"hidden"!==document.visibilityState||document.prerendering?1/0:0,pa=t=>{"hidden"===document.visibilityState&&ha>-1&&(ha="visibilitychange"===t.type?t.timeStamp:0,ga())},ma=()=>{addEventListener("visibilitychange",pa,!0),addEventListener("prerenderingchange",pa,!0)},ga=()=>{removeEventListener("visibilitychange",pa,!0),removeEventListener("prerenderingchange",pa,!0)},fa=()=>{if(ha<0){const t=aa(),e=document.prerendering?void 0:globalThis.performance.getEntriesByType("visibility-state").filter((e=>"hidden"===e.name&&e.startTime>t))[0]?.startTime;ha=e??da(),ma(),ia((()=>{setTimeout((()=>{ha=da(),ma()}))}))}return{get firstHiddenTime(){return ha}}},_a=t=>{document.prerendering?addEventListener("prerenderingchange",(()=>t()),!0):t()},va=[1800,3e3],ba=(t,e={})=>{_a((()=>{const r=fa();let n,i=ca("FCP");const s=ua("paint",(t=>{for(const e of t)"first-contentful-paint"===e.name&&(s.disconnect(),e.startTime<r.firstHiddenTime&&(i.value=Math.max(e.startTime-aa(),0),i.entries.push(e),n(!0)))}));s&&(n=sa(t,i,va,e.reportAllChanges),ia((r=>{i=ca("FCP"),n=sa(t,i,va,e.reportAllChanges),oa((()=>{i.value=performance.now()-r.timeStamp,n(!0)}))})))}))},wa=[.1,.25],ya=t=>t.find((t=>1===t.node?.nodeType))||t[0];let Ta=0,Sa=1/0,Ea=0;const Aa=t=>{for(const e of t)e.interactionId&&(Sa=Math.min(Sa,e.interactionId),Ea=Math.max(Ea,e.interactionId),Ta=Ea?(Ea-Sa)/7+1:0)};let xa;const Ca=()=>xa?Ta:performance.interactionCount??0;let Oa=0;class La{l=[];h=new Map;m;p;v(){Oa=Ca(),this.l.length=0,this.h.clear()}M(){const t=Math.min(this.l.length-1,Math.floor((Ca()-Oa)/50));return this.l[t]}u(t){if(this.m?.(t),!t.interactionId&&"first-input"!==t.entryType)return;const e=this.l.at(-1);let r=this.h.get(t.interactionId);if(r||this.l.length<10||t.duration>e.T){if(r?t.duration>r.T?(r.entries=[t],r.T=t.duration):t.duration===r.T&&t.startTime===r.entries[0].startTime&&r.entries.push(t):(r={id:t.interactionId,entries:[t],T:t.duration},this.h.set(r.id,r),this.l.push(r)),this.l.sort(((t,e)=>e.T-t.T)),this.l.length>10){const t=this.l.splice(10);for(const e of t)this.h.delete(e.id)}this.p?.(r)}}}const Na=t=>{const e=globalThis.requestIdleCallback||setTimeout;"hidden"===document.visibilityState?t():(t=la(t),document.addEventListener("visibilitychange",t,{once:!0}),e((()=>{t(),document.removeEventListener("visibilitychange",t)})))},Ma=[200,500];class Pa{m;u(t){this.m?.(t)}}const Ra=[2500,4e3],ka=[800,1800],Ia=t=>{document.prerendering?_a((()=>Ia(t))):"complete"!==document.readyState?addEventListener("load",(()=>Ia(t)),!0):setTimeout(t)},Da="browser.name",Ua="browser.version",Ba="browser.touch_screen_enabled",Fa="browser.width",$a="browser.height",ja="device.type",Va="network.effectiveType",Ga="screen.width",Ha="screen.height",za="screen.size",qa="page.hash",Wa="page.url",Xa="page.route",Ka="page.hostname",Ya="page.search",Za="url.path",Qa="entry_page.url",Ja="entry_page.path",tc="entry_page.search",ec="entry_page.hash",rc="entry_page.hostname",nc="entry_page.referrer",ic="honeycomb.distro.version",sc="honeycomb.distro.runtime_version",oc="cls.id",ac="cls.value",cc="cls.delta",uc="cls.rating",lc="cls.navigation_type",hc="lcp.id",dc="lcp.value",pc="lcp.delta",mc="lcp.rating",gc="lcp.navigation_type",fc="inp.id",_c="inp.value",vc="inp.delta",bc="inp.rating",wc="inp.navigation_type",yc="fcp.id",Tc="fcp.value",Sc="fcp.delta",Ec="fcp.rating",Ac="fcp.navigation_type",xc="ttfb.id",Cc="ttfb.value",Oc="ttfb.delta",Lc="ttfb.rating",Nc="ttfb.navigation_type",Mc="cls.largest_shift_target",Pc="cls.element",Rc="cls.largest_shift_time",kc="cls.largest_shift_value",Ic="cls.load_state",Dc="cls.had_recent_input",Uc="lcp.element",Bc="lcp.url",Fc="lcp.time_to_first_byte",$c="lcp.resource_load_delay",jc="lcp.resource_load_duration",Vc="lcp.element_render_delay",Gc="lcp.resource_load_time",Hc="inp.input_delay",zc="inp.interaction_target",qc="inp.interaction_time",Wc="inp.interaction_type",Xc="inp.load_state",Kc="inp.next_paint_time",Yc="inp.presentation_delay",Zc="inp.processing_duration",Qc="inp.duration",Jc="inp.element",tu="inp.event_type",eu="inp.timing.script.entry_type",ru="inp.timing.script.start_time",nu="inp.timing.script.execution_start",iu="inp.timing.script.duration",su="inp.timing.script.forced_style_and_layout_duration",ou="inp.timing.script.invoker",au="inp.timing.script.pause_duration",cu="inp.timing.script.source_url",uu="inp.timing.script.source_function_name",lu="inp.timing.script.source_char_position",hu="inp.timing.script.window_attribution",du="inp.timing.duration",pu="inp.timing.entryType",mu="inp.timing.name",gu="inp.timing.renderStart",fu="inp.timing.startTime",_u="fcp.time_to_first_byte",vu="fcp.time_since_first_byte",bu="fcp.load_state",wu="ttfb.waiting_duration",yu="ttfb.dns_duration",Tu="ttfb.connection_duration",Su="ttfb.request_duration",Eu="ttfb.cache_duration",Au="ttfb.waiting_time",xu="ttfb.dns_time",Cu="ttfb.connection_time",Ou="ttfb.request_time";class Lu{constructor(t,e,r={}){this.instrumentationName=t,this.instrumentationVersion=e,this._wrap=cn.wrap,this._unwrap=cn.unwrap,this._massWrap=cn.massWrap,this._massUnwrap=cn.massUnwrap,this._config=Object.assign({enabled:!0},r),this._diag=f.createComponentLogger({namespace:t}),this._tracer=K.getTracer(t,e),this._meter=wt.getMeter(t,e),this._updateMetricInstruments()}get meter(){return this._meter}setMeterProvider(t){this._meter=t.getMeter(this.instrumentationName,this.instrumentationVersion),this._updateMetricInstruments()}_updateMetricInstruments(){}getConfig(){return this._config}setConfig(t={}){this._config=Object.assign({},t)}setTracerProvider(t){this._tracer=t.getTracer(this.instrumentationName,this.instrumentationVersion)}get tracer(){return this._tracer}}class Nu extends Lu{constructor({enabled:t=!0,vitalsToTrack:e=["CLS","LCP","INP","TTFB","FCP"],lcp:r,cls:n,inp:i,fcp:s,ttfb:o}={}){super("@honeycombio/instrumentation-web-vitals",tn,{enabled:t,vitalsToTrack:e,lcp:r,cls:n,inp:i,fcp:s,ttfb:o}),this.onReportCLS=(t,e={})=>{const{applyCustomAttributes:r}=e;if(!this.isEnabled())return;const{name:n,attribution:i}=t,{largestShiftTarget:s,largestShiftTime:o,largestShiftValue:a,loadState:c,largestShiftEntry:u}=i,l=this.tracer.startSpan(n);l.setAttributes({[oc]:t.id,[cc]:t.delta,[ac]:t.value,[uc]:t.rating,[lc]:t.navigationType,[Mc]:s,[Pc]:s,[Rc]:o,[kc]:a,[Ic]:c,[Dc]:null==u?void 0:u.hadRecentInput}),r&&r(t,l),l.end()},this.onReportLCP=(t,e={})=>{const{applyCustomAttributes:r,dataAttributes:n}=e;if(!this.isEnabled())return;const{name:i,attribution:s}=t,{target:o,url:a,timeToFirstByte:c,resourceLoadDelay:u,resourceLoadDuration:l,elementRenderDelay:h,lcpEntry:d}=s,p=this.tracer.startSpan(i);p.setAttributes({[hc]:t.id,[pc]:t.delta,[dc]:t.value,[mc]:t.rating,[gc]:t.navigationType,[Uc]:o,[Bc]:a,[Fc]:c,[$c]:u,[jc]:l,[Vc]:h,[Gc]:l}),this.addDataAttributes(null==d?void 0:d.element,p,n,"lcp"),r&&r(t,p),p.end()},this.onReportINP=(t,e={includeTimingsAsSpans:!1})=>{const{applyCustomAttributes:r,includeTimingsAsSpans:n,dataAttributes:i}=e;if(!this.isEnabled())return;const{name:s,attribution:o}=t,{inputDelay:a,interactionTarget:c,interactionTime:u,interactionType:l,loadState:h,nextPaintTime:d,presentationDelay:p,processingDuration:m,longAnimationFrameEntries:g}=o,f=a+m+p;this.tracer.startActiveSpan(s,{startTime:u},(e=>{const s={[fc]:t.id,[vc]:t.delta,[_c]:t.value,[bc]:t.rating,[wc]:t.navigationType,[Hc]:a,[zc]:c,[qc]:u,[Wc]:l,[Xc]:h,[Kc]:d,[Yc]:p,[Zc]:m,[Qc]:f,[Jc]:c,[tu]:l};e.setAttributes(s),t.entries.forEach((t=>{this.addDataAttributes(this.getElementFromNode(t.target),e,i,"inp")})),r&&r(t,e),n&&g.forEach((t=>{this.processPerformanceLongAnimationFrameTimingSpans("inp",t)})),e.end(u+f)}))},this.onReportFCP=(t,e={})=>{const{applyCustomAttributes:r}=e;if(!this.isEnabled())return;const{name:n,attribution:i}=t,{timeToFirstByte:s,firstByteToFCP:o,loadState:a}=i,c=this.tracer.startSpan(n);c.setAttributes({[yc]:t.id,[Sc]:t.delta,[Tc]:t.value,[Ec]:t.rating,[Ac]:t.navigationType,[_u]:s,[vu]:o,[bu]:a}),r&&r(t,c),c.end()},this.onReportTTFB=(t,e={})=>{const{applyCustomAttributes:r}=e;if(!this.isEnabled())return;const{name:n,attribution:i}=t,{cacheDuration:s,connectionDuration:o,dnsDuration:a,requestDuration:c,waitingDuration:u}=i,l={[xc]:t.id,[Oc]:t.delta,[Cc]:t.value,[Lc]:t.rating,[Nc]:t.navigationType,[wu]:u,[yu]:a,[Tu]:o,[Su]:c,[Eu]:s,[Au]:u,[xu]:a,[Cu]:o,[Ou]:c},h=this.tracer.startSpan(n);h.setAttributes(l),r&&r(t,h),h.end()},this.vitalsToTrack=[...e],this.lcpOpts=r,this.clsOpts=n,this.inpOpts=i,this.fcpOpts=s,this.ttfbOpts=o,this._isEnabled=t,this._setupWebVitalsCallbacks()}init(){}_setupWebVitalsCallbacks(){this.vitalsToTrack.includes("CLS")&&((t,e={})=>{const r=ea(e=Object.assign({},e),Ko),n=new WeakMap;r.t=t=>{if(t?.sources?.length){const r=ya(t.sources);if(r){const t=(e.generateTarget??Jo)(r.node);n.set(r,t)}}},((t,e={})=>{ba(la((()=>{let r,n=ca("CLS",0);const i=ea(e,Ko),s=t=>{for(const e of t)i.u(e);i.o>n.value&&(n.value=i.o,n.entries=i.i,r())},o=ua("layout-shift",s);o&&(r=sa(t,n,wa,e.reportAllChanges),document.addEventListener("visibilitychange",(()=>{"hidden"===document.visibilityState&&(s(o.takeRecords()),r(!0))})),ia((()=>{i.o=0,n=ca("CLS",0),r=sa(t,n,wa,e.reportAllChanges),oa((()=>r()))})),setTimeout(r))})))})((e=>{const r=(t=>{let e={};if(t.entries.length){const r=t.entries.reduce(((t,e)=>t.value>e.value?t:e));if(r?.sources?.length){const t=ya(r.sources);t&&(e={largestShiftTarget:n.get(t),largestShiftTime:r.startTime,largestShiftValue:r.value,largestShiftSource:t,largestShiftEntry:r,loadState:Zo(r.startTime)})}}return Object.assign(t,{attribution:e})})(e);t(r)}),e)})((t=>{this.onReportCLS(t,this.clsOpts)}),this.clsOpts),this.vitalsToTrack.includes("LCP")&&((t,e={})=>{const r=ea(e=Object.assign({},e),Pa),n=new WeakMap;r.m=t=>{if(t.element){const r=(e.generateTarget??Jo)(t.element);n.set(t,r)}},((t,e={})=>{_a((()=>{const r=fa();let n,i=ca("LCP");const s=ea(e,Pa),o=t=>{e.reportAllChanges||(t=t.slice(-1));for(const e of t)s.u(e),e.startTime<r.firstHiddenTime&&(i.value=Math.max(e.startTime-aa(),0),i.entries=[e],n())},a=ua("largest-contentful-paint",o);if(a){n=sa(t,i,Ra,e.reportAllChanges);const r=la((()=>{o(a.takeRecords()),a.disconnect(),n(!0)}));for(const t of["keydown","click","visibilitychange"])addEventListener(t,(()=>Na(r)),{capture:!0,once:!0});ia((r=>{i=ca("LCP"),n=sa(t,i,Ra,e.reportAllChanges),oa((()=>{i.value=performance.now()-r.timeStamp,n(!0)}))}))}}))})((e=>{const r=(t=>{let e={timeToFirstByte:0,resourceLoadDelay:0,resourceLoadDuration:0,elementRenderDelay:t.value};if(t.entries.length){const r=Yo();if(r){const i=r.activationStart||0,s=t.entries.at(-1),o=s.url&&performance.getEntriesByType("resource").filter((t=>t.name===s.url))[0],a=Math.max(0,r.responseStart-i),c=Math.max(a,o?(o.requestStart||o.startTime)-i:0),u=Math.min(t.value,Math.max(c,o?o.responseEnd-i:0));e={target:n.get(s),timeToFirstByte:a,resourceLoadDelay:c-a,resourceLoadDuration:u-c,elementRenderDelay:t.value-u,navigationEntry:r,lcpEntry:s},s.url&&(e.url=s.url),o&&(e.lcpResourceEntry=o)}}return Object.assign(t,{attribution:e})})(e);t(r)}),e)})((t=>{this.onReportLCP(t,this.lcpOpts)}),this.lcpOpts),this.vitalsToTrack.includes("INP")&&((t,e={})=>{const r=ea(e=Object.assign({},e),La);let n=[],i=[],s=0;const o=new WeakMap,a=new WeakMap;let c=!1;const u=()=>{c||(Na(l),c=!0)},l=()=>{const t=r.l.map((t=>o.get(t.entries[0]))),e=i.length-50;i=i.filter(((r,n)=>n>=e||t.includes(r)));const a=new Set;for(const t of i){const e=h(t.startTime,t.processingEnd);for(const t of e)a.add(t)}const u=n.length-1-50;n=n.filter(((t,e)=>t.startTime>s&&e>u||a.has(t))),c=!1};r.m=t=>{const e=t.startTime+t.duration;let r;s=Math.max(s,t.processingEnd);for(let n=i.length-1;n>=0;n--){const s=i[n];if(Math.abs(e-s.renderTime)<=8){r=s,r.startTime=Math.min(t.startTime,r.startTime),r.processingStart=Math.min(t.processingStart,r.processingStart),r.processingEnd=Math.max(t.processingEnd,r.processingEnd),r.entries.push(t);break}}r||(r={startTime:t.startTime,processingStart:t.processingStart,processingEnd:t.processingEnd,renderTime:e,entries:[t]},i.push(r)),(t.interactionId||"first-input"===t.entryType)&&o.set(t,r),u()},r.p=t=>{if(!a.get(t)){const r=(e.generateTarget??Jo)(t.entries[0].target);a.set(t,r)}};const h=(t,e)=>{const r=[];for(const i of n)if(!(i.startTime+i.duration<t)){if(i.startTime>e)break;r.push(i)}return r},d=t=>{const e=t.entries[0],n=o.get(e),i=e.processingStart,s=Math.max(e.startTime+e.duration,i),c=Math.min(n.processingEnd,s),u=n.entries.sort(((t,e)=>t.processingStart-e.processingStart)),l=h(e.startTime,c),d=r.h.get(e.interactionId),p={interactionTarget:a.get(d),interactionType:e.name.startsWith("key")?"keyboard":"pointer",interactionTime:e.startTime,nextPaintTime:s,processedEventEntries:u,longAnimationFrameEntries:l,inputDelay:i-e.startTime,processingDuration:c-i,presentationDelay:s-c,loadState:Zo(e.startTime),longestScript:void 0,totalScriptDuration:void 0,totalStyleAndLayoutDuration:void 0,totalPaintDuration:void 0,totalUnattributedDuration:void 0};return(t=>{if(!t.longAnimationFrameEntries?.length)return;const e=t.interactionTime,r=t.inputDelay,n=t.processingDuration;let i,s,o=0,a=0,c=0,u=0;for(const c of t.longAnimationFrameEntries){a=a+c.startTime+c.duration-c.styleAndLayoutStart;for(const t of c.scripts){const c=t.startTime+t.duration;if(c<e)continue;const l=c-Math.max(e,t.startTime),h=t.duration?l/t.duration*t.forcedStyleAndLayoutDuration:0;o+=l-h,a+=h,l>u&&(s=t.startTime<e+r?"input-delay":t.startTime>=e+r+n?"presentation-delay":"processing-duration",i=t,u=l)}}const l=t.longAnimationFrameEntries.at(-1),h=l?l.startTime+l.duration:0;h>=e+r+n&&(c=t.nextPaintTime-h),i&&s&&(t.longestScript={entry:i,subpart:s,intersectingDuration:u}),t.totalScriptDuration=o,t.totalStyleAndLayoutDuration=a,t.totalPaintDuration=c,t.totalUnattributedDuration=t.nextPaintTime-e-o-a-c})(p),Object.assign(t,{attribution:p})};ua("long-animation-frame",(t=>{n=n.concat(t),u()})),((t,e={})=>{globalThis.PerformanceEventTiming&&"interactionId"in PerformanceEventTiming.prototype&&_a((()=>{"interactionCount"in performance||xa||(xa=ua("event",Aa,{type:"event",buffered:!0,durationThreshold:0}));let r,n=ca("INP");const i=ea(e,La),s=t=>{Na((()=>{for(const e of t)i.u(e);const e=i.M();e&&e.T!==n.value&&(n.value=e.T,n.entries=e.entries,r())}))},o=ua("event",s,{durationThreshold:e.durationThreshold??40});r=sa(t,n,Ma,e.reportAllChanges),o&&(o.observe({type:"first-input",buffered:!0}),document.addEventListener("visibilitychange",(()=>{"hidden"===document.visibilityState&&(s(o.takeRecords()),r(!0))})),ia((()=>{i.v(),n=ca("INP"),r=sa(t,n,Ma,e.reportAllChanges)})))}))})((e=>{const r=d(e);t(r)}),e)})((t=>{this.onReportINP(t,this.inpOpts)}),this.inpOpts),this.vitalsToTrack.includes("TTFB")&&((t,e={})=>{((t,e={})=>{let r=ca("TTFB"),n=sa(t,r,ka,e.reportAllChanges);Ia((()=>{const i=Yo();i&&(r.value=Math.max(i.responseStart-aa(),0),r.entries=[i],n(!0),ia((()=>{r=ca("TTFB",0),n=sa(t,r,ka,e.reportAllChanges),n(!0)})))}))})((e=>{const r=(t=>{let e={waitingDuration:0,cacheDuration:0,dnsDuration:0,connectionDuration:0,requestDuration:0};if(t.entries.length){const r=t.entries[0],n=r.activationStart||0,i=Math.max((r.workerStart||r.fetchStart)-n,0),s=Math.max(r.domainLookupStart-n,0),o=Math.max(r.connectStart-n,0),a=Math.max(r.connectEnd-n,0);e={waitingDuration:i,cacheDuration:s-i,dnsDuration:o-s,connectionDuration:a-o,requestDuration:t.value-a,navigationEntry:r}}return Object.assign(t,{attribution:e})})(e);t(r)}),e)})((t=>{this.onReportTTFB(t,this.ttfbOpts)}),this.ttfbOpts),this.vitalsToTrack.includes("FCP")&&((t,e={})=>{ba((e=>{const r=(t=>{let e={timeToFirstByte:0,firstByteToFCP:t.value,loadState:Zo(na())};if(t.entries.length){const r=Yo(),n=t.entries.at(-1);if(r){const i=r.activationStart||0,s=Math.max(0,r.responseStart-i);e={timeToFirstByte:s,firstByteToFCP:t.value-s,loadState:Zo(t.entries[0].startTime),navigationEntry:r,fcpEntry:n}}}return Object.assign(t,{attribution:e})})(e);t(r)}),e)})((t=>{this.onReportFCP(t,this.fcpOpts)}),this.fcpOpts)}getAttrPrefix(t){return t.toLowerCase()}getAttributesForPerformanceLongAnimationFrameTiming(t){return{[du]:t.duration,[pu]:t.entryType,[mu]:t.name,[gu]:t.renderStart,[fu]:t.startTime}}getAttributesForPerformanceScriptTiming(t){return{[eu]:t.entryType,[ru]:t.startTime,[nu]:t.executionStart,[iu]:t.duration,[su]:t.forcedStyleAndLayoutDuration,[ou]:t.invoker,[au]:t.pauseDuration,[cu]:t.sourceURL,[uu]:t.sourceFunctionName,[lu]:t.sourceCharPosition,[hu]:t.windowAttribution}}processPerformanceLongAnimationFrameTimingSpans(t,e){if(!e)return;const r=this.getAttributesForPerformanceLongAnimationFrameTiming(e);this.tracer.startActiveSpan(e.name,{startTime:e.startTime},(n=>{n.setAttributes(r),this.processPerformanceScriptTimingSpans(t,e.scripts),n.end(e.startTime+e.duration)}))}processPerformanceScriptTimingSpans(t,e){e&&(null==e?void 0:e.length)&&e.map((t=>{this.tracer.startActiveSpan(t.name,{startTime:t.startTime},(e=>{const r=this.getAttributesForPerformanceScriptTiming(t);e.setAttributes(r),e.end(t.startTime+t.duration)}))}))}getElementFromNode(t){if((null==t?void 0:t.nodeType)===Node.ELEMENT_NODE)return t}addDataAttributes(t,e,r,n){const i=t;if(null==i?void 0:i.dataset)for(const t in i.dataset){const s=i.dataset[t];void 0===s||void 0!==r&&!r.includes(t)||e.setAttribute(`${n}.element.data.${t}`,s)}}disable(){this.isEnabled()?(this._isEnabled=!1,this._diag.debug("Instrumentation  disabled")):this._diag.debug("Instrumentation already disabled")}enable(){this.isEnabled()?this._diag.debug("Instrumentation already enabled"):(this._isEnabled=!0,this._diag.debug("Instrumentation  enabled"),this._diag.debug(`Sending spans for ${this.vitalsToTrack.join(",")}`))}isEnabled(){return this._isEnabled}}const Mu="@honeycombio/instrumentation-global-errors";class Pu extends Lu{constructor({enabled:t=!0,applyCustomAttributesOnSpan:e}={}){super(Mu,tn,{enabled:t,applyCustomAttributesOnSpan:e}),this.onError=t=>{const e="reason"in t?t.reason:t.error;console.log(this.applyCustomAttributesOnSpan),e&&function(t,e={},r=K.getTracer(Mu),n){const i=t.message,s=t.name,o=Object.assign(Object.assign({[Yt]:s,[Xt]:i,[Kt]:t.stack},function(t){if(!t)return{};const e=(0,un.computeStackTrace)(t).stack,r=[],n=[],i=[],s=[];return Array.isArray(e)?(e.forEach((t=>{r.push(t.line),n.push(t.column),i.push(t.func),s.push(t.url)})),{"exception.structured_stacktrace.columns":n,"exception.structured_stacktrace.lines":r,"exception.structured_stacktrace.functions":i,"exception.structured_stacktrace.urls":s}):{}}(t)),e),a=r.startSpan("exception",{attributes:o},Q.active());n&&n(a,t),a.setStatus({code:Z.ERROR,message:i}),a.end()}(e,{},this.tracer,this.applyCustomAttributesOnSpan)},t&&this.enable(),this._isEnabled=t,this.applyCustomAttributesOnSpan=e}init(){}disable(){this.isEnabled()?(this._isEnabled=!1,window.removeEventListener("error",this.onError),window.removeEventListener("unhandledrejection",this.onError),this._diag.debug("Instrumentation  disabled")):this._diag.debug("Instrumentation already disabled")}enable(){this.isEnabled()?this._diag.debug("Instrumentation already enabled"):(this._isEnabled=!0,window.addEventListener("error",this.onError),window.addEventListener("unhandledrejection",this.onError),this._diag.debug("Instrumentation  enabled"))}isEnabled(){return this._isEnabled}}const Ru="x-honeycomb-team",ku="x-honeycomb-dataset";function Iu(t,e,r,n=!1){const i=Object.assign(Object.assign({},null==t?void 0:t.headers),r);return e&&!i[Ru]&&(i[Ru]=e),Lo(e)&&(n&&(null==t?void 0:t.metricsDataset)?i[ku]=null==t?void 0:t.metricsDataset:(null==t?void 0:t.dataset)&&(i[ku]=null==t?void 0:t.dataset)),i}class Du{constructor(t,e,r,n,i){this._traceUrl="",this._logLevel=d.DEBUG,r&&(this._logLevel=r),t&&e?n&&i?fetch(n,{headers:{"x-honeycomb-team":e}}).then((t=>{if(t.ok)return t.json();throw new Error})).then((r=>{var n,s,o;const a=r;if(!(null===(n=a.team)||void 0===n?void 0:n.slug))throw new Error;this._traceUrl=function(t,e,r,n,i){let s=`${i}/${r}`;return!Lo(t)&&n&&(s+=`/environments/${n}`),s+=`/datasets/${e}/trace?trace_id`,s}(e,t,null===(s=a.team)||void 0===s?void 0:s.slug,null===(o=a.environment)||void 0===o?void 0:o.slug,i)})).catch((()=>{this._logLevel>=d.INFO&&console.log(zo)})):this._logLevel>=d.DEBUG&&console.debug(Ho):this._logLevel>=d.DEBUG&&console.debug(Go)}export(t,e){this._traceUrl&&t.forEach((t=>{var e;!(null===(e=t.parentSpanContext)||void 0===e?void 0:e.spanId)&&this._logLevel>=d.INFO&&console.log(xo(`Honeycomb link: ${this._traceUrl}=${t.spanContext().traceId}`))})),e({code:fe.SUCCESS})}shutdown(){return Promise.resolve()}}function Uu(t){const e=[];return(null==t?void 0:t.localVisualizations)&&e.push(function(t){const e=ko(t),{authRoot:r,uiRoot:n}=((t="")=>{const e=new URL(t),r=/(api)([.|-])?(.*?)(\.?)(honeycomb\.io)(.*)/.exec(e.host);if(null===r)return{authRoot:void 0,uiRoot:void 0};let n,i;return"-"===r[2]?(n=`api-${r[3]}`,i=`ui-${r[3]}`):(n=r[3]?`api.${r[3]}`:"api",i=r[3]?`ui.${r[3]}`:"ui"),{authRoot:`${e.protocol}//${n}.honeycomb.io/1/auth`,uiRoot:`${e.protocol}//${i}.honeycomb.io`}})((null==t?void 0:t.tracesEndpoint)||Mo(t));return new Du(null==t?void 0:t.serviceName,e,null==t?void 0:t.logLevel,r,n)}(t)),(null==t?void 0:t.traceExporter)&&e.push(null==t?void 0:t.traceExporter),(null==t?void 0:t.traceExporters)&&e.push(...t.traceExporters),!0!==(null==t?void 0:t.disableDefaultTraceExporter)&&e.unshift(function(t){const e=ko(t);return new Zn({url:Mo(t),headers:Iu(t,e,null==t?void 0:t.tracesHeaders),timeoutMillis:(null==t?void 0:t.tracesTimeout)||(null==t?void 0:t.timeout)||1e4})}(t)),r=[...e],new $u(r);var r}function Bu(t){const e=[];return e.push(function(t){const e=(t=>(null==t?void 0:t.metricsApiKey)||(null==t?void 0:t.apiKey))(t);return new ui({url:Po(t),headers:Iu(t,e,null==t?void 0:t.metricsHeaders,!0),timeoutMillis:(null==t?void 0:t.metricsTimeout)||(null==t?void 0:t.timeout)||1e4})}(t)),(null==t?void 0:t.localVisualizations)&&e.push(new ls),e}function Fu(t){const e=[];return e.push(function(t){const e=(t=>(null==t?void 0:t.logsApiKey)||(null==t?void 0:t.apiKey))(t);return new di({url:Ro(t),headers:Iu(t,e,null==t?void 0:t.logsHeaders),timeoutMillis:(null==t?void 0:t.logsTimeout)||(null==t?void 0:t.timeout)||1e4})}(t)),(null==t?void 0:t.localVisualizations)&&e.push(new go),e}class $u{constructor(t){this._exporters=t}export(t,e){this._exporters.forEach((r=>r.export(t,e))),e({code:fe.SUCCESS})}async shutdown(){const t=[];this._exporters.forEach((e=>t.push(e.shutdown()))),await Promise.all(t)}}class ju{constructor(){}onStart(t,e){var r,n;(null!==(n=null===(r=Ut.getBaggage(e))||void 0===r?void 0:r.getAllEntries())&&void 0!==n?n:[]).forEach((e=>{t.setAttribute(e[0],e[1].value),f.debug(`@honeycombio/opentelemetry-web: 🚨 Baggage in all outgoing headers: ${e[0]}=${e[1].value} `)}))}onEnd(){}forceFlush(){return Promise.resolve()}shutdown(){return Promise.resolve()}}class Vu{constructor(){}onStart(t){const{href:e,pathname:r,search:n,hash:i,hostname:s}=window.location;t.setAttributes({[Fa]:window.innerWidth,[$a]:window.innerHeight,[qa]:i,[Wa]:e,[Xa]:r,[Ka]:s,[Ya]:n,[Za]:r})}onEnd(){}forceFlush(){return Promise.resolve()}shutdown(){return Promise.resolve()}}const Gu=(new Ee).generateTraceId(),Hu={getSessionId:()=>Gu},zu=t=>{const e=[];var r;return(null==t?void 0:t.disableBrowserAttributes)||e.push(new Vu),e.push(new ju,(r=(null==t?void 0:t.sessionProvider)||Hu,new pi(r)),...(null==t?void 0:t.spanProcessors)||[]),e},qu="browser.language",Wu="browser.mobile",Xu="telemetry.distro.name",Ku="telemetry.distro.version",Yu={path:!0,hash:!0,hostname:!0,referrer:!0,url:!1,search:!1};function Zu(t,e){if(t)return e}const Qu=t=>{let e=ae({});return(null==t?void 0:t.disableBrowserAttributes)||(e=e.merge(function(t){if(!1===t||!(null===window||void 0===window?void 0:window.location))return ae({});const e=function(t){return t?Object.assign(Object.assign({},Yu),t):Yu}(t),{href:r,pathname:n,search:i,hash:s,hostname:o}=window.location;return ae({[Qa]:Zu(e.url,r),[Ja]:Zu(e.path,n),[tc]:Zu(e.search,i),[ec]:Zu(e.hash,s),[rc]:Zu(e.hostname,o),[nc]:Zu(e.referrer,document.referrer)})}(null==t?void 0:t.entryPageAttributes)).merge(function(){const{browserName:t,browserVersion:e,deviceType:r}=(t=>{const e=new(bi())(t),{name:r,version:n}=e.getBrowser();return{browserName:null!=r?r:"unknown",browserVersion:null!=n?n:"unknown",deviceType:(i=e.getDevice().type,s=r,i||s?i||"desktop":"unknown")};var i,s})(navigator.userAgent);var n,i,s;return ae({[re]:navigator.userAgent,[Wu]:navigator.userAgent.includes("Mobi"),[Ba]:navigator.maxTouchPoints>0,[qu]:navigator.language,[Da]:t,[Ua]:e,[ja]:r,[Va]:(i=navigator.connection,null!==(s=null==i?void 0:i.effectiveType)&&void 0!==s?s:"unknown"),[Ga]:window.screen.width,[Ha]:window.screen.height,[za]:(n=window.screen.width,n<=768?"small":n>768&&n<=1024?"medium":n>1024?"large":"unknown")})}())),e=e.merge(ae({[ic]:tn,[sc]:"browser",[Xu]:"@honeycombio/opentelemetry-web",[Ku]:tn})),(null==t?void 0:t.resource)&&(e=e.merge(t.resource)),(null==t?void 0:t.resourceAttributes)&&(e=e.merge(ae(t.resourceAttributes))),e};class Ju extends _o{constructor(t){var e,r;const n=[...(null==t?void 0:t.instrumentations)||[]];!1!==(null===(e=null==t?void 0:t.webVitalsInstrumentationConfig)||void 0===e?void 0:e.enabled)&&n.push(new Nu(null==t?void 0:t.webVitalsInstrumentationConfig)),!1!==(null===(r=null==t?void 0:t.globalErrorsInstrumentationConfig)||void 0===r?void 0:r.enabled)&&n.push(new Pu(null==t?void 0:t.globalErrorsInstrumentationConfig)),super(Object.assign(Object.assign({},t),{instrumentations:n,resource:Qu(t),sampler:Wo(t),spanProcessors:zu(t),traceExporter:Uu(t),metricExporters:Bu(t),logExporters:Fu(t)})),(t=>{var e,r;const n=(null==t?void 0:t.logLevel)?t.logLevel:d.DEBUG;if(null==t?void 0:t.skipOptionsValidation)return void(n>=d.DEBUG&&console.debug($o));const i=null!==(e=null==t?void 0:t.tracesEndpoint)&&void 0!==e?e:null==t?void 0:t.endpoint;if(!i||!(t=>{try{return!new URL(t).hostname.endsWith(".honeycomb.io")}catch(t){return!1}})(i))return!(null==t?void 0:t.apiKey)&&n>=d.WARN&&console.warn(Do),!(null==t?void 0:t.serviceName)&&n>=d.WARN&&console.warn(Uo),(null==t?void 0:t.apiKey)&&!Lo(null==t?void 0:t.apiKey)&&(null==t?void 0:t.dataset)&&n>=d.WARN&&console.warn(Bo),(null==t?void 0:t.apiKey)&&Lo(null==t?void 0:t.apiKey)&&!(null==t?void 0:t.dataset)&&n>=d.WARN&&console.warn(Fo),(null==t?void 0:t.sampler)&&n>=d.DEBUG&&console.debug(Vo),!0!==(null==t?void 0:t.disableDefaultTraceExporter)||(null==t?void 0:t.traceExporter)||(null===(r=null==t?void 0:t.traceExporters)||void 0===r?void 0:r.length)||console.warn(qo),t;n>=d.DEBUG&&console.debug(jo)})(t),(null==t?void 0:t.debug)&&function(t){if(!(null==t?void 0:t.debug))return;f.setLogger(new Tt,d.DEBUG),f.debug(xo("🐝 Honeycomb Web SDK Debug Mode Enabled 🐝"));const e=Mo(t),r=Object.assign(Object.assign(Object.assign({},Ao),t),{tracesEndpoint:e});!function(t){const e=ko(t)||"";e?f.debug(xo(`API Key configured for traces: '${e}'`)):f.debug(Do)}(r),function(t){const e=t.serviceName||Ao.serviceName;e!==Ao.serviceName?f.debug(`@honeycombio/opentelemetry-web: Service Name configured for traces: '${e}'`):f.debug(Uo)}(r),function(t){const e=Mo(t);e?f.debug(xo(`Endpoint configured for traces: '${e}'`)):f.debug(xo("No endpoint configured for traces"))}(r),function(t){const e=Io(t);e?f.debug(xo(`Sample Rate configured for traces: '${e}'`)):f.debug("No sampler configured for traces")}(r)}(t)}}const tl=performance;var el;new RegExp("^\\s?((?!ff)[\\da-f]{2})-((?![0]{32})[\\da-f]{32})-((?![0]{16})[\\da-f]{16})-([\\da-f]{2})(-.*)?\\s?$"),function(t){t.CONNECT_END="connectEnd",t.CONNECT_START="connectStart",t.DECODED_BODY_SIZE="decodedBodySize",t.DOM_COMPLETE="domComplete",t.DOM_CONTENT_LOADED_EVENT_END="domContentLoadedEventEnd",t.DOM_CONTENT_LOADED_EVENT_START="domContentLoadedEventStart",t.DOM_INTERACTIVE="domInteractive",t.DOMAIN_LOOKUP_END="domainLookupEnd",t.DOMAIN_LOOKUP_START="domainLookupStart",t.ENCODED_BODY_SIZE="encodedBodySize",t.FETCH_START="fetchStart",t.LOAD_EVENT_END="loadEventEnd",t.LOAD_EVENT_START="loadEventStart",t.NAVIGATION_START="navigationStart",t.REDIRECT_END="redirectEnd",t.REDIRECT_START="redirectStart",t.REQUEST_START="requestStart",t.RESPONSE_END="responseEnd",t.RESPONSE_START="responseStart",t.SECURE_CONNECTION_START="secureConnectionStart",t.START_TIME="startTime",t.UNLOAD_EVENT_END="unloadEventEnd",t.UNLOAD_EVENT_START="unloadEventStart"}(el||(el={}));const rl=performance,nl=Math.pow(10,6),il=Math.pow(10,9);function sl(t){const e=t/1e3;return[Math.trunc(e),Math.round(t%1e3*nl)]}function ol(){let t=rl.timeOrigin;if("number"!=typeof t){const e=rl;t=e.timing&&e.timing.fetchStart}return t}function al(t){if(e=t,Array.isArray(e)&&2===e.length&&"number"==typeof e[0]&&"number"==typeof e[1])return t;var e,r;if("number"==typeof t)return t<ol()?(r=t,function(t,e){const r=[t[0]+e[0],t[1]+e[1]];return r[1]>=il&&(r[1]-=il,r[0]+=1),r}(sl(ol()),sl("number"==typeof r?r:rl.now()))):sl(t);if(t instanceof Date)return sl(t.getTime());throw TypeError("Invalid input type")}function cl(t){return t[0]*il+t[1]}const ul="http.method",ll="http.url",hl="http.host",dl="http.scheme",pl="http.status_code",ml="http.user_agent",gl="http.request_content_length_uncompressed";let fl;function _l(t,e){return e in t}function vl(t,e,r,n=!0){if(_l(r,e)&&"number"==typeof r[e]&&(!n||0!==r[e]))return t.addEvent(e,r[e])}function bl(t,e,r=!1,n){void 0===n&&(n=0!==e[el.START_TIME]),r||(vl(t,el.FETCH_START,e,n),vl(t,el.DOMAIN_LOOKUP_START,e,n),vl(t,el.DOMAIN_LOOKUP_END,e,n),vl(t,el.CONNECT_START,e,n),vl(t,el.SECURE_CONNECTION_START,e,n),vl(t,el.CONNECT_END,e,n),vl(t,el.REQUEST_START,e,n),vl(t,el.RESPONSE_START,e,n),vl(t,el.RESPONSE_END,e,n));const i=e[el.ENCODED_BODY_SIZE];void 0!==i&&t.setAttribute("http.response_content_length",i);const s=e[el.DECODED_BODY_SIZE];void 0!==s&&i!==s&&t.setAttribute("http.response_content_length_uncompressed",s)}function wl(){return"undefined"!=typeof location?location.origin:void 0}function yl(t,e,r,n,i=new WeakSet,s){const o=Tl(t),a=function(t,e,r,n,i,s){const o=cl(e),a=cl(r);let c=n.filter((e=>{const r=cl(al(e[el.FETCH_START])),n=cl(al(e[el.RESPONSE_END]));return e.initiatorType.toLowerCase()===(s||"xmlhttprequest")&&e.name===t&&r>=o&&n<=a}));return c.length>0&&(c=c.filter((t=>!i.has(t)))),c}(t=o.toString(),e,r,n,i,s);if(0===a.length)return{mainRequest:void 0};if(1===a.length)return{mainRequest:a[0]};const c=function(t){return t.slice().sort(((t,e)=>{const r=t[el.FETCH_START],n=e[el.FETCH_START];return r>n?1:r<n?-1:0}))}(a);if(o.origin!==wl()&&c.length>1){let t=c[0],e=function(t,e,r){const n=cl(r),i=cl(al(e));let s,o=t[1];const a=t.length;for(let e=1;e<a;e++){const r=t[e],a=cl(al(r[el.FETCH_START])),c=n-cl(al(r[el.RESPONSE_END]));a>=i&&(!s||c<s)&&(s=c,o=r)}return o}(c,t[el.RESPONSE_END],r);const n=t[el.RESPONSE_END];return e[el.FETCH_START]<n&&(e=t,t=void 0),{corsPreFlightRequest:t,mainRequest:e}}return{mainRequest:a[0]}}function Tl(t){if("function"==typeof URL)return new URL(t,"undefined"!=typeof document?document.baseURI:"undefined"!=typeof location?location.href:void 0);const e=(fl||(fl=document.createElement("a")),fl);return e.href=t,e}function Sl(t,e){if(t.nodeType===Node.DOCUMENT_NODE)return"/";const r=function(t,e){const r=t.nodeType,n=function(t){if(!t.parentNode)return 0;const e=[t.nodeType];t.nodeType===Node.CDATA_SECTION_NODE&&e.push(Node.TEXT_NODE);let r=Array.from(t.parentNode.childNodes);return r=r.filter((r=>{const n=r.localName;return e.indexOf(r.nodeType)>=0&&n===t.localName})),r.length>=1?r.indexOf(t)+1:0}(t);let i="";if(r===Node.ELEMENT_NODE){const r=t.getAttribute("id");if(e&&r)return`//*[@id="${r}"]`;i=t.localName}else if(r===Node.TEXT_NODE||r===Node.CDATA_SECTION_NODE)i="text()";else{if(r!==Node.COMMENT_NODE)return"";i="comment()"}return i&&n>1?`/${i}[${n}]`:`/${i}`}(t,e);if(e&&r.indexOf("@id")>0)return r;let n="";return t.parentNode&&(n+=Sl(t.parentNode,!1)),n+=r,n}function El(t,e){let r=e||[];return("string"==typeof r||r instanceof RegExp)&&(r=[r]),Tl(t).origin===wl()||r.some((e=>{return r=t,"string"==typeof(n=e)?r===n:!!r.match(n);var r,n}))}const Al="object"==typeof globalThis?globalThis:"object"==typeof self?self:"object"==typeof window?window:"object"==typeof r.g?r.g:{},xl=Symbol.for("io.opentelemetry.js.api.logs"),Cl=Al;class Ol{emit(t){}}const Ll=new Ol,Nl=new class{getLogger(t,e,r){return new Ol}};class Ml{constructor(t,e,r,n){this._provider=t,this.name=e,this.version=r,this.options=n}emit(t){this._getLogger().emit(t)}_getLogger(){if(this._delegate)return this._delegate;const t=this._provider.getDelegateLogger(this.name,this.version,this.options);return t?(this._delegate=t,this._delegate):Ll}}class Pl{getLogger(t,e,r){var n;return null!==(n=this.getDelegateLogger(t,e,r))&&void 0!==n?n:new Ml(this,t,e,r)}getDelegate(){var t;return null!==(t=this._delegate)&&void 0!==t?t:Nl}setDelegate(t){this._delegate=t}getDelegateLogger(t,e,r){var n;return null===(n=this._delegate)||void 0===n?void 0:n.getLogger(t,e,r)}}class Rl{constructor(){this._proxyLoggerProvider=new Pl}static getInstance(){return this._instance||(this._instance=new Rl),this._instance}setGlobalLoggerProvider(t){return Cl[xl]?this.getLoggerProvider():(Cl[xl]=(1,e=t,r=Nl,t=>1===t?e:r),this._proxyLoggerProvider.setDelegate(t),t);var e,r}getLoggerProvider(){var t,e;return null!==(e=null===(t=Cl[xl])||void 0===t?void 0:t.call(Cl,1))&&void 0!==e?e:this._proxyLoggerProvider}getLogger(t,e,r){return this.getLoggerProvider().getLogger(t,e,r)}disable(){delete Cl[xl],this._proxyLoggerProvider=new Pl}}const kl=Rl.getInstance();class Il{instrumentationName;instrumentationVersion;_config={};_tracer;_meter;_logger;_diag;constructor(t,e,r){this.instrumentationName=t,this.instrumentationVersion=e,this.setConfig(r),this._diag=f.createComponentLogger({namespace:t}),this._tracer=K.getTracer(t,e),this._meter=wt.getMeter(t,e),this._logger=kl.getLogger(t,e),this._updateMetricInstruments()}_wrap=cn.wrap;_unwrap=cn.unwrap;_massWrap=cn.massWrap;_massUnwrap=cn.massUnwrap;get meter(){return this._meter}setMeterProvider(t){this._meter=t.getMeter(this.instrumentationName,this.instrumentationVersion),this._updateMetricInstruments()}get logger(){return this._logger}setLoggerProvider(t){this._logger=t.getLogger(this.instrumentationName,this.instrumentationVersion)}getModuleDefinitions(){const t=this.init()??[];return Array.isArray(t)?t:[t]}_updateMetricInstruments(){}getConfig(){return this._config}setConfig(t){this._config={enabled:!0,...t}}setTracerProvider(t){this._tracer=t.getTracer(this.instrumentationName,this.instrumentationVersion)}get tracer(){return this._tracer}_runSpanCustomizationHook(t,e,r,n){if(t)try{t(r,n)}catch(t){this._diag.error("Error running span customization hook due to exception in handler",{triggerName:e},t)}}}class Dl extends Il{constructor(t,e,r){super(t,e,r),this._config.enabled&&this.enable()}}function Ul(t,e,r){let n,i;try{i=t()}catch(t){n=t}finally{if(e(n,i),n&&!r)throw n;return i}}function Bl(t){return"function"==typeof t&&"function"==typeof t.__original&&"function"==typeof t.__unwrap&&!0===t.__wrapped}var Fl,$l;!function(t){t.DOCUMENT_LOAD="documentLoad",t.DOCUMENT_FETCH="documentFetch",t.RESOURCE_FETCH="resourceFetch"}(Fl||(Fl={})),function(t){t.FIRST_PAINT="firstPaint",t.FIRST_CONTENTFUL_PAINT="firstContentfulPaint"}($l||($l={}));const jl={"first-paint":$l.FIRST_PAINT,"first-contentful-paint":$l.FIRST_CONTENTFUL_PAINT};function Vl(t,e){return"string"==typeof e?t===e:!!t.match(e)}const Gl=performance,Hl=Math.pow(10,6),zl=Math.pow(10,9);function ql(t){const e=t/1e3;return[Math.trunc(e),Math.round(t%1e3*Hl)]}function Wl(t){return function(t,e){const r=[t[0]+e[0],t[1]+e[1]];return r[1]>=zl&&(r[1]-=zl,r[0]+=1),r}(ql(function(){let t=Gl.timeOrigin;if("number"!=typeof t){const e=Gl;t=e.timing&&e.timing.fetchStart}return t}()),ql("number"==typeof t?t:Gl.now()))}var Xl;!function(t){t.COMPONENT="component",t.HTTP_ERROR_NAME="http.error_name",t.HTTP_STATUS_TEXT="http.status_text"}(Xl||(Xl={}));const Kl=f.createComponentLogger({namespace:"@opentelemetry/opentelemetry-instrumentation-fetch/utils"});const Yl=new TextEncoder;function Zl(t){return Yl.encode(t).byteLength}const Ql="0.200.0",Jl="object"==typeof globalThis?globalThis:"object"==typeof self?self:"object"==typeof window?window:"object"==typeof r.g?r.g:{},th="object"==typeof process&&"node"===process.release?.name,eh=performance,rh=Math.pow(10,6),nh=Math.pow(10,9);function ih(t){const e=t/1e3;return[Math.trunc(e),Math.round(t%1e3*rh)]}function sh(t){return function(t,e){const r=[t[0]+e[0],t[1]+e[1]];return r[1]>=nh&&(r[1]-=nh,r[0]+=1),r}(ih(function(){let t=eh.timeOrigin;if("number"!=typeof t){const e=eh;t=e.timing&&e.timing.fetchStart}return t}()),ih("number"==typeof t?t:eh.now()))}var oh;!function(t){t.EVENT_TYPE="event_type",t.TARGET_ELEMENT="target_element",t.TARGET_XPATH="target_xpath",t.HTTP_URL="http.url"}(oh||(oh={}));const ah="0.45.0",ch=["click"];function uh(){return!1}const lh=performance;function hh(t,e){return"string"==typeof e?t===e:!!t.match(e)}const dh=Math.pow(10,6),ph=Math.pow(10,9);function mh(t){const e=t/1e3;return[Math.trunc(e),Math.round(t%1e3*dh)]}function gh(t){return function(t,e){const r=[t[0]+e[0],t[1]+e[1]];return r[1]>=ph&&(r[1]-=ph,r[0]+=1),r}(mh(function(){let t=lh.timeOrigin;if("number"!=typeof t){const e=lh;t=e.timing&&e.timing.fetchStart}return t}()),mh("number"==typeof t?t:lh.now()))}var fh;!function(t){t.METHOD_OPEN="open",t.METHOD_SEND="send",t.EVENT_ABORT="abort",t.EVENT_ERROR="error",t.EVENT_LOAD="loaded",t.EVENT_TIMEOUT="timeout"}(fh||(fh={}));const _h=f.createComponentLogger({namespace:"@opentelemetry/opentelemetry-instrumentation-xml-http-request/utils"});const vh=new TextEncoder;function bh(t){return vh.encode(t).byteLength}const wh="0.200.0";var yh;!function(t){t.HTTP_STATUS_TEXT="http.status_text"}(yh||(yh={}));const Th={"@opentelemetry/instrumentation-document-load":class extends Dl{component="document-load";version="1";moduleName=this.component;constructor(t={}){super("@opentelemetry/instrumentation-document-load","0.45.0",t)}init(){}_onDocumentLoaded(){window.setTimeout((()=>{this._collectPerformance()}))}_addResourcesSpans(t){const e=tl.getEntriesByType?.("resource");e&&e.forEach((e=>{this._initResourceSpan(e,t)}))}_collectPerformance(){const t=Array.from(document.getElementsByTagName("meta")).find((t=>"traceparent"===t.getAttribute("name"))),e=(()=>{const t={},e=tl.getEntriesByType?.("navigation")[0];if(e)Object.values(el).forEach((r=>{if(_l(e,r)){const n=e[r];"number"==typeof n&&(t[r]=n)}}));else{const e=tl.timing;e&&Object.values(el).forEach((r=>{if(_l(e,r)){const n=e[r];"number"==typeof n&&(t[r]=n)}}))}return t})(),r=t&&t.content||"";Q.with(Ut.extract(w,{traceparent:r}),(()=>{const t=this._startSpan(Fl.DOCUMENT_LOAD,el.FETCH_START,e);t&&(Q.with(K.setSpan(Q.active(),t),(()=>{const t=this._startSpan(Fl.DOCUMENT_FETCH,el.FETCH_START,e);t&&(t.setAttribute(ll,location.href),Q.with(K.setSpan(Q.active(),t),(()=>{this.getConfig().ignoreNetworkEvents||bl(t,e),this._addCustomAttributesOnSpan(t,this.getConfig().applyCustomAttributesOnSpan?.documentFetch),this._endSpan(t,el.RESPONSE_END,e)})))})),t.setAttribute(ll,location.href),t.setAttribute(ml,navigator.userAgent),this._addResourcesSpans(t),this.getConfig().ignoreNetworkEvents||(vl(t,el.FETCH_START,e),vl(t,el.UNLOAD_EVENT_START,e),vl(t,el.UNLOAD_EVENT_END,e),vl(t,el.DOM_INTERACTIVE,e),vl(t,el.DOM_CONTENT_LOADED_EVENT_START,e),vl(t,el.DOM_CONTENT_LOADED_EVENT_END,e),vl(t,el.DOM_COMPLETE,e),vl(t,el.LOAD_EVENT_START,e),vl(t,el.LOAD_EVENT_END,e)),this.getConfig().ignorePerformancePaintEvents||(t=>{const e=tl.getEntriesByType?.("paint");e&&e.forEach((({name:e,startTime:r})=>{_l(jl,e)&&t.addEvent(jl[e],r)}))})(t),this._addCustomAttributesOnSpan(t,this.getConfig().applyCustomAttributesOnSpan?.documentLoad),this._endSpan(t,el.LOAD_EVENT_END,e))}))}_endSpan(t,e,r){t&&(_l(r,e)?t.end(r[e]):t.end())}_initResourceSpan(t,e){const r=this._startSpan(Fl.RESOURCE_FETCH,el.FETCH_START,t,e);r&&(r.setAttribute(ll,t.name),this.getConfig().ignoreNetworkEvents||bl(r,t),this._addCustomAttributesOnResourceSpan(r,t,this.getConfig().applyCustomAttributesOnSpan?.resourceFetch),this._endSpan(r,el.RESPONSE_END,t))}_startSpan(t,e,r,n){if(_l(r,e)&&"number"==typeof r[e])return this.tracer.startSpan(t,{startTime:r[e]},n?K.setSpan(Q.active(),n):void 0)}_waitForPageLoad(){"complete"===window.document.readyState?this._onDocumentLoaded():(this._onDocumentLoaded=this._onDocumentLoaded.bind(this),window.addEventListener("load",this._onDocumentLoaded))}_addCustomAttributesOnSpan(t,e){e&&Ul((()=>e(t)),(t=>{t&&this._diag.error("addCustomAttributesOnSpan",t)}),!0)}_addCustomAttributesOnResourceSpan(t,e,r){r&&Ul((()=>r(t,e)),(t=>{t&&this._diag.error("addCustomAttributesOnResourceSpan",t)}),!0)}enable(){window.removeEventListener("load",this._onDocumentLoaded),this._waitForPageLoad()}disable(){window.removeEventListener("load",this._onDocumentLoaded)}},"@opentelemetry/instrumentation-fetch":class extends Dl{component="fetch";version=Ql;moduleName=this.component;_usedResources=new WeakSet;_tasksCount=0;constructor(t={}){super("@opentelemetry/instrumentation-fetch",Ql,t)}init(){}_addChildSpan(t,e){const r=this.tracer.startSpan("CORS Preflight",{startTime:e[el.FETCH_START]},K.setSpan(Q.active(),t));bl(r,e,this.getConfig().ignoreNetworkEvents),r.end(e[el.RESPONSE_END])}_addFinalSpanAttributes(t,e){const r=Tl(e.url);t.setAttribute(pl,e.status),null!=e.statusText&&t.setAttribute(Xl.HTTP_STATUS_TEXT,e.statusText),t.setAttribute(hl,r.host),t.setAttribute(dl,r.protocol.replace(":","")),"undefined"!=typeof navigator&&t.setAttribute(ml,navigator.userAgent)}_addHeaders(t,e){if(!El(e,this.getConfig().propagateTraceHeaderCorsUrls)){const t={};return Ut.inject(Q.active(),t),void(Object.keys(t).length>0&&this._diag.debug("headers inject skipped due to CORS policy"))}if(t instanceof Request)Ut.inject(Q.active(),t.headers,{set:(t,e,r)=>t.set(e,"string"==typeof r?r:String(r))});else if(t.headers instanceof Headers)Ut.inject(Q.active(),t.headers,{set:(t,e,r)=>t.set(e,"string"==typeof r?r:String(r))});else if(t.headers instanceof Map)Ut.inject(Q.active(),t.headers,{set:(t,e,r)=>t.set(e,"string"==typeof r?r:String(r))});else{const e={};Ut.inject(Q.active(),e),t.headers=Object.assign({},e,t.headers||{})}}_clearResources(){0===this._tasksCount&&this.getConfig().clearTimingResources&&(performance.clearResourceTimings(),this._usedResources=new WeakSet)}_createSpan(t,e={}){if(function(t,e){if(!e)return!1;for(const r of e)if(Vl(t,r))return!0;return!1}(t,this.getConfig().ignoreUrls))return void this._diag.debug("ignoring span as url matches ignored url");const r=(e.method||"GET").toUpperCase(),n=`HTTP ${r}`;return this.tracer.startSpan(n,{kind:We.CLIENT,attributes:{[Xl.COMPONENT]:this.moduleName,[ul]:r,[ll]:t}})}_findResourceAndAddNetworkEvents(t,e,r){let n=e.entries;if(!n.length){if(!performance.getEntriesByType)return;n=performance.getEntriesByType("resource")}const i=yl(e.spanUrl,e.startTime,r,n,this._usedResources,"fetch");if(i.mainRequest){const e=i.mainRequest;this._markResourceAsUsed(e);const r=i.corsPreFlightRequest;r&&(this._addChildSpan(t,r),this._markResourceAsUsed(r)),bl(t,e,this.getConfig().ignoreNetworkEvents)}}_markResourceAsUsed(t){this._usedResources.add(t)}_endSpan(t,e,r){const n=ql(Date.now()),i=Wl();this._addFinalSpanAttributes(t,r),setTimeout((()=>{e.observer?.disconnect(),this._findResourceAndAddNetworkEvents(t,e,i),this._tasksCount--,this._clearResources(),t.end(n)}),300)}_patchConstructor(){return t=>{const e=this;return function(...r){const n=this,i=Tl(r[0]instanceof Request?r[0].url:String(r[0])).href,s=r[0]instanceof Request?r[0]:r[1]||{},o=e._createSpan(i,s);if(!o)return t.apply(this,r);const a=e._prepareSpanData(i);function c(t,r){e._applyAttributesAfterFetch(t,s,r),e._endSpan(t,a,{status:r.status||0,statusText:r.message,url:i})}function u(t,r){e._applyAttributesAfterFetch(t,s,r),r.status>=200&&r.status<400?e._endSpan(t,a,r):e._endSpan(t,a,{status:r.status,statusText:r.statusText,url:i})}function l(t,e,r){try{const e=r.clone().body;if(e){const n=e.getReader(),i=()=>{n.read().then((({done:e})=>{e?u(t,r):i()}),(e=>{c(t,e)}))};i()}else u(t,r)}finally{e(r)}}function h(t,e,r){try{c(t,r)}finally{e(r)}}return e.getConfig().measureRequestSize&&function(...t){if(t[0]instanceof URL||"string"==typeof t[0]){const r=t[1];if(!r?.body)return Promise.resolve();if(r.body instanceof ReadableStream){const{body:t,length:e}=function(t){if(!t.pipeThrough)return Kl.warn("Platform has ReadableStream but not pipeThrough!"),{body:t,length:Promise.resolve(void 0)};let e,r=0;const n=new Promise((t=>{e=t})),i=new TransformStream({start(){},async transform(t,e){const n=await t;r+=n.byteLength,e.enqueue(t)},flush(){e(r)}});return{body:t.pipeThrough(i),length:n}}(r.body);return r.body=t,e}return Promise.resolve((e=r.body,"undefined"!=typeof Document&&e instanceof Document?(new XMLSerializer).serializeToString(document).length:"string"==typeof e?Zl(e):e instanceof Blob?e.size:e instanceof FormData?function(t){let e=0;for(const[r,n]of t.entries())e+=r.length,n instanceof Blob?e+=n.size:e+=n.length;return e}(e):e instanceof URLSearchParams?Zl(e.toString()):void 0!==e.byteLength?e.byteLength:void Kl.warn("unknown body type")))}var e;{const e=t[0];return e?.body?e.clone().text().then((t=>Zl(t))):Promise.resolve()}}(...r).then((t=>{t&&o.setAttribute(gl,t)})).catch((t=>{e._diag.warn("getFetchBodyLength",t)})),new Promise(((r,a)=>Q.with(K.setSpan(Q.active(),o),(()=>(e._addHeaders(s,i),e._callRequestHook(o,s),e._tasksCount++,t.apply(n,s instanceof Request?[s]:[i,s]).then(l.bind(n,o,r),h.bind(n,o,a)))))))}}}_applyAttributesAfterFetch(t,e,r){const n=this.getConfig().applyCustomAttributesOnSpan;n&&Ul((()=>n(t,e,r)),(t=>{t&&this._diag.error("applyCustomAttributesOnSpan",t)}),!0)}_callRequestHook(t,e){const r=this.getConfig().requestHook;r&&Ul((()=>r(t,e)),(t=>{t&&this._diag.error("requestHook",t)}),!0)}_prepareSpanData(t){const e=Wl(),r=[];if("function"!=typeof PerformanceObserver)return{entries:r,startTime:e,spanUrl:t};const n=new PerformanceObserver((e=>{e.getEntries().forEach((e=>{"fetch"===e.initiatorType&&e.name===t&&r.push(e)}))}));return n.observe({entryTypes:["resource"]}),{entries:r,observer:n,startTime:e,spanUrl:t}}enable(){th?this._diag.warn("this instrumentation is intended for web usage only, it does not instrument Node.js's fetch()"):(Bl(fetch)&&(this._unwrap(Jl,"fetch"),this._diag.debug("removing previous patch for constructor")),this._wrap(Jl,"fetch",this._patchConstructor()))}disable(){th||(this._unwrap(Jl,"fetch"),this._usedResources=new WeakSet)}},"@opentelemetry/instrumentation-user-interaction":class extends Dl{version=ah;moduleName="user-interaction";_spansData=new WeakMap;_wrappedListeners=new WeakMap;_eventsSpanMap=new WeakMap;_eventNames;_shouldPreventSpanCreation;constructor(t={}){super("@opentelemetry/instrumentation-user-interaction",ah,t),this._eventNames=new Set(t?.eventNames??ch),this._shouldPreventSpanCreation="function"==typeof t?.shouldPreventSpanCreation?t.shouldPreventSpanCreation:uh}init(){}_checkForTimeout(t,e){const r=this._spansData.get(e);r&&("setTimeout"===t.source?r.hrTimeLastTimeout=sh():"Promise.then"!==t.source&&"setTimeout"!==t.source&&(r.hrTimeLastTimeout=void 0))}_allowEventName(t){return this._eventNames.has(t)}_createSpan(t,e,r){if(!(t instanceof HTMLElement))return;if(!t.getAttribute)return;if(t.hasAttribute("disabled"))return;if(!this._allowEventName(e))return;const n=Sl(t,!0);try{const i=this.tracer.startSpan(e,{attributes:{[oh.EVENT_TYPE]:e,[oh.TARGET_ELEMENT]:t.tagName,[oh.TARGET_XPATH]:n,[oh.HTTP_URL]:window.location.href}},r?K.setSpan(Q.active(),r):void 0);if(!0===this._shouldPreventSpanCreation(e,t,i))return;return this._spansData.set(i,{taskCount:0}),i}catch(t){this._diag.error("failed to start create new user interaction span",t)}}_decrementTask(t){const e=this._spansData.get(t);e&&(e.taskCount--,0===e.taskCount&&this._tryToEndSpan(t,e.hrTimeLastTimeout))}_getCurrentSpan(t){const e=t.get("OT_ZONE_CONTEXT");return e?K.getSpan(e):e}_incrementTask(t){const e=this._spansData.get(t);e&&e.taskCount++}addPatchedListener(t,e,r,n){let i=this._wrappedListeners.get(r);i||(i=new Map,this._wrappedListeners.set(r,i));let s=i.get(e);return s||(s=new Map,i.set(e,s)),!s.has(t)&&(s.set(t,n),!0)}removePatchedListener(t,e,r){const n=this._wrappedListeners.get(r);if(!n)return;const i=n.get(e);if(!i)return;const s=i.get(t);return s&&(i.delete(t),0===i.size&&(n.delete(e),0===n.size&&this._wrappedListeners.delete(r))),s}_invokeListener(t,e,r){return"function"==typeof t?t.apply(e,r):t.handleEvent(r[0])}_patchAddEventListener(){const t=this;return e=>function(r,n,i){if(!n)return e.call(this,r,n,i);const s=i&&"object"==typeof i&&i.once,o=function(...e){let i;const o=e[0],a=o?.target;o&&(i=t._eventsSpanMap.get(o)),s&&t.removePatchedListener(this,r,n);const c=t._createSpan(a,r,i);return c?(o&&t._eventsSpanMap.set(o,c),Q.with(K.setSpan(Q.active(),c),(()=>{const r=t._invokeListener(n,this,e);return c.end(),r}))):t._invokeListener(n,this,e)};return t.addPatchedListener(this,r,n,o)?e.call(this,r,o,i):void 0}}_patchRemoveEventListener(){const t=this;return e=>function(r,n,i){const s=t.removePatchedListener(this,r,n);return s?e.call(this,r,s,i):e.call(this,r,n,i)}}_getPatchableEventTargets(){return window.EventTarget?[EventTarget.prototype]:[Node.prototype,Window.prototype]}_patchHistoryApi(){this._unpatchHistoryApi(),this._wrap(history,"replaceState",this._patchHistoryMethod()),this._wrap(history,"pushState",this._patchHistoryMethod()),this._wrap(history,"back",this._patchHistoryMethod()),this._wrap(history,"forward",this._patchHistoryMethod()),this._wrap(history,"go",this._patchHistoryMethod())}_patchHistoryMethod(){const t=this;return e=>function(...r){const n=`${location.pathname}${location.hash}${location.search}`,i=e.apply(this,r),s=`${location.pathname}${location.hash}${location.search}`;return n!==s&&t._updateInteractionName(s),i}}_unpatchHistoryApi(){Bl(history.replaceState)&&this._unwrap(history,"replaceState"),Bl(history.pushState)&&this._unwrap(history,"pushState"),Bl(history.back)&&this._unwrap(history,"back"),Bl(history.forward)&&this._unwrap(history,"forward"),Bl(history.go)&&this._unwrap(history,"go")}_updateInteractionName(t){const e=K.getSpan(Q.active());e&&"function"==typeof e.updateName&&e.updateName(`Navigation: ${t}`)}_patchZoneCancelTask(){const t=this;return e=>function(r){const n=Zone.current,i=t._getCurrentSpan(n);return i&&t._shouldCountTask(r,n)&&t._decrementTask(i),e.call(this,r)}}_patchZoneScheduleTask(){const t=this;return e=>function(r){const n=Zone.current,i=t._getCurrentSpan(n);return i&&t._shouldCountTask(r,n)&&(t._incrementTask(i),t._checkForTimeout(r,i)),e.call(this,r)}}_patchZoneRunTask(){const t=this;return e=>function(r,n,i){const s=Array.isArray(i)&&i[0]instanceof Event?i[0]:void 0,o=s?.target;let a;const c=this;if(o){if(a=t._createSpan(o,r.eventName),a)return t._incrementTask(a),c.run((()=>{try{return Q.with(K.setSpan(Q.active(),a),(()=>{const t=Zone.current;return r._zone=t,e.call(t,r,n,i)}))}finally{t._decrementTask(a)}}))}else a=t._getCurrentSpan(c);try{return e.call(c,r,n,i)}finally{a&&t._shouldCountTask(r,c)&&t._decrementTask(a)}}}_shouldCountTask(t,e){if(t._zone&&(e=t._zone),!e||!t.data||t.data.isPeriodic)return!1;const r=this._getCurrentSpan(e);return!(!r||!this._spansData.get(r)||"macroTask"!==t.type&&"microTask"!==t.type)}_tryToEndSpan(t,e){t&&this._spansData.get(t)&&(t.end(e),this._spansData.delete(t))}enable(){const t=this._getZoneWithPrototype();this._diag.debug("applying patch to",this.moduleName,this.version,"zone:",!!t),t?(Bl(t.prototype.runTask)&&(this._unwrap(t.prototype,"runTask"),this._diag.debug("removing previous patch from method runTask")),Bl(t.prototype.scheduleTask)&&(this._unwrap(t.prototype,"scheduleTask"),this._diag.debug("removing previous patch from method scheduleTask")),Bl(t.prototype.cancelTask)&&(this._unwrap(t.prototype,"cancelTask"),this._diag.debug("removing previous patch from method cancelTask")),this._zonePatched=!0,this._wrap(t.prototype,"runTask",this._patchZoneRunTask()),this._wrap(t.prototype,"scheduleTask",this._patchZoneScheduleTask()),this._wrap(t.prototype,"cancelTask",this._patchZoneCancelTask())):(this._zonePatched=!1,this._getPatchableEventTargets().forEach((t=>{Bl(t.addEventListener)&&(this._unwrap(t,"addEventListener"),this._diag.debug("removing previous patch from method addEventListener")),Bl(t.removeEventListener)&&(this._unwrap(t,"removeEventListener"),this._diag.debug("removing previous patch from method removeEventListener")),this._wrap(t,"addEventListener",this._patchAddEventListener()),this._wrap(t,"removeEventListener",this._patchRemoveEventListener())}))),this._patchHistoryApi()}disable(){const t=this._getZoneWithPrototype();this._diag.debug("removing patch from",this.moduleName,this.version,"zone:",!!t),t&&this._zonePatched?(Bl(t.prototype.runTask)&&this._unwrap(t.prototype,"runTask"),Bl(t.prototype.scheduleTask)&&this._unwrap(t.prototype,"scheduleTask"),Bl(t.prototype.cancelTask)&&this._unwrap(t.prototype,"cancelTask")):this._getPatchableEventTargets().forEach((t=>{Bl(t.addEventListener)&&this._unwrap(t,"addEventListener"),Bl(t.removeEventListener)&&this._unwrap(t,"removeEventListener")})),this._unpatchHistoryApi()}_getZoneWithPrototype(){return window.Zone}},"@opentelemetry/instrumentation-xml-http-request":class extends Dl{component="xml-http-request";version=wh;moduleName=this.component;_tasksCount=0;_xhrMem=new WeakMap;_usedResources=new WeakSet;constructor(t={}){super("@opentelemetry/instrumentation-xml-http-request",wh,t)}init(){}_addHeaders(t,e){if(!El(Tl(e).href,this.getConfig().propagateTraceHeaderCorsUrls)){const t={};return Ut.inject(Q.active(),t),void(Object.keys(t).length>0&&this._diag.debug("headers inject skipped due to CORS policy"))}const r={};Ut.inject(Q.active(),r),Object.keys(r).forEach((e=>{t.setRequestHeader(e,String(r[e]))}))}_addChildSpan(t,e){Q.with(K.setSpan(Q.active(),t),(()=>{const t=this.tracer.startSpan("CORS Preflight",{startTime:e[el.FETCH_START]});bl(t,e,this.getConfig().ignoreNetworkEvents),t.end(e[el.RESPONSE_END])}))}_addFinalSpanAttributes(t,e,r){if("string"==typeof r){const n=Tl(r);void 0!==e.status&&t.setAttribute(pl,e.status),void 0!==e.statusText&&t.setAttribute(yh.HTTP_STATUS_TEXT,e.statusText),t.setAttribute(hl,n.host),t.setAttribute(dl,n.protocol.replace(":","")),t.setAttribute(ml,navigator.userAgent)}}_applyAttributesAfterXHR(t,e){const r=this.getConfig().applyCustomAttributesOnSpan;"function"==typeof r&&Ul((()=>r(t,e)),(t=>{t&&this._diag.error("applyCustomAttributesOnSpan",t)}),!0)}_addResourceObserver(t,e){const r=this._xhrMem.get(t);r&&"function"==typeof PerformanceObserver&&"function"==typeof PerformanceResourceTiming&&(r.createdResources={observer:new PerformanceObserver((t=>{const n=t.getEntries(),i=Tl(e);n.forEach((t=>{"xmlhttprequest"===t.initiatorType&&t.name===i.href&&r.createdResources&&r.createdResources.entries.push(t)}))})),entries:[]},r.createdResources.observer.observe({entryTypes:["resource"]}))}_clearResources(){0===this._tasksCount&&this.getConfig().clearTimingResources&&(lh.clearResourceTimings(),this._xhrMem=new WeakMap,this._usedResources=new WeakSet)}_findResourceAndAddNetworkEvents(t,e,r,n,i){if(!(r&&n&&i&&t.createdResources))return;let s=t.createdResources.entries;s&&s.length||(s=lh.getEntriesByType("resource"));const o=yl(Tl(r).href,n,i,s,this._usedResources);if(o.mainRequest){const t=o.mainRequest;this._markResourceAsUsed(t);const r=o.corsPreFlightRequest;r&&(this._addChildSpan(e,r),this._markResourceAsUsed(r)),bl(e,t,this.getConfig().ignoreNetworkEvents)}}_cleanPreviousSpanInformation(t){const e=this._xhrMem.get(t);if(e){const r=e.callbackToRemoveEvents;r&&r(),this._xhrMem.delete(t)}}_createSpan(t,e,r){if(function(t,e){if(!e)return!1;for(const r of e)if(hh(t,r))return!0;return!1}(e,this.getConfig().ignoreUrls))return void this._diag.debug("ignoring span as url matches ignored url");const n=r.toUpperCase(),i=this.tracer.startSpan(n,{kind:We.CLIENT,attributes:{[ul]:r,[ll]:Tl(e).toString()}});return i.addEvent(fh.METHOD_OPEN),this._cleanPreviousSpanInformation(t),this._xhrMem.set(t,{span:i,spanUrl:e}),i}_markResourceAsUsed(t){this._usedResources.add(t)}_patchOpen(){return t=>{const e=this;return function(...r){const n=r[0],i=r[1];return e._createSpan(this,i,n),t.apply(this,r)}}}_patchSend(){const t=this;function e(e,r){const n=t._xhrMem.get(r);if(!n)return;n.status=r.status,n.statusText=r.statusText,t._xhrMem.delete(r),n.span&&t._applyAttributesAfterXHR(n.span,r);const i=gh(),s=Date.now();setTimeout((()=>{!function(e,r,n,i){const s=r.callbackToRemoveEvents;"function"==typeof s&&s();const{span:o,spanUrl:a,sendStartTime:c}=r;o&&(t._findResourceAndAddNetworkEvents(r,o,a,c,n),o.addEvent(e,i),t._addFinalSpanAttributes(o,r,a),o.end(i),t._tasksCount--),t._clearResources()}(e,n,i,s)}),300)}function r(){e(fh.EVENT_ERROR,this)}function n(){e(fh.EVENT_ABORT,this)}function i(){e(fh.EVENT_TIMEOUT,this)}function s(){this.status<299?e(fh.EVENT_LOAD,this):e(fh.EVENT_ERROR,this)}return e=>function(...o){const a=t._xhrMem.get(this);if(!a)return e.apply(this,o);const c=a.span,u=a.spanUrl;if(c&&u){if(t.getConfig().measureRequestSize&&o?.[0]){const t=(l=o[0],"undefined"!=typeof Document&&l instanceof Document?(new XMLSerializer).serializeToString(document).length:"string"==typeof l?bh(l):l instanceof Blob?l.size:l instanceof FormData?function(t){let e=0;for(const[r,n]of t.entries())e+=r.length,n instanceof Blob?e+=n.size:e+=n.length;return e}(l):l instanceof URLSearchParams?bh(l.toString()):void 0!==l.byteLength?l.byteLength:void _h.warn("unknown body type"));void 0!==t&&c.setAttribute(gl,t)}Q.with(K.setSpan(Q.active(),c),(()=>{t._tasksCount++,a.sendStartTime=gh(),c.addEvent(fh.METHOD_SEND),this.addEventListener("abort",n),this.addEventListener("error",r),this.addEventListener("load",s),this.addEventListener("timeout",i),a.callbackToRemoveEvents=()=>{!function(e){e.removeEventListener("abort",n),e.removeEventListener("error",r),e.removeEventListener("load",s),e.removeEventListener("timeout",i);const o=t._xhrMem.get(e);o&&(o.callbackToRemoveEvents=void 0)}(this),a.createdResources&&a.createdResources.observer.disconnect()},t._addHeaders(this,u),t._addResourceObserver(this,u)}))}var l;return e.apply(this,o)}}enable(){this._diag.debug("applying patch to",this.moduleName,this.version),Bl(XMLHttpRequest.prototype.open)&&(this._unwrap(XMLHttpRequest.prototype,"open"),this._diag.debug("removing previous patch from method open")),Bl(XMLHttpRequest.prototype.send)&&(this._unwrap(XMLHttpRequest.prototype,"send"),this._diag.debug("removing previous patch from method send")),this._wrap(XMLHttpRequest.prototype,"open",this._patchOpen()),this._wrap(XMLHttpRequest.prototype,"send",this._patchSend())}disable(){this._diag.debug("removing patch from",this.moduleName,this.version),this._unwrap(XMLHttpRequest.prototype,"open"),this._unwrap(XMLHttpRequest.prototype,"send"),this._tasksCount=0,this._xhrMem=new WeakMap,this._usedResources=new WeakSet}}};function Sh(t={}){for(const e of Object.keys(t))Object.prototype.hasOwnProperty.call(Th,e)||f.error(`Provided instrumentation name "${e}" not found`);const e=[];for(const r of Object.keys(Th)){const n=Th[r],i=t[r]??{};if(!1!==i.enabled)try{f.debug(`Loading instrumentation for ${r}`),e.push(new n(i))}catch(t){f.error(t)}else f.debug(`Disabling instrumentation for ${r}`)}return e}function Eh(t){return Eh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Eh(t)}function Ah(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,xh(n.key),n)}}function xh(t){var e=function(t,e){if("object"!=Eh(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!=Eh(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Eh(e)?e:e+""}var Ch=function(){return function(t,e,r){return e&&Ah(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}((function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.spanCount=e.spanCount||0,this.spanEventCount=e.spanEventCount||0}),[{key:"updateCounts",value:function(){window.postMessage({type:"UPDATE_SPAN_COUNT",spans:this.spanCount,events:this.spanEventCount},"*")}},{key:"onStart",value:function(t,e){}},{key:"onEnd",value:function(t){this.spanCount++,this.spanEventCount+=t.events.length,this.updateCounts()}},{key:"shutdown",value:function(){return console.log("SpanCounterProcessor shutdown"),Promise.resolve()}},{key:"forceFlush",value:function(){return Promise.resolve()}},{key:"resetCount",value:function(){this.spanCount=0,this.spanEventCount=0,console.log("Counts reset to 0"),this.updateCounts()}}])}();const Oh=Ch;var Lh;console.log("Tracing script loaded");var Nh={ignoreNetworkEvents:!0};window.addEventListener("message",(function(t){if(t.source===window)switch(t.data.type){case"START_TRACING":if(Lh)return;var e=t.data;r=e.apiKey,n=e.serviceName,i=e.initialCounts,console.log("Initializing HoneycombWebSDK for Service Name:",n),Lh=new Oh(i),window.postMessage({type:"GET_COUNTS"},"*"),new Ju({apiKey:r,serviceName:n,instrumentations:[Sh({"@opentelemetry/instrumentation-xml-http-request":Nh,"@opentelemetry/instrumentation-fetch":Nh,"@opentelemetry/instrumentation-document-load":Nh})],spanProcessors:[Lh]}).start(),Lh.updateCounts(),console.log("Tracing started");break;case"START_NEW_SESSION":Lh?Lh.resetCount():window.postMessage({type:"UPDATE_SPAN_COUNT",spans:0,events:0},"*")}var r,n,i}))})(),n})()));